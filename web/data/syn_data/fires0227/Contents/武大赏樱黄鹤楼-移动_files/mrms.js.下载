var RMS=RMS||function(){var e=location.protocol+"//cdid.c-ctrip.com/model-poc2/h",t=location.protocol.replace("http","ws")+"//cdid.c-ctrip.com/model-poc2/w",o=!1,r=location.protocol+"//"+location.host;var n=function(){var e,t=window,o=(t.XMLHttpRequest&&"withCredentials"in new t.XMLHttpRequest?e=t.XMLHttpRequest:t.XDomainRequest&&(e=t.XDomainRequest),e),r=["head","get","post","put","delete"],n={};function i(e){this.init(e)}i.prototype.init=function(e){this.xhr=new o,this.method=e.method,this.url=e.url,this.success=e.success,this.error=e.error;try{this.xhr.timeout=2e3,this.xhr.ontimeout=function(e){},!0===e.credentials&&(this.xhr.withCredentials=!0)}catch(e){}var t=e.params?e.params:e.data;return this.headers=e.headers,this.send(t),this},i.prototype.send=function(e){var t=this;return void 0!==t.success&&(t.xhr.onload=function(){t.success.call(this,this.responseText)}),void 0!==t.error&&(t.xhr.error=function(){t.error.call(this,this.responseText)}),t.xhr.open(t.method,t.url,!0),void 0!==t.headers&&t.setHeaders(),e?t.xhr.send(e):t.xhr.send(),t},i.prototype.setHeaders=function(){var e,t=this.headers;try{for(e in t)t.hasOwnProperty(e)&&this.xhr.setRequestHeader(e,t[e])}catch(e){}return this};for(var c=0;c<r.length;c++)!function(){var e=r[c];n[e]=function(t,o){var r={};if(void 0===t)throw new Error("CORS: url must be defined");return"object"==typeof t?r=t:("function"==typeof o&&(r.success=o),r.url=t),r.method=e.toUpperCase(),new i(r).xhr}}();return n}(),i=function(e,t,c,s){if(o)return setTimeout(function(){i(e,t,c)},30);if(o=!0,!(document.documentMode&&document.documentMode&&document.documentMode<10)){var a=t+"="+c+"&serverName="+r;n.post({url:e,credentials:!0,params:a,method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},success:function(e){o=!1,e?s&&s(e,!0):s&&s(e,!1)},error:function(){o=!1,s&&s(data,!1)}})}},c=!1;return{init:function(e){if(!c){c=!0,e=e||{};new Date;var t=this;window.__bfi=window.__bfi||[],window.__bfi.push(["_getFP",function(e){t.fp=e},!1]),window.__bfi.push(["_getStatus",function(e){t.vid=e.vid},!1]),window.__bfi.push(["_getPageid",function(o,r){!o&&r&&(e.pageId||(e.pageId=r+"")),t.pageId=r}]);if(window&&window.location){var o=/^https?:\/\/((global\.secure\.ctrip\.com)|(secure\.ctrip\.com\.hk)|(m\.ctrip\.com)|(secure\.ctrip\.com)|(secure\.trip\.com)|(secure\.ctrip\.sg)|(secure\.ctrip\.my)|(secure\.ctrip\.co\.kr)|(pay\.ctrip\.com)|(m\.thetrainpal\.com)|(m\.trip\.com))/.exec(window.location);o&&o.length>1&&(setTimeout(function(){var e=document.createElement("script");e.type="text/javascript",e.id="rmsd__script",e.async=!0,e.src=("https:"==document.location.protocol?"https:":"http:")+"//webresource.c-ctrip.com/resaresonline/risk/ubtrms/md.min.286ed51c.js",e.crossOrigin="anonymous";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)},10),window.rmsd__startScriptLoad=1*new Date)}!function(){var e=window.__rmsbfi||[],t=e.push=function(){for(var e=arguments,t=0,o=e.length,r=0;r<o;r++)try{if("function"==typeof e[r])e[r]();else if("[object Array]"===Object.prototype.toString.call(e[r])){if(2!=e[r].length)continue;var n=e[r][0],i=e[r][1];"string"==typeof n&&"_getRmsToken"===n&&"function"==typeof i&&i(RMS.getRmsToken())}}catch(e){t++}return t};for(window.__rmsbfi=e;e.length>0;)t(e.shift())}()}},getRmsToken:function(){var e="fp="+(this.fp?this.fp:"");e+="&vid="+(this.vid?this.vid:""),e+="&pageId="+(this.pageId?this.pageId:"");var t=/\_RGUID=([a-z0-9\-]+)(;|$)/.exec(document.cookie),o=/guid\_\_=([a-z0-9\-]+)(;|$)/.exec(document.cookie);if(t&&t.length>1)e+="&r="+t[1].replace(/\-/g,"");else if(o&&o.length>1){e+="&r="+o[1].replace(/\-/g,"")}else e+="&r="+window.CHLOROFP_STATUS;var r,n,i=window.CHLOROFP_IP;if(!i){var c=/\_RF1=([0-9\.]+)(;|$)/.exec(document.cookie);c&&c.length>1&&(i=c[1])}isNaN(Number(i))||(r=Number(i),(n=new Array)[0]=r>>>24>>>0,n[1]=r<<8>>>24>>>0,n[2]=r<<16>>>24,n[3]=r<<24>>>24,i=String(n[0])+"."+String(n[1])+"."+String(n[2])+"."+String(n[3])),i&&(i=i.replace(/^\s+|\s+$/g,"")),e+="&ip="+i,e+="&rg="+window.RG_STA,e+="&screen="+screen.width+"x"+screen.height;var s=(new Date).getTimezoneOffset()/60;return e+="&tz="+(s<0?"+":"-")+Math.abs(s),e+="&blang="+navigator.language||navigator.userLanguage,e+="&oslang="+navigator.language||navigator.systemLanguage,e+="&ua="+encodeURIComponent(navigator.userAgent),e+="&v=m14"},ping:function(o){if(window&&window.location&&"WebSocket"in window){if(/^https?:\/\/((global\.secure\.ctrip\.com)|(secure\.ctrip\.com\.hk)|(m\.ctrip\.com)|(secure\.ctrip\.com)|(secure\.trip\.com)|(secure\.ctrip\.sg)|(secure\.ctrip\.my)|(secure\.ctrip\.co\.kr)|(pay\.ctrip\.com))/.exec(window.location),!0,!o){var r=/\_RGUID=([a-z0-9\-]+)(;|$)/.exec(document.cookie),n=/guid\_\_=([a-z0-9\-]+)(;|$)/.exec(document.cookie);r&&r.length>1?o=r[1].replace(/\-/g,""):n&&n.length>1&&(o=n[1].replace(/\-/g,""))}if(o){o=o+"_"+(s=1,a=100,Math.floor(Math.random()*(a-s+1))+s);var c=new WebSocket(t);c.addEventListener("open",function(e){c.send(o)}),c.addEventListener("message",function(e){var t=e.data;"OK"===t?c.close():c.send(t+":"+o)}),window.RG_STA="b4",i(e,"requestId",o,function(e,t){t?(window.CHLOROFP_IP=window.CHLOROFP_IP||e,window.RG_STA="fin"):window.RG_STA="err"})}}var s,a}}}();RMS.init(),RMS.ping();