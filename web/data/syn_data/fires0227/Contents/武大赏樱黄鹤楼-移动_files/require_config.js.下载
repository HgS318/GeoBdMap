/*! iScroll v5.2.0 ~ (c) 2008-2016 Matteo Spinelli ~ https://cubiq.org/license */

!function(){var t=Lizard.webresourceBaseUrl;require.config({paths:{gsCommonJs:t+"js/Common/require_config",gsCommonModel:t+"js/Common/CommonModel",gsCommonStore:t+"js/Common/CommonStore",gsCommonGeolocation:t+"js/Common/CommonGeolocation",gsCommonTradingLogic:t+"js/Common/CommonTradingLogic",gsCommonMap:t+"js/Common/CommonMap",gsNextPage:t+"js/Common/NextPage",gsAppAgent:t+"js/Common/AppAgent",gsRouterRedirect:t+"js/Common/RouterRedirect",gsShowTime:t+"js/Common/ShowTime",gsCityList:t+"js/Common/CommonCityList",gsUIStar:t+"js/Common/CUIStar",gsImagesZoom:t+"js/Common/ImagesZoom",gsShowImages:t+"js/Common/ShowImages",gsUserLogin:t+"js/Common/UserLogin",gsCommon:t+"js/Common/Common",templateCitylist:t+"templates/citylist.html",gsErrorPop:t+"js/Common/ErrorPop",gsErrorPopModel:t+"js/Common/ErrorPopModel",gsCommonAddSchedule:t+"js/Common/CommonAddSchedule",gsCommonImgSlider:t+"js/Common/CommonImgSlider",gsCommonAddTravelPlan:t+"js/Common/CommonAddTravelPlan",gsCitySearchHistory:t+"js/Common/CitySearchHistory",gsIscroll:t+"js/Common/iscroll",gsBaiduGrab:t+"js/Common/BaiduGrab",gsImgUpLoader:t+"js/Common/imgUpLoad",gsGoToHome:t+"js/Common/goToHomeBox",gsHistory:t+"js/Common/CommonHistory",encypter:t+"js/Common/encypter",gsBusinessJob:t+"js/Common/CommonBusinessJob",gsVideo:t+"js/Common/video",gsRootView:t+"js/Common/RootView",gsTimeEditor:t+"js/Common/tiemSpanEditor",gsTimeSelector:t+"js/Common/timeSelector",gsRealName:t+"js/Common/gsRealName",gsExtendImgUploader:t+"js/Common/extendImgUpload",gsHeadImgUploader:t+"js/Common/headImgUpLoad"}})}(),define("gsCommonJs",function(){}),define("gsCommonStore",["cStore","cCoreInherit","cUtility"],function(t,e,i){var o=o||{};return o.PAGE_STATE_INIT=0,o.PAGE_STATE_POS_START=1,o.PAGE_STATE_POS_COMPLETE=2,o.PAGE_STATE_POS_ERROR=3,o.PAGE_STATE_CITY_NO_SERVICE=4,o.HistoryCityStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_HISTORY_CITY",this.lifeTime="15D",this.defaultData={inter:[],inland:[],last:null,tab:0}},initialize:function($super,t){$super(t)}}),o.GeoLocationStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_GEOLOCATION",this.lifeTime="10M"},initialize:function($super,t){$super(t)},setPosInfo:function(t){for(var e in t)this.setAttr(e,t[e])}}),o.GeoCityStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_GEOCITY",this.lifeTime="10M"},initialize:function($super,t){$super(t)}}),o.KWHistoryStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_KEYWORD_HISTORY",this.lifeTime="365D"},initialize:function($super,t){$super(t)}}),o.ForwardHistoryStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_PAGE_HISTORY_MAP",this.lifeTime="1D"},initialize:function($super,t){$super(t)}}),o.DownloadFlagStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_IS_SHOW_DOWNLOAD",this.lifeTime="1D"},initialize:function($super,t){$super(t)}}),o.CityListStore=new e.Class(t,{__propertys__:function(){this.key="GS_H5_CITY_LIST_V0_CACHE",this.lifeTime="365D"},initialize:function($super,t){$super(t)}}),o.ifToGsHomeClick=new e.Class(t,{__propertys__:function(){this.key="ifGoToHomeClick",this.lifeTime="5d"},initialize:function($super,t){$super(t)}}),o.ifToGsHome=new e.Class(t,{__propertys__:function(){this.key="ifGoToHome",this.lifeTime="3d"},initialize:function($super,t){$super(t)}}),o}),define("gsBusinessJob",["cHybridShell"],function(t){return{callbackFunction:{},defaultCallback:function(){},doBusinessJob:function(t){var e=t.businessCode,i=this;if(t.businessCode){t.data=t.data||{};var o="gs"+parseInt(1e7*Math.random());if(t.callback){this.callbackFunction[o]=t.callback,this.defaultCallback=t.callback,this.abtestingCallback=t.abtestingCallback||this.abtestingCallback,this.shareCallback=t.shareCallback||this.shareCallback;var s=app.callback;app.callback=function(e){switch(e.tagname){case"do_business_job":e.param&&e.param.sequenceId&&i.callbackFunction[e.param.sequenceId]?i.callbackFunction[e.param.sequenceId](e):e.param.sequenceId&&"noCallBack"==e.param.sequenceId||i.defaultCallback(e);break;case"back":t.slideCallback();break;case"call_custom_share":case"call_one_share":void 0===window.__bfi&&(window.__bfi=[]),window.__bfi.push(["_tracklog","100844","actiontype=click&actioncode=c_share&pageid="+Lizard.instance.curView.hpageid]),i.shareCallback&&i.shareCallback(e);break;case"get_abtesting_info":i.abtestingCallback&&i.abtestingCallback(e);break;default:s(e)}}}t.notDoJob||CtripBusiness.app_do_business_job(t.port||6,e,t.data||{},o)}}}}),define("gsAppAgent",[],function(){return{ua:navigator.userAgent.toLowerCase(),isWeixinBrowser:function(){return/micromessenger/.test(this.ua)},isHybrid:function(){return/ctripwireless/.test(this.ua)},isGsHybrid:function(){return/gs_wireless/.test(this.ua)},isSmlHybrid:function(){return/sml_wireless/.test(this.ua)},isYouth:function(){return/youth_ctripwireless/.test(this.ua)},isStandard:function(){var t=!1;return this.isHybrid()&&!this.isYouth()&&(t=!0),t},isQuickApp:function(){return/hap/.test(this.ua)},appUrl:function(){var t="ctrip://wireless";return this.isYouth()&&(t="ctripyouth://wireless"),this.isGsHybrid()&&(t="ctripgs://wireless"),this.isSmlHybrid()&&(t="ctripsml://wireless"),t},isApple:function(){return/iphone|ipad|ipod/.test(this.ua)},isIphoneX:function(){return/isiphonex/.test(this.ua)},isApplePod:function(){return/ipad|ipod/.test(this.ua)},isAndroid:function(){return/android/.test(this.ua)},isIphoneX:function(){return/isiphonex/.test(this.ua)},appType:function(){return this.isApple()?this.isYouth()?16:12:this.isYouth()?36:32},appVersion:function(){var t="";return t=this.ua.slice(this.ua.indexOf("ctripwireless")),t=t.slice(t.indexOf("_")+1)},gsAppVersion:function(){var t="";return t=this.ua.slice(this.ua.indexOf("wireless")),t=t.slice(t.indexOf("_")+1)},getCtripAppVersion:function(){return this.isHybrid()?Lizard.app.version.toString():""},getGsHybridVersion:function(){return this.ua.match(/gs_wireless_[\s\S]*/)[0].replace("gs_wireless_","")},compareAppVersion:function(t){t=(t||"")+"";var e;e=this.isGsHybrid()?this.getGsHybridVersion():this.getCtripAppVersion();var i,o,s=e.split("."),n=t.split(".");if(s.length>n.length)for(i=0;i<s.length-n.length;i++)n.push(0);else if(s.length<n.length)for(i=0;i<n.length-s.length;i++)s.push(0);for(i=0;i<n.length;i++){if(s.length>i){if(parseInt(n[i],0)>parseInt(s[i],0)){o=1;break}if(n[i]==s[i])continue;o=-1;break}o=1}return void 0===o&&(o=0),o}}}),define("gsCommon",["cHybridShell","gsBusinessJob","gsAppAgent"],function(t,e,i){return{backTop:function(t){var e=$("#topcontrol"),i=$(window);$obj=t.obj||$(window),$obj.scroll(function(){$obj.scrollTop()>=i.height()?(e.show(500).css("bottom",t.bottom),t.callback&&t.callback(1)):(e.hide(500),t.callback&&t.callback(0))}),e.off("click").on("click",function(){return t.obj?t.obj[0].scrollTop=0:document.body.scrollTop=0,!1})},ctripShare:function(e){new t.Fn("call_custom_share",function(t){}).run(e.dataList,e.businessCode||"Destination",e.meta||{})},share:function(t){this.shareCommon(t)},getBusinessCode:function(t){return businessCode=t.businessCode||"Destination",t.pageId?businessCode+="_"+t.pageId:Lizard.instance.curView.hpageid&&(businessCode+="_"+Lizard.instance.curView.hpageid),businessCode},shareCommon:function(t,o,s){var n=this;if(1==i.compareAppVersion("6.20"))n.doShare(t,o,!1);else{var a=!1;e.doBusinessJob({businessCode:80013,data:{},callback:function(e){a||(e&&e.param&&e.param.shareFlag&&1==e.param.shareFlag?n.doShare(t,o,!0,s):n.doShare(t,o,!1,s),a=!0)}}),setTimeout(function(){a||(n.doShare(t,o,!1,s),a=!0)},1e3)}},doShare:function(e,o,s,n){var a=[],r=this,o=o||{},c=this.getBusinessCode(o),l=o.meta||{},d=o.channels||[];if(shareType=o.oneShareType||"","string"==typeof e){if(Internal.isNotEmptyString(e)){var h=JSON.parse(e);(0==d.length||-1<d.indexOf("WeixinFriend"))&&a.push({shareType:"WeixinFriend",imageUrl:h.miniProgramPic||h.picUrl||"",title:("miniProgram"===h.shareType?h.miniProgramTitle:h.title)||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s),miniProgramPath:h.miniProgramPath||"",miniProgramID:h.miniProgramID||""}),(0==d.length||-1<d.indexOf("WeixinCircle"))&&a.push({shareType:"WeixinCircle",imageUrl:h.picUrl||"",title:(h.title||"")+(h.weixinCircleContent?"\n"+h.weixinCircleContent:""),text:h.weixinCircleContent||h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("SinaWeibo"))&&a.push({shareType:"SinaWeibo",imageUrl:h.picUrl||"",title:h.title||"",text:h.weiboContent||"",linkUrl:""}),(0==d.length||-1<d.indexOf("QQ"))&&a.push({shareType:"QQ",imageUrl:h.picUrl||"",title:h.title||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("QQZone"))&&a.push({shareType:"QQZone",imageUrl:h.picUrl||"",title:h.title||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("SMS"))&&a.push({shareType:"SMS",imageUrl:h.picUrl||"",title:h.title||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("Email"))&&a.push({shareType:"Email",imageUrl:h.picUrl||"",title:h.title||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("Copy"))&&a.push({shareType:"Copy",imageUrl:h.picUrl||"",title:h.title||"",text:h.weixinContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("OSMore"))&&a.push({shareType:"Default",imageUrl:h.picUrl||"",title:h.title||"",text:h.weiboContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)})}}else h=e,(0==d.length||-1<d.indexOf("WeixinFriend"))&&a.push({shareType:"WeixinFriend",imageUrl:h.miniProgramPic||h.picUrl||"",title:("miniProgram"===h.shareType?h.miniProgramTitle:h.title)||"",text:h.weixinFriendContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s),miniProgramPath:h.miniProgramPath||"",miniProgramID:h.miniProgramID||""}),(0==d.length||-1<d.indexOf("WeixinCircle"))&&a.push({shareType:"WeixinCircle",imageUrl:h.picUrl||"",title:(h.title||"")+"\n"+(h.weixinCircleContent||""),text:h.weixinCircleContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("SinaWeibo"))&&a.push({shareType:"SinaWeibo",imageUrl:h.picUrl||"",title:h.title||"",text:h.weiboContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("QQ"))&&a.push({shareType:"QQ",imageUrl:h.picUrl||"",title:h.title||"",text:h.qqContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("QQZone"))&&a.push({shareType:"QQZone",imageUrl:h.picUrl||"",title:h.title||"",text:h.qqZoneContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("SMS"))&&a.push({shareType:"SMS",imageUrl:h.picUrl||"",title:h.title||"",text:h.smsContent||h.defaultContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("Email"))&&a.push({shareType:"Email",imageUrl:h.picUrl||"",title:h.title||"",text:h.emailContent||h.defaultContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("Copy"))&&a.push({shareType:"Copy",imageUrl:h.picUrl||"",title:h.title||"",text:h.copyContent||h.defaultContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)}),(0==d.length||-1<d.indexOf("OSMore"))&&!n&&a.push({shareType:"Default",imageUrl:h.picUrl||"",title:h.title||"",text:h.defaultContent||"",linkUrl:r.rebuildUrl(h.shareUrl,s)});var p=["WeixinFriend","WeixinCircle","SinaWeibo","QQ","QQZone","SMS","Email","Copy","OSMore"];if(i.compareAppVersion("8.0.1")<1&&n&&(a.unshift(n),p.unshift("CustomList")),0!=shareType.length&&p.indexOf(shareType)>-1)if("string"==typeof e){if(Internal.isNotEmptyString(e)){var h=JSON.parse(e),u=h.picUrl||"",m=h.title||"",g=h.defaultContent||"",f=r.rebuildUrl(h.shareUrl,s),_=(h.miniProgramPath,h.miniProgramID,new t.Fn("call_one_share",function(t){}));_.run(shareType,u,m,g,f,c,l)}}else{var h=e,u=h.picUrl||"",m=h.title||"",g=h.defaultContent||"",f=r.rebuildUrl(h.shareUrl,s),_=(h.miniProgramPath,h.miniProgramID,new t.Fn("call_one_share",function(t){}));_.run(shareType,u,m,g,f,c,l)}else{var _=new t.Fn("call_custom_share",function(t){});_.run(a,c,l)}},rebuildUrl:function(t,e){return t?e?t+(-1==t.indexOf("?")?"?":"&")+"Allianceid=29375&sid=808135":t:""},scrollFix:function(t){var e,i;(t="object"==typeof t?t:document.querySelector(t))&&t.addEventListener("touchstart",function(o){e=o.touches[0].pageY,i=t.scrollTop,i<=0&&(t.scrollTop=1),i+t.offsetHeight>=t.scrollHeight&&(t.scrollTop=t.scrollHeight-t.offsetHeight-1)},!1)},copyAble:function(){$("body").attr("onselectstart","")},lanuchApp:function(t){},trackLog:function(t,e){var i="";i=Lizard.isInCtripApp||Lizard.isHybrid?"o_gs_"+e.hpageid+"_city_app_basic":"o_gs_"+e.pageid+"_city_app_basic",window.__bfi.push(["_tracklog",i,JSON.stringify(t)])},cTrackLog:function(t,e,i){var o="";void 0===window.__bfi&&(window.__bfi=[]),$.each(e,function(t,e){o+=t+"="+e+"&"}),o=o.substr(0,o.length-1),window.__bfi.push(["_tracklog",t+"",o,i])},adTrackLog:function(t,e){Lizard.isInCtripApp&&CtripBusiness.app_log_google_remarkting(t,e)},setUserHistory:function(t){if((Lizard.isHybrid||Lizard.isInCtripApp)&&i.compareAppVersion("6.15")<1){var o=-1;e.doBusinessJob({businessCode:801001,data:{type:1,key:"userHistory"},callback:function(e){if(0!=o)if(e.param&&e.param.context){var i=JSON.parse(e.param.context),s=!1;$.each(i,function(e,i){i.PoiId===t.PoiId&&(s=!0,i.setTime=(new Date).getTime())}),s||(10==i.length?(i.pop(),i.unshift(t)):i.unshift(t)),o=0,CtripBusiness.app_do_business_job(6,801001,{type:0,key:"userHistory",context:JSON.stringify(i),expiry:2e4},"noCallBack")}else o=0,CtripBusiness.app_do_business_job(6,801001,{type:0,key:"userHistory",context:JSON.stringify([t]),expiry:2e4},"noCallBack")}}),o=1}},hideGsAppForH5:function(){return document.cookie.indexOf("AllianceID=276874")>-1&&document.cookie.indexOf("SID=724220")>-1||document.cookie.indexOf("AllianceID=106147")>-1&&document.cookie.indexOf("SID=549949")>-1||document.cookie.indexOf("AllianceID=30159")>-1&&document.cookie.indexOf("SID=749360")>-1||document.cookie.indexOf("AllianceID=283778")>-1&&document.cookie.indexOf("SID=732699")>-1||document.cookie.indexOf("AllianceID=309340")>-1&&document.cookie.indexOf("SID=788076")>-1},getUserHistory:function(t,o){(Lizard.isHybrid||Lizard.isInCtripApp)&&i.compareAppVersion("6.15")<1&&e.doBusinessJob({businessCode:801001,data:{type:1,key:o},callback:function(e){t&&t(e)}})},httpImageUrl:{share:"http://pages.c-ctrip.com/you/header_icon/share",map:"http://pages.c-ctrip.com/you/header_icon/map",favorite:"http://pages.c-ctrip.com/you/header_icon/favorite",favorited:"http://pages.c-ctrip.com/you/header_icon/favorited",explain:"http://pages.c-ctrip.com/you/header_icon/explain",home:"http://pages.c-ctrip.com/you/header_icon/home",more:"http://pages.c-ctrip.com/you/header_icon/more",news:"http://pages.c-ctrip.com/you/header_icon/news","news-more":"http://pages.c-ctrip.com/you/header_icon/news-more",photo:"http://pages.c-ctrip.com/you/header_icon/photo",save:"http://pages.c-ctrip.com/you/header_icon/save",search:"http://pages.c-ctrip.com/you/header_icon/search",write:"http://pages.c-ctrip.com/you/header_icon/write","write-prize":"http://pages.c-ctrip.com/you/header_icon/write-prize",city:"https://pages.c-ctrip.com/you/header_icon/cities","treasured-book":"http://pages.c-ctrip.com/you/header_icon/treasured-book",telephone:"https://pages.c-ctrip.com/you/header_icon/telephone","black-share":"http://pages.c-ctrip.com/you/header_icon/black-share","black-map":"http://pages.c-ctrip.com/you/header_icon/black-map","black-favorite":"http://pages.c-ctrip.com/you/header_icon/black-favorite","black-favorited":"http://pages.c-ctrip.com/you/header_icon/black-favorited","black-explain":"http://pages.c-ctrip.com/you/header_icon/black-explain","black-home":"http://pages.c-ctrip.com/you/header_icon/black-home","black-more":"http://pages.c-ctrip.com/you/header_icon/black-more","black-news":"http://pages.c-ctrip.com/you/header_icon/black-news","black-news-more":"http://pages.c-ctrip.com/you/header_icon/black-news-more","black-photo":"http://pages.c-ctrip.com/you/header_icon/black-photo","black-save":"http://pages.c-ctrip.com/you/header_icon/black-save","black-search":"http://pages.c-ctrip.com/you/header_icon/black-search","black-write":"http://pages.c-ctrip.com/you/header_icon/black-write","black-write-prize":"http://pages.c-ctrip.com/you/header_icon/black-write-prize","black-city":"https://pages.c-ctrip.com/you/header_icon/black-cities","black-treasured-book":"http://pages.c-ctrip.com/you/header_icon/black-treasured-book","black-telephone":"https://pages.c-ctrip.com/you/header_icon/black-telephone","blue-share":"http://pages.c-ctrip.com/you/header_icon/blue-share","blue-map":"http://pages.c-ctrip.com/you/header_icon/blue-map","blue-favorite":"http://pages.c-ctrip.com/you/header_icon/blue-favorite","blue-favorited":"http://pages.c-ctrip.com/you/header_icon/blue-favorited","gray-hotelasks-share":"https://pages.c-ctrip.com/you/header_icon/gray-hotelasks-share","hotelasks-shares":"https://pages.c-ctrip.com/you/newasks/gs_asks_share_black"},getRightHeaderList:function(t){if(t&&0!=t.length){for(var e=[],o=0;o<t.length;o++){var s=this.getRightHeader(t[o]);s&&(Lizard.isHybrid||Lizard.isInCtripApp||i.isGsHybrid()?e.push(s):t[o].isH5Show&&e.push(s))}return e}},getRightHeader:function(t){if(t.tagname&&this.httpImageUrl[t.tagname]){var e=this.httpImageUrl[t.tagname],o="";return i.isApple()&&window.devicePixelRatio>2?(e+="@3x.png",o="-3x"):(e+="@2x.png",o="-2x"),{tagname:"gs-"+t.tagname+o,iconname:"useless",value:t.value||"",httpImageUrl:e,callback:t.callback||function(){}}}},_getAidAndSid:function(t){void 0===window.__union&&(window.__union=[]),window.__union.push({callback:function(){var e,i=window.localStorage.getItem("UNION");i&&(e=JSON.parse(i).data||{}),t(e)}})},checkAidSid:function(t,e){this._getAidAndSid(function(i){i=i||{};var o=i.AllianceID,s=i.SID,n=!1;t.map(function(t,e){if(t.allianceID==o&&t.sID==s)return void(n=!0)}),e(n)})},hideBackButtonWithAid:function(){var t=[{allianceID:281157,sID:1517226},{allianceID:281157,sID:1517225}];this.checkAidSid(t,function(t){t&&$(".js_back").hide()})}}}),define("gsCommonModel",["cModel","cCoreInherit","cUtility","gsCommonStore","gsCommon"],function(t,e,i,o,s){var n=n||{},a=o.GeoCityStore.getInstance();return n.doGetDistrictByLatlon=function(t,e,i){var o=n.getDistrictByLatlon.getInstance();o.setParam({LatLng:{Lng:t.lng,Lat:t.lat},NeedInheritedDistricts:!!t.NeedInheritedDistricts&&t.NeedInheritedDistricts}),o.excute(function(t){t?e&&e(t):i&&i(t)},function(){i&&i()},!1)},n.getDistrictByLatlon=new e.Class(t,{__propertys__:function(){this.url="/soa2/11833/json/getgslocationinfo",this.method="POST",this.param={LatLng:{Lng:0,Lat:0}}},initialize:function($super,t){$super(t)},paraData:function(t){return t}}),n.getCurrentDestination=function(t,e,i,o){i="function"==typeof i?i:function(){},o="function"==typeof o?o:function(){},$.ajax({url:"//m.ctrip.com/restapi/soa2/12378/json/ctriplbs",type:"POST",dataType:"JSON",data:{latitude:t,longitude:e,coordType:"GCJ02"},success:function(s){if((s=JSON.parse(s))&&s.ResponseStatus&&"Success"==s.ResponseStatus.Ack){var n={},r=s.gpsInfo||{},c=s.gsCurrentCity||{},l=s.htlCurrentCity||{},d=s.ctripPOIInfo||{};n.lat=r.latitude||0,n.lng=r.longitude||0,n.cityId=l.geoID||0,n.districtId=c.geoID||0,n.districtName=c.geoCName||"",n.parentId=d.countryId||0,n.parentName=d.country||"",n.positionLat=t,n.positionLng=e,n.isInChina=!!r.inChina,n.pyName=c.geoEName||"",a.set(n),i(n)}else o()},error:function(){o()}})},n.getDestinationByCityId=function(t,e,i,o,n,r){o="function"==typeof o?o:function(){},n="function"==typeof n?n:function(){},$.ajax({url:"//m.ctrip.com/restapi/soa2/10318/json/GetPackageDistrictByCityId",type:"POST",dataType:"JSON",data:{CityId:i,Lat:t,Lng:e},success:function(t){if((t=JSON.parse(t))&&t.ResponseStatus&&"Success"==t.ResponseStatus.Ack){var e={},c=Lizard.S("GS_H5_GEOLOCATION");c&&(e.lat=c.lat,e.lng=c.lng,e.positionLat=c.lat,e.positionLng=c.lng,e.address=c.address),e.cityId=i,t.DistrictId&&(e.districtId=t.DistrictId),t.DistrictName&&(e.districtName=t.DistrictName),a.set(e),s.cTrackLog(100091,{actionType:r,actionCode:"startPosition_GeoLocation_onCityComplete_getDestinationByCityId_success",timeStamp:(new Date).getTime()}),o(e)}else{var e={},c=Lizard.S("GS_H5_GEOLOCATION");c?this.getCurrentDestination(c.lat,c.lng,o,n):(s.cTrackLog(100091,{actionType:r,actionCode:"startPosition_GeoLocation_onCityComplete_getDestinationByCityId_error_1",timeStamp:(new Date).getTime()}),n())}},error:function(){s.cTrackLog(100091,{actionType:r,actionCode:"startPosition_GeoLocation_onCityComplete_getDestinationByCityId_error_0",timeStamp:(new Date).getTime()}),n()}})},n.getInputCityList=function(t,e,i){e="function"==typeof e?e:function(){},i="function"==typeof i?i:function(){},$.ajax({url:"https://m.ctrip.com/restapi/soa2/10318/SearchDistrictList",type:"GET",dataType:"JSON",data:t,success:function(t){t=JSON.parse(t),e(t)},error:function(){i()}})},n.addPlaneHotelSchedule=new e.Class(t,{__propertys__:function(){this.url="/soa2/13517/ShoppingDataRestful",this.method="POST",this.param={}},initialize:function($super,t){$super(t)}}),n.addSchedule=new e.Class(t,{__propertys__:function(){this.url="/soa2/10191/AddSmartTrip",this.method="POST",this.param={}},initialize:function($super,t){$super(t)}}),n.addTravelPlan=new e.Class(t,{__propertys__:function(){this.url="/soa2/10120/json/AddPoiToTravelPlan",this.method="POST",this.param={}},initialize:function($super,t){$super(t)}}),n.getTravelPlanList=new e.Class(t,{__propertys__:function(){this.url="/soa2/10120/json/GetTravelPlanListByUID",this.method="POST",this.param={}},initialize:function($super,t){$super(t)}}),n.getIsComment=new e.Class(t,{__propertys__:function(){this.url="/soa2/10491/json/GetUserIsCommentPoi",this.param={}},initialize:function($super,t){$super(t)}}),n.GetCurNearByCityList=new e.Class(t,{__propertys__:function(){this.url="/soa2/11833/GetDistrictNearByByLoaltion",this.param={LatLng:{Lng:121,Lat:31}}},initialize:function($super,t){$super(t)}}),n.GetCityList=new e.Class(t,{__propertys__:function(){this.url="/soa2/10200/GetAppCityList",this.param={version:0,source:"",needData:!0}},initialize:function($super,t){$super(t)}}),n}),define("gsCommonGeolocation",["libs","cPageView","cGeoService","gsBusinessJob","gsAppAgent","gsCommon","gsCommonStore","gsCommonModel"],function(t,e,i,o,s,n,a,r){return{GeoLocation:i.GeoLocation,geoLocationStore:a.GeoLocationStore.getInstance(),cityStore:a.GeoCityStore.getInstance(),getLocationInfoOver716:function(t){var e=this,i="",s={FOODS:"food",SHOPS:"shopping"},a=(new Date).getTime(),r="";n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_start",isHybridOver716:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),e.timerInterval=setInterval(function(){r=(new Date).getTime(),e.getCitySwitchDataBackMark?clearInterval(e.timerInterval):r-a>=t.timeout&&(clearInterval(e.timerInterval),e.getCitySwitchDataTimeoutMark=!0,n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_timeout",isHybridOver716:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCommonError&&t.onCommonError())},5),o.doBusinessJob({port:1,businessCode:"getCitySwitchData",data:{bu:s[t.fromTag]?s[t.fromTag]:"you"},callback:function(o){if(e.getCitySwitchDataBackMark=!0,!e.getCitySwitchDataTimeoutMark){if(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_callback_result",isHybridOver716:!0,channelType:t.fromTag,result:JSON.stringify(o),timeStamp:(new Date).getTime()}),!o.param||!o.param.geoAddress)return n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_fail",isHybridOver716:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),void(t.onCommonError&&t.onCommonError());o.param.geoAddress.lat&&o.param.geoAddress.lng?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_success",isHybridOver716:!0,channelType:t.fromTag,lat:o.param.geoAddress.lat,lng:o.param.geoAddress.lng,timeStamp:(new Date).getTime()}),t.onPosComplete?t.onPosComplete({lat:o.param.geoAddress.lat,lng:o.param.geoAddress.lng}):t.onComplete&&o.param.geoAddress.detailAddress?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_address_success",isHybridOver716:!0,channelType:t.fromTag,lat:o.param.geoAddress.lat,lng:o.param.geoAddress.lng,address:o.param.geoAddress.detailAddress,timeStamp:(new Date).getTime()}),i={lat:o.param.geoAddress.lat,lng:o.param.geoAddress.lng,address:o.param.geoAddress.detailAddress},e.geoLocationStore.setPosInfo(i),t.onComplete(i)):t.onCityComplete&&o.param.recommendMapLocation&&o.param.recommendMapLocation.geoID?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_destination_success",isHybridOver716:!0,channelType:t.fromTag,districtId:o.param.recommendMapLocation.geoID,timeStamp:(new Date).getTime()}),i={lat:o.param.geoAddress.lat,lng:o.param.geoAddress.lng,address:o.param.geoAddress.detailAddress,districtId:o.param.recommendMapLocation.geoID,districtName:o.param.recommendMapLocation.geoCName,districtEName:o.param.recommendMapLocation.geoEName},e.saveCityInfo(i),t.onCityComplete(i)):t.onCommonError&&t.onCommonError()):(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_fail",isHybridOver716:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCommonError&&t.onCommonError())}}})},getLocationInfoOver703:function(t){var e=this;n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_start",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),o.doBusinessJob({businessCode:80040,data:{sequenceId:"locate"+parseInt(1e7*Math.random()),timeout:t.timeout,isForceLocate:!!t.noCache},callback:function(i){if(i.param&&i.param.result){var o=JSON.parse(i.param.result),s=o.value||{};if("geo"==o.type)n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_success",isHybridOver73:!0,channelType:t.fromTag,lat:s.lat,lng:s.lng,geoType:s.geoType,timeStamp:(new Date).getTime()}),e.geoType=s.geoType,t.onPosComplete&&t.onPosComplete({lat:s.lat,lng:s.lng,geoType:s.geoType});else if("address"==o.type)n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_address_success",isHybridOver73:!0,channelType:t.fromTag,lat:s.lat,lng:s.lng,geoType:e.geoType,address:s.addrs||s.detailAddress,timeStamp:(new Date).getTime()}),s.pois=[],s.geoType=e.geoType,s.address=s.addrs||s.detailAddress,e.geoLocationStore.setPosInfo(s),t.onComplete&&t.onComplete(s);else if("GSDestination"==o.type){n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_destination_success",isHybridOver73:!0,channelType:t.fromTag,isInChina:s.isInChina,districtId:s.districtId,districtName:s.districtName,eName:s.districtEName,timeStamp:(new Date).getTime()});var a={isInChina:s.isInChina,districtId:s.districtId,districtName:s.districtName,geoType:e.geoType,eName:s.districtEName};e.organizeDistrictInfo(a,t.needCity,t.onCityComplete,t.onCityError||t.onCommonError)}else"CtripCity"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_city_success",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),s.geoType=e.geoType,e.saveCityInfo(s)):"1"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_closed",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onPosError?t.onPosError():t.onCommonError()):"2"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_fail",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onPosError?t.onPosError():t.onCommonError()):"3"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_timeout",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onPosError?t.onPosError():t.onCommonError()):"4"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_trans_address_fail",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onError?t.onError():t.onCommonError()):"5"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_trans_city_fail",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCityError?t.onCityError():t.onCommonError()):"6"==o.type?(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_trans_district_fail",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCityError?t.onCityError():t.onCommonError()):(n.cTrackLog(100091,{actionType:"browse",actionCode:"getLocationInfo_geo_other_fail",isHybridOver73:!0,channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCityError?t.onCityError():t.onCommonError())}}})},getLocationInfo:function(t){var e=this,i=!(s.isHybrid()&&1==s.compareAppVersion("7.3"));if(t=t||{},t.agentName=t.agentName||"destination",t.locationType=t.locationType||3,t.timeout=t.timeout||3e3,t.fromTag=t.fromTag||"",e.myCounterNumber=0,!t.noCache&&(t.onlyLocalstorage||t.useGSCache)){var o=this.cityStore.get();if(o)return void(t.onCityComplete&&t.onCityComplete(o));if(t.onlyLocalstorage)return void(t.onCityError?t.onCityError():t.onCommonError());var a=this.geoLocationStore.get();if(a)return t.onCityComplete&&r.doGetDistrictByLatlon({lat:a.lat,lng:a.lng},function(i){var o=i.Result||{};e.organizeDistrictInfo({districtId:o.DistrictId,districtName:o.DistrictName,eName:o.DistrictEName},t.needCity,t.onCityComplete,t.onCityError||t.onCommonError)},t.onCityError||t.onCommonError),!1}if(this.cityStore.remove(),this.geoLocationStore.remove(),s.isHybrid()&&s.compareAppVersion("7.16")<1)e.getLocationInfoOver716(t);else if(s.isHybrid()&&s.compareAppVersion("7.3")<1)e.getLocationInfoOver703(t);else{var c=!1;this.GeoLocation.Subscribe(t.agentName,{onStart:function(){n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_geo_start",channelType:t.fromTag,timeStamp:(new Date).getTime()})},onPosComplete:function(o,s){1==t.locationType&&(c=!0),n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_geo_success",lng:o,lat:s,channelType:t.fromTag,timeStamp:(new Date).getTime()}),i&&(c=!0,t.onCityComplete&&r.doGetDistrictByLatlon({lat:s,lng:o},function(i){var o=i.Result||{};e.organizeDistrictInfo({districtId:o.DistrictId,districtName:o.DistrictName,eName:o.DistrictEName},t.needCity,t.onCityComplete,t.onCityError||t.onCommonError)},t.onCityError||t.onCommonError)),t.onPosComplete&&t.onPosComplete({lat:s,lng:o})},onComplete:function(e){n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_address_success",channelType:t.fromTag,timeStamp:(new Date).getTime()}),2==t.locationType&&(c=!0),this.geoLocationStore.setPosInfo(e),t.onComplete&&t.onComplete(e)},onPosError:function(){c||(n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_geo_fail",channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onPosError?t.onPosError():t.onCommonError())},onError:function(){c||(n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_geo_timeout",channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onError?t.onError():t.onCommonError())},onCityComplete:function(o){if(n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_city_success",channelType:t.fromTag,timeStamp:(new Date).getTime()}),3==t.locationType&&(c=!0),i)return void e.saveCityInfo(o);if(o.CityEntities&&o.CityEntities.length>0&&o.CityEntities[0].CityID){var s=this.geoLocationStore.get();r.getDestinationByCityId(s.lat,s.lng,o.CityEntities[0].CityID,t.onCityComplete,t.onCityError||t.onCommonError)}else t.onCityError?t.onCityError():t.onCommonError()},onCityError:function(){c||(n.cTrackLog(100091,{actionType:"browse",actionCode:"h5_getLocationInfo_geo_trans_city_fail",channelType:t.fromTag,timeStamp:(new Date).getTime()}),t.onCityError?t.onCityError():t.onCommonError())}},this,t.noCache,t.timeout)}},organizeDistrictInfo:function(t,e,i,o){var s=this.geoLocationStore.get(),n=this;if(n.myCounterNumber++,s){if(e&&!s.cityId){if(n.myCounterNumber<=30)return void setTimeout(function(){
n.organizeDistrictInfo(t,e,i,o)},200);o()}t.lat=s.lat,t.lng=s.lng,t.geoType=s.geoType,t.positionLat=s.lat,t.positionLng=s.lng,t.address=s.address||s.addrs||s.detailAddress,t.cityId=s.cityId,n.cityStore.set(t),i&&i(t)}else n.myCounterNumber<=30?setTimeout(function(){n.organizeDistrictInfo(t,e,i,o)},200):o()},saveCityInfo:function(t){var e=this.geoLocationStore.get(),i=this;t&&("string"==typeof t&&(t=JSON.parse(t)),e?(e.cityId=t.CityEntities[0].CityID,i.geoLocationStore.setPosInfo(e)):setTimeout(function(){i.saveCityInfo(t)},200))},getGeolocation:function(t,e){this.getLocationInfo({onlyLocalstorage:1,onCityComplete:t,onCityError:e})},startPosition:function(t,e,i,o){this.getLocationInfo({fromTag:o,useGSCache:1,noCache:i,onCityComplete:t,onCommonError:e})},startPositionSimple:function(t,e,i,o,s){this.getLocationInfo({agentName:t,timeout:e,noCache:1,onPosComplete:s,onCityComplete:i,onCommonError:o})}}}),define("gsCommonTradingLogic",["cHybridShell","gsBusinessJob","gsAppAgent","gsCommon","gsCommonGeolocation","gsCommonModel","cAbstractStorage"],function(t,e,i,o,s,n,a){return{doCommonTradingOnload:function(t){var s,n=(Lizard.P("lat")&&Lizard.P("lat"),Lizard.P("lng")&&Lizard.P("lng"),2);t=t||{},t.trackLogTag=t.trackLogTag||"",t.onLoadPage=t.onLoadPage||function(){},s=window&&window.localStorage&&window.localStorage.getItem("Common_GsCommonTradingLogic_7.5"),s&&JSON.parse(s).city_id&&(n=JSON.parse(s).city_id),i.isHybrid()&&i.compareAppVersion("7.4")<1?i.compareAppVersion("7.5")<1?CtripBusiness.appGetCityMapping(t.bizType,function(e){var i=0;if(e&&e.cityMapping&&e.cityMapping.length>0)for(var s=0;s<e.cityMapping.length;s++)if(e.cityMapping[s]&&e.cityMapping[s].globalid&&"gs_district"===e.cityMapping[s].type&&e.cityMapping[s].geocategoryid>2){i=e.cityMapping[s].globalid;break}i?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingOnload_success_7.5_hasnativeCache",channelType:t.trackLogTag,districtId:i}),t.onLoadPage({districtId:i,nativeCache:!0})):(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingOnload_fail_7.5_hasnotnativeCache",channelType:t.trackLogTag,districtId:n}),t.onLoadPage({districtId:n,nativeCache:!1}))}):e.doBusinessJob({businessCode:80050,data:{isRead:!0},callback:function(e){switch(e.tagname){case"do_business_job":var i=e&&e.param&&e.param.cache,i=JSON.parse(i);i&&i.destId?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingOnload_success_7.4_hasnativeCache",channelType:t.trackLogTag,districtId:i.destId}),t.onLoadPage({districtId:i.destId,nativeCache:!0})):(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingOnload_fail_7.4_hasnotnativeCache",channelType:t.trackLogTag,districtId:n}),t.onLoadPage({districtId:n,nativeCache:!1}))}}}):t.onLoadPage({districtId:n,nativeCache:!1})},appShowSwitchCityDialogIfNeeded:function(t){var e=this;if(i.isHybrid()&&i.compareAppVersion("7.15")<1){var s={FOODS:"food",SHOPS:"shopping"};o.cTrackLog(100091,{actionType:"browse",actionCode:"appShowSwitchCityDialogIfNeeded_start",bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6"}),CtripLocate.appShowSwitchCityDialogIfNeeded({bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6"},function(i){t.fail=t.fail||function(){};var n={1:"appShowSwitchCityDialogIfNeeded_geo_closed",2:"appShowSwitchCityDialogIfNeeded_geo_fail",3:"appShowSwitchCityDialogIfNeeded_geo_timeout",4:"appShowSwitchCityDialogIfNeeded_geo_trans_address_fail",5:"appShowSwitchCityDialogIfNeeded_geo_trans_city_fail",6:"appShowSwitchCityDialogIfNeeded_android_sdk_key_fail",99:"appShowSwitchCityDialogIfNeeded_other_unknow_fail"};if(7==i.switchResult||8==i.switchResult||9==i.switchResult)var a=e.handleRecommendLocationData(i);n[i.switchResult]?(o.cTrackLog(100091,{actionType:"browse",actionCode:n[i.switchResult],channelType:t.trackLogTag,switchResult:i.switchResult,bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6",result:JSON.stringify(i)}),t.fail()):7==i.switchResult?(o.cTrackLog(100091,{actionType:"browse",actionCode:"appShowSwitchCityDialogIfNeeded_district_suc_unDialog",channelType:t.trackLogTag,switchResult:i.switchResult,bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6",result:JSON.stringify(i)}),a&&a.__Lat&&a.__Lng&&a.DistrictId?t.districtSuccUnDialog(a):t.fail()):8==i.switchResult?(o.cTrackLog(100091,{actionType:"browse",actionCode:"appShowSwitchCityDialogIfNeeded_district_suc_dialog_ok",channelType:t.trackLogTag,switchResult:i.switchResult,bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6",result:JSON.stringify(i)}),a&&a.__Lat&&a.__Lng&&a.DistrictId?t.districtSuccDialogOk(a):t.fail()):9==i.switchResult?(o.cTrackLog(100091,{actionType:"browse",actionCode:"appShowSwitchCityDialogIfNeeded_district_suc_dialog_cancel",channelType:t.trackLogTag,switchResult:i.switchResult,bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6",result:JSON.stringify(i)}),a&&a.__Lat&&a.__Lng&&a.DistrictId?t.districtSuccDialogCancel(a):t.fail(),e.saveUserActionCache({cacheType:"userAction",bizType:s[t.trackLogTag],destId:t.districtId,timeout:2})):(o.cTrackLog(100091,{actionType:"browse",actionCode:"appShowSwitchCityDialogIfNeeded_基础部门未给出的错误类型",channelType:t.trackLogTag,switchResult:i.switchResult,bu:s[t.trackLogTag],globalId:t.districtId+"",sourceType:"gs_district",geocategoryid:"6",result:JSON.stringify(i)}),t.fail())})}},handleRecommendLocationData:function(t){var e={};if(e.__Lat=t.geoAddress&&t.geoAddress.lat,e.__Lng=t.geoAddress&&t.geoAddress.lng,e.__Address=t.geoAddress&&t.geoAddress.detailAddress,t.recommendLocation&&t.recommendLocation.key&&t.ctripCity&&t.ctripCity.RecommendMapList&&t.ctripCity.RecommendMapList.length>0)for(var i=0;i<t.ctripCity.RecommendMapList.length;i++)if(t.ctripCity.RecommendMapList[i].Key==t.recommendLocation.key){e.DistrictId=t.ctripCity.RecommendMapList[i].GeoID,e.DistrictName=t.ctripCity.RecommendMapList[i].GeoCName;break}return e},doCommonTradingAfterLoad:function(t){var e,a=Lizard.P("lat")?Lizard.P("lat"):0,r=Lizard.P("lng")?Lizard.P("lng"):0,c=!0,l=t.districtId?t.districtId:2;t=t||{},t.trackLogTag=t.trackLogTag||"",t.onReloadPageList=t.onReloadPageList||function(){},t.onShowSelectDistrict=t.onShowSelectDistrict||function(){},t.onFetchLatLngFail=t.onFetchLatLngFail||function(){},t.onFetchDistrictFail=t.onFetchDistrictFail||function(){},!1===t.needInheritedDistricts&&(c=!1);var d=function(s){n.doGetDistrictByLatlon({lat:s.lat,lng:s.lng,NeedInheritedDistricts:c},function(n){n&&n.InheritedResult&&n.InheritedResult.length>0&&n.InheritedResult[0].DistrictId>0||n&&n.GsResult&&n.GsResult.DistrictId>0?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_district_recommend_success",isHybrid:i.isHybrid(),channelType:t.trackLogTag}),c?(n.InheritedResult[0].__Lat=s.lat,n.InheritedResult[0].__Lng=s.lng,n.InheritedResult[0].__Address=s.address,h(n.InheritedResult)):h([{__Lat:s.lat,__Lng:s.lng,__Address:s.address,DistrictId:n.GsResult.DistrictId,DistrictName:n.GsResult.DistrictName,DistrictEName:n.GsResult.DistrictEName,IsInChina:n.GsResult.IsInChina}])):(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_district_recommend_0_fail",isHybrid:i.isHybrid(),channelType:t.trackLogTag}),"FOODS"===t.trackLogTag?e&&(new Date).getTime()-e>5e3?t.onFetchDistrictFail("timeout"):t.onFetchDistrictFail():e&&(new Date).getTime()-e<5e3&&t.onFetchDistrictFail())},function(){o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_district_recommend_ajax_fail",isHybrid:i.isHybrid(),channelType:t.trackLogTag}),"FOODS"===t.trackLogTag?e&&(new Date).getTime()-e>5e3?t.onFetchDistrictFail("timeout"):t.onFetchDistrictFail():e&&(new Date).getTime()-e<5e3&&t.onFetchDistrictFail()})},h=function(e){e.length>0&&e[0].DistrictId==l?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_district_recommend_success_reload_page",pageDistrictId:l,curDistrictId:e[0].DistrictId,channelType:t.trackLogTag}),t.onReloadPageList(e[0])):e.length>0&&e[0].DistrictId!==l&&(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_district_recommend_success_show_select_districts",pageDistrictId:l,curDistrictId:e[0].DistrictId,channelType:t.trackLogTag}),t.onReloadPageList(e[0]),t.onShowSelectDistrict(e))};t.latLngAddressInfo&&t.latLngAddressInfo.lat&&t.latLngAddressInfo.lng?(e=(new Date).getTime(),d({lat:t.latLngAddressInfo.lat,lng:t.latLngAddressInfo.lng,address:t.latLngAddressInfo.address})):t.isNeedAddress||t.isForceLocate?(e=(new Date).getTime(),s.getLocationInfo({fromTag:t.trackLogTag,locationType:2,needAddress:!0,onComplete:function(i){i&&i.lat&&i.lng&&i.address?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_address_success",channelType:t.trackLogTag}),d({lat:i.lat,lng:i.lng,geoType:i.geoType,address:i.address})):(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_address_fail",flag:"onComplete",channelType:t.trackLogTag}),"FOODS"===t.trackLogTag?e&&(new Date).getTime()-e>5e3?t.onFetchLatLngFail("timeout"):t.onFetchLatLngFail():e&&(new Date).getTime()-e<5e3&&t.onFetchLatLngFail())},onCityError:function(){},onCommonError:function(){o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_address_fail",flag:"onCommonError",channelType:t.trackLogTag}),"FOODS"===t.trackLogTag?e&&(new Date).getTime()-e>5e3?t.onFetchLatLngFail("timeout"):t.onFetchLatLngFail():e&&(new Date).getTime()-e<5e3&&t.onFetchLatLngFail()}})):a&&r&&(e=(new Date).getTime(),d({lat:a,lng:r}))},saveUserActionCache:function(t,s,n){var a={1:300,2:21600},r={system:1,userAction:2};t.isRead=!1,t.timeout=a[t.timeout],t.cacheType=r[t.cacheType],s=s||function(){},n=n||function(){},i.isHybrid()&&i.compareAppVersion("7.4")<1&&(i.compareAppVersion("7.5")<1?(o.cTrackLog(100091,{actionType:"browse",actionCode:"doCommonTradingAfterLoad_saveUserActionCache",districtId:t.destId,bizType:t.bizType}),CtripBusiness.appSetCityMapping(t.destId,t.bizType,"gs_district",6),s()):e.doBusinessJob({businessCode:80050,data:t,callback:function(t){"do_business_job"==t.tagname&&(t.param&&t.param.sequenceId?s():n())}}))},gsTradingVersionStorage:{getVersion:function(t){var e=!0,i=0,o=window.localStorage.getItem("Common_GsCommonTrading_Version"),s=window.localStorage.getItem("Common_GsCommonTrading_Version_Close");if(o=o?JSON.parse(o):[],s=s?JSON.parse(s):[],t){for(var n=0;n<s.length;n++)if(s[n].districtId==t&&(new Date).getTime()-s[n].closeTimer<=144e5){e=!1;break}for(var n=0;n<o.length;n++)if(o[n].districtId==t&&(new Date).getTime()-o[n].setTimer<=864e5){i=o[n].version;break}}return{isShow:e,version:i}},setVersion:function(t,e){var i=window.localStorage.getItem("Common_GsCommonTrading_Version");if(i=i?JSON.parse(i):[],t&&e){for(var o=0;o<i.length;o++)if(i[o].districtId==t){i.splice(o,1);break}i.push({districtId:t,version:e,setTimer:(new Date).getTime()}),window.localStorage.setItem("Common_GsCommonTrading_Version",JSON.stringify(i))}},closeVersion:function(t){var e=!1,i=window.localStorage.getItem("Common_GsCommonTrading_Version_Close");if(i=i?JSON.parse(i):[],t){for(var o=0;o<i.length;o++)if(i[o].districtId==t){i[o].closeTimer=(new Date).getTime(),e=!0;break}e||i.push({districtId:t,closeTimer:(new Date).getTime()}),window.localStorage.setItem("Common_GsCommonTrading_Version_Close",JSON.stringify(i))}}}}}),define("gsNextPage",[],function(){return{pageIndex:null,pageTotal:null,bindScrollEvent:function(t){var e=this,i=0,o=($(window),t.content||window),s=t.listId||"#search_result_list",n=t.noMoreResult||".noMoreResult",a=(t.renderNextPage,t.topHeight||0),r=t.extra||0,c=t.windowHeight||$(window).height();e.pageIndex=t.pager.pageIndex;var l,d,h=$(o).scrollTop();$(o).off("scroll").on("scroll",function(p){i=c;var u=$(o).scrollTop();if(u-h>0&&($(".js_ttdlist").hide(),clearTimeout(d),d=setTimeout(function(){$(".js_ttdlist").show()},200)),h=$(o).scrollTop(),l=e.pageTotal?e.pageTotal:t.pager.totalCount,e.pageIndex*t.pager.pageNum>=l)return $(".loading_bottom_box").hide(),$(n).show(),!1;var m=$(s).height();i+u-m+r-a>=0&&(t.renderNextPage(),$(".js_ttdlist").show())})}}}),define("gsRouterRedirect",["cHybridFacade","gsAppAgent","gsCommonStore","cGuiderService"],function(t,e,o,s){var n={project:{shops:"https://m.fat51.qa.nt.ctripcorp.com"},type:{fat:"https://m.fat59.qa.nt.ctripcorp.com",uat:"//m.uat.qa.nt.ctripcorp.com",ctrip:"//m.ctrip.com"}};return{IF_OFF_VIDEO:!1,TARGET_MODEL_MAP:{1:"app",2:"h5",3:"browser",4:"open"},isHybrid:e.isHybrid(),appProtocol:e.appUrl(),forwardHistoryStore:o.ForwardHistoryStore.getInstance(),viewMap:{},closeAudio:function(){this.IF_OFF_VIDEO=!0},toBack:function(t){var i=this,o=t&&t.url?t.url:"",n=t&&t.param?t.param:"";if(i.IF_OFF_VIDEO&&(Lizard.isInCtripApp||Lizard.isHybrid)&&(param=[],window.CtripUtil.app_open_url("ctrip://wireless/destination/showVoiceView?index=0&size=10&showVoice=0&type=2&voiceList="+encodeURIComponent(JSON.stringify(param)),1)),(e.isGsHybrid()||e.isSmlHybrid())&&window.GSApiUtil&&GSApiUtil.closeAndPassValue)return GSApiUtil.closeAndPassValue(JSON.stringify({param:n})),!1;if(i.isHybrid||e.isGsHybrid()||e.isSmlHybrid())"object"==typeof n?s.backToLastPage({param:JSON.stringify(n)}):s.backToLastPage({param:n});else{var a=Lizard.P("from");if(a){var r,c=[],l=window.location.search;-1==a.indexOf("/livestream/")&&(l=l.toLowerCase()),l.replace(/(?:[\?&])(\w+)=([^#&\s]*)/g,function(t,e,i){"from"==e&&c.push(decodeURIComponent(i))}),_.each(c,function(t,e){i._checkUrl(t)&&(r=t)}),r?window.location.href=r:o?window.location.href=o:window.history.back()}else o?window.location.href=o:window.history.back()}},toHome:function(){this.isHybrid?s.home():this.toJump({url:["//m.ctrip.com"]})},toCtrip:function(){this.isHybrid?s.home():this.toJump({url:["//m.ctrip.com"]})},getTarget:function(t,e){var i=t.target,o=e&&e.elem?e.elem:"a";return i.nodeName!==o.toUpperCase()?$(i).closest(o):$(i)},toJump:function(t){var i=this,o=t&&t.url?t.url:"",n=t&&t.host?Lizard.H5BaseUrl||"//m.ctrip.com":"",a=t&&t.targetModel?t.targetModel:"4",r=!(!t||!t.hasOpenAudio)&&t.hasOpenAudio;if(o)switch(parseInt(a)){case 1:o=i.isHybrid?o.length>1?o[1].indexOf("ctrip://wireless")>-1?o[1]:i.appProtocol+o[1]:i.appProtocol+o[0]:n+o[0],a="app";break;case 2:o=i.isHybrid&&o.length>1?n+o[1]:n+o[0],0==o.indexOf("//")&&(o=location.protocol.indexOf("https")>=0?"https:"+o:"http:"+o),(this.isHybrid||Lizard.isInCtripApp)&&(o=this.initializeHeaderColorByUrl(o)),e.isGsHybrid()&&(o="ctripgs://wireless/h5?url="+encodeURIComponent(o)),e.isSmlHybrid()&&(o="ctripsml://wireless/h5?url="+encodeURIComponent(o)),a="h5";break;case 3:o=n+o[0],e.isGsHybrid()&&(o="ctripgs://wireless/h5?url="+encodeURIComponent(o)),e.isSmlHybrid()&&(o="ctripsml://wireless/h5?url="+encodeURIComponent(o)),a="browser";break;case 4:o=i.isHybrid?o.length>1?o[1]:o[0]:n+o[0],(this.isHybrid||Lizard.isInCtripApp)&&(o=this.initializeHeaderColorByUrl(o)),e.isGsHybrid()&&(0!=o.indexOf("//")&&0!=o.indexOf("http")&&(o=(Lizard.H5BaseUrl||"//m.ctrip.com")+o),0==o.indexOf("//")&&(o=location.protocol.indexOf("https")>=0?"https:"+o:"http:"+o),o="ctripgs://wireless/h5?url="+encodeURIComponent(o)),e.isSmlHybrid()&&(0!=o.indexOf("//")&&0!=o.indexOf("http")&&(o=(Lizard.H5BaseUrl||"//m.ctrip.com")+o),0==o.indexOf("//")&&(o=location.protocol.indexOf("https")>=0?"https:"+o:"http:"+o),o="ctripsml://wireless/h5?url="+encodeURIComponent(o)),a="open"}else o=window.location.href,a="refresh";i.IF_OFF_VIDEO&&!r&&(Lizard.isInCtripApp||Lizard.isHybrid)&&(param=[],window.CtripUtil.app_open_url("ctrip://wireless/destination/showVoiceView?index=0&size=10&showVoice=0&type=2&voiceList="+encodeURIComponent(JSON.stringify(param)),1)),s.jump({url:i._appendParam(o),targetModel:a})},_setPageUrl:function(t,e,i){var o=localStorage.getItem("GS_H5_PAGE_HISTORY_MAP"),s=[];if(null!=o&&""!=o)try{s=JSON.parse(o)}catch(t){s=[]}for(var n=!1,a=0;a<s.length;a++)if(s[a].id==e&&s[a].module==t){s[a].url=i,n=!0;break}if(!n){var r={id:e,module:t,url:i};s.push(r)}var c=JSON.stringify(s);localStorage.setItem("GS_H5_PAGE_HISTORY_MAP",c)},_getPageUrl:function(t,e,i){if(Lizard.P("from"))return Lizard.P("from");var o=localStorage.getItem("GS_H5_PAGE_HISTORY_MAP"),s=[];null!=o&&""!=o&&(s=JSON.parse(o));for(var n=0;n<s.length;n++)if(s[n].id==e&&s[n].module==t)return s[n].url;return i||Lizard.appBaseUrl.replace("webapp/you/","")+"html5"},_checkUrl:function(t){return(t.indexOf("http://")>=0||t.indexOf("https://")>=0||t.indexOf("webapp/")>=0||t.indexOf("html5/")>=0)&&(t.indexOf("ctripcorp.com")>=0||t.indexOf("ctrip.com")>=0)},_appendParam:function(t){return this.isHybrid||e.isGsHybrid()||Lizard.P("twojumpwakeup")&&(t.search(/openapp=\d+/gi)>=0?t=t.replace(/openapp=\d+/gi,"openapp=3"):t+=t.search(/\?/gi)>=0?"&openapp=3":"?openapp=3",Lizard.P("channel_app")&&(t+=t.search(/\?/gi)>=0?"&channel_app="+Lizard.P("channel_app"):"?channel_app="+Lizard.P("channel_app")),Lizard.P("partner_link")&&(t+=t.search(/\?/gi)>=0?"&partner_link="+Lizard.P("partner_link"):"?partner_link="+Lizard.P("partner_link"))),t},getBackUrl:function(t,e,i){var o=Lizard.P("from"),s=Lizard.instance.curView.config.viewName,n=this.forwardHistoryStore.get()||{},a=n[t]||[],r=a.length;if(o&&this._checkUrl(o))return n[t]=[],this.forwardHistoryStore.set(n),o;if(e)return n[t]=[],this.forwardHistoryStore.set(n),e;if(1<r&&a[r-1].viewName==s){a.length=r-1,r--;var c=a[r-1].url||"";if("_____FROM_____"==a[r-1].viewName&&(a=[]),n[t]=a,this.forwardHistoryStore.set(n),this._checkUrl(c))return c}return i?(n[t]=[],this.forwardHistoryStore.set(n),i):(n[t]=[],this.forwardHistoryStore.set(n),Lizard.H5BaseUrl+"/webapp/you")},savePageHistory:function(t){var e=Lizard.P("from"),i=Lizard.instance.curView.config.viewName,o=location.href,s=this.forwardHistoryStore.get()||{},n=t.module;modelHistory=s[n]||[],e?(modelHistory=[],modelHistory.push({viewName:"_____FROM_____",url:e}),modelHistory.push({viewName:i,url:o})):0!=modelHistory.length&&modelHistory[modelHistory.length-1].viewName==i||modelHistory.push({viewName:i,url:o}),s[n]=modelHistory,this.forwardHistoryStore.set(s)},ForwardPage:function(t){t=t||{};var i=this,o=t.urls||[],n=t.opts||"",a=t.targetModel||4,r=t.forceJump,c=t&&t.host?Lizard.H5BaseUrl||"//m.ctrip.com":"",l=t.withFrom,d=o[0];i.IF_OFF_VIDEO&&(Lizard.isInCtripApp||Lizard.isHybrid)&&(param=[],window.CtripUtil.app_open_url("ctrip://wireless/destination/showVoiceView?index=0&size=10&showVoice=0&type=2&voiceList="+encodeURIComponent(JSON.stringify(param)),1));try{if(this.isHybrid||Lizard.isInCtripApp||e.isGsHybrid()||e.isSmlHybrid()){switch(parseInt(a)){case 1:d=o[1]?o[1].indexOf("ctrip://wireless")>=0||o[1].indexOf("ctripgs://wireless")>=0?o[1]:this.appProtocol+o[1]:o[0];break;case 2:d=c+d,0==d.indexOf("//")&&(d=location.protocol.indexOf("https")>=0?"https:"+d:"http:"+d),(this.isHybrid||Lizard.isInCtripApp)&&(d=this.initializeHeaderColorByUrl(d)),e.isGsHybrid()?d="ctripgs://wireless/h5?url="+encodeURIComponent(d):e.isSmlHybrid()&&(d="ctripsml://wireless/h5?url="+encodeURIComponent(d));break;case 4:d=o[1]?o[1]:o[0],(this.isHybrid||Lizard.isInCtripApp)&&(d=this.initializeHeaderColorByUrl(d)),e.isGsHybrid()?(d=o[0],0!=d.indexOf("//")&&0!=d.indexOf("http")&&(d=(Lizard.H5BaseUrl||"//m.ctrip.com")+d),0==d.indexOf("//")&&(d=location.protocol.indexOf("https")>=0?"https:"+d:"http:"+d),d="ctripgs://wireless/h5?url="+encodeURIComponent(d)):e.isSmlHybrid()&&(d=o[0],0!=d.indexOf("//")&&0!=d.indexOf("http")&&(d=(Lizard.H5BaseUrl||"//m.ctrip.com")+d),0==d.indexOf("//")&&(d=location.protocol.indexOf("https")>=0?"https:"+d:"http:"+d),d="ctripsml://wireless/h5?url="+encodeURIComponent(d));break;default:d=c+d,e.isGsHybrid()?d="ctripgs://wireless/h5?url="+encodeURIComponent(d):e.isSmlHybrid()&&(d="ctripsml://wireless/h5?url="+encodeURIComponent(d))}s.jump({url:d,targetModel:this.TARGET_MODEL_MAP[a]})}else{if("external"===Lizard.P("fromType")&&(d+=(d.indexOf("?")>0?"&":"?")+"fromType=external&popup=close&autoawaken=close"),l&&(d+=(d.indexOf("?")>0?"&":"?")+"from="+encodeURIComponent(location.href)),r)return void(location.href=i._appendParam(d));this.h5Redirect(i._appendParam(d),n)}}catch(t){}},initializeHeaderColorByUrl:function(t){var i=!1,o=!1;return(this.isHybrid||Lizard.isInCtripApp)&&e.compareAppVersion("7.6")<1&&(i=-1===t.indexOf("isHideNavBar=YES")&&-1===t.indexOf("navBarStyle=white"),o=t.indexOf("https://")>-1||t.indexOf("http://")>-1,i&&(o&&t.indexOf("webapp/you/")>-1?-1==t.indexOf("webapp/you/hotelasks")&&-1==t.indexOf("webapp/you/hotels")&&(t+=(t.indexOf("?")>0?"&":"?")+"navBarStyle=white"):(t.indexOf("food/")>-1||t.indexOf("destination/")>-1)&&(t+=(t.indexOf("?")>-1?"&":"?")+"navBarStyle=white"))),t},BackPage:function(t){if(this.isHybrid||Lizard.isInCtripApp||e.isGsHybrid()||e.isSmlHybrid())"object"==typeof t.datas?s.backToLastPage({param:JSON.stringify(t.datas)}):s.backToLastPage({param:t.datas});else if(t.historyBack)window.history.back();else{var i=this.getBackUrl(t.module,t.url,t.defaultTarget);if(i.indexOf("/you/"+t.module)<0||t.forceBack)return void(location.href=i);this.h5Redirect(i,t.opts,!0)}},h5Redirect:function(t,e,i){e=e||{};var o=this.queryViewName(t);o&&(e.viewName=o),this.cacheCurrView(),Lizard.goTo(t,e)},cacheCurrView:function(){var t=location.pathname;if(!this.queryViewName(t)){var e=this.queryUrlSchema(t),i=Lizard.instance.curView.config.viewName;e&&i&&(this.viewMap[i]=e)}},queryViewName:function(t){var e;for(var i in this.viewMap)if(this.viewMap.hasOwnProperty(i)&&(e=this.viewMap[i],e.test(t)))return i;return null},queryUrlSchema:function(t){var e;for(var i in Lizard.urlSchemaMap)if(Lizard.urlSchemaMap.hasOwnProperty(i)&&(e=new RegExp("/"+i,"i"),e.test(t)))return e;return null},getStraightLink:function(t){if(!this.isHybrid)return"";var e=n.type.ctrip,i=window.localStorage.getItem("isPreProduction");return"0"===i?(e=n.type.fat,t&&t.project&&n.project[t.project]&&(e=n.project[t.project])):"2"===i&&(e=n.type.uat),e},triggerDrag:function(e){var o={isRegister:!0,tagname:t.METHOD_WEB_VEW_DID_APPEAR,callback:""};for(i in e)o[i]=e[i];CtripPage.app_enable_drag_animation(!0),o&&o.isRegister&&t.register({tagname:o.tagname,callback:function(t){CtripPage.app_enable_drag_animation(!0),o&&o.callback&&o.callback(t)}})},disableDrag:function(){CtripPage.app_enable_drag_animation(!1)}}}),define("gsShowTime",[],function(){return{getDateTime:function(t){var e=this,o={times:"",sign:"-",type:!0};for(i in t)o[i]=t[i];return e.times=new Date(e.formatDataTime(o.times)),e.sign=o.sign,e.type=o.type,e.formatTime()},getLaterDay:function(t){var e=this,i=t?24*parseInt(t)*60*60*1e3:0,o=new Date((new Date).getTime()+i),s=e.transTime(o);return s.tYear+s.tMonth+s.tDate},formatTime:function(){var t=this,e="",i=t.sign,o=t.transTime(t.times);return e=o.tYear+i+o.tMonth+i+o.tDate,t.type&&(e=e+" "+o.tHours+":"+o.tMinutes+":"+o.tSeconds),e},transTime:function(t){var e=this;return{tYear:t.getFullYear().toString(),tMonth:e.addZero((t.getMonth()+1).toString()),tDate:e.addZero(t.getDate().toString()),tHours:e.addZero(t.getHours().toString()),tMinutes:e.addZero(t.getMinutes().toString()),tSeconds:e.addZero(t.getSeconds().toString())}},addZero:function(t){return t<10?"0"+t:t},formatDataTime:function(t){return t=t||"/Date(0000000000000+0800)/",parseInt(t.match(/\d+/)[0])},getSubTime:function(t){var e=this,o={times:"",now:"",sign:"-",type:!1};for(i in t)o[i]=t[i];var s=e.formatDataTime(o.times),n=e.formatDataTime(o.now),a=(n-s)/6e4;return a<1?"刚刚":a<60?a.toFixed(0)+"分钟前":a<1440?(a/60).toFixed(0)+"小时前":e.getDateTime({times:o.times,sign:o.sign,type:o.type})}}}),define("gsCitySearchHistory",["cUIBase","libs"],function(t,e){var i=function(e){this.element,this.clazz=[t.config.prefix+"history"],this.maskName="maskName",this.style={},this.size=!1,this.listSize=6,this.itemClickFun=null,this.focusFun=null,this.blursFun=null,this.inputFun=null,this._id=t.getCreateId(),this._boxDom,this._borderDom,this._contDom,this._clearButton,this.clearButtonTitle="清除搜索历史",this.notHistoryButtonTitle="无搜索历史",this.historyStore=null,this.dataSource=[],this._autoLocResoure,this._bodyDom,this.rootBox,this._oneShow=!1;var i=this;this.event_focus=function(){i.Open(),"function"==typeof i.focusFun&&i.focusFun()},this.event_blur=function(){"function"==typeof i.blurFun&&i.blurFun()},this.event_input=function(){""==i.element.val()&&(i._init(),i.Open()),i.inputFun(i.element.val())},this._setOption(e),this._init()};return i.prototype={_setOption:function(t){for(var e in t)switch(e){case"element":case"maskName":case"clearButtonTitle":case"style":case"dataSource":case"historyStore":case"itmeClickFun":case"focusFun":case"blurFun":case"inputFun":case"size":case"listSize":case"rootBox":this[e]=t[e];break;case"clazz":isArray(t[e])&&(this.clazz=this.clazz.concat(t[e])),isString(t[e])&&this.clazz.push(t[e])}},_init:function(){this._contDom&&(this._contDom.find("li.item").unbind("click"),this._contDom.remove()),this._boxDom&&this._boxDom.remove(),this._CreateDom(),this._BuildEvent()},_CreateDom:function(){var e=t.createElement;this._bodyDom=this.rootBox||$("body"),this.element=$(this.element),this._boxDom=$(e("div",{id:this._id,class:this.clazz.join(" ")})),this._boxDom.css({position:"absolute",display:"none"}),this._borderDom=$(e("div",{class:t.config.prefix+"history-border"}));var i=[];i=""==this.element.val()?this._getHistory():this._getSubList(this.dataSource,this.listSize),this._contDom=$(e("ul",{class:t.config.prefix+"history-list"}));for(var o in i)this._contDom.append('<li class="item" data_id="'+i[o].id+'" data_name="'+i[o].name+'" data_cityId="'+i[o].cityId+'" data_isOverseas="'+i[o].isOverseas+'">'+i[o].name+"</li>");""==this.element.val()&&(this._clearButton=$(e("li",{class:[t.config.prefix+"clear-history clearbutton"]})),i.length>0?this._clearButton.html(this.clearButtonTitle):this._clearButton.html(this.notHistoryButtonTitle),this._contDom.append(this._clearButton)),this._borderDom.append(this._contDom),this._boxDom.append(this._borderDom),this._bodyDom.append(this._boxDom)},_Location:function(){this._boxDom.css({height:"auto",width:"auto"});var e=t.getPageSize(),i=t.getElementPos(this.element[0]),o=this.style.left?this.style.left:(this.size&&this.size.left?this.size.left+i.left:i.left)+"px",s=this.style.top?this.style.top:(this.size&&this.size.top?this.size.top+(i.top+this.element.height()):i.top+this.element.height())+"px",n=this.style.width?this.style.width:this.element.width()+"px",a=this.size&&this.size.height?e.height+this.size.height+"px":"auto";this._boxDom.css({left:o,top:s,width:n,height:a})},_AutoLocation:function(){this._Location();var t=this;this._autoLocResoure=function(){t._Location()},$(window).unbind("resize",this._autoLocResoure),$(window).bind("resize",this._autoLocResoure)},_UnAutoLocation:function(){$(window).unbind("resize",this._autoLocResoure)},_BuildEvent:function(){var t=this;this._contDom.find("li.item").unbind("click").bind("click",function(){var e=$(this);if(t.element.val(e.text()),t.Close(),"function"==typeof t.itmeClickFun){var i={id:e.attr("data_id"),name:e.text(),cityId:e.attr("data_cityId"),isOverseas:e.attr("data_isOverseas")};t.itmeClickFun(i)}}),this.element.unbind("focus",this.event_focus),this.element.unbind("blur",this.event_blur),this.element.unbind("input",this.event_input),this.element.bind({focus:this.event_focus,blur:this.event_blur,input:this.event_input}),""==this.element.val()&&this._getHistory().length>0&&this._clearButton.bind("click",function(){t.historyStore.remove(),t.Close(),t._init(),t.Open()})},setOpen:function(){this._oneShow=!0},Open:function(){this._boxDom.css("z-index",t.getBiggerzIndex()),this._boxDom.show(),this._AutoLocation()},Close:function(){this._boxDom.hide(),this._UnAutoLocation()},setDataSource:function(t){this.dataSource=t,this.Close(),this._init(),this.Open()},addHistory:function(t){var e=this.historyStore.get()||[];t.id||(t.id=0);for(var i=-1,o=0,s=e.length;o<s;o++)if(e[o].name==t.name){i=o;break}i>-1&&e.splice(i,1),e.unshift(t),this.historyStore.set(e),this._init()},reset:function(){this._init()},_getHistory:function(){var t=this.historyStore.get()||[];return this._getSubList(t,this.listSize)},_getSubList:function(t,e){return t.length<=e?t:t.slice(0,e)}},i}),define("text!templateCitylist",[],function(){return'<article class="greyfont scrollfix modb_clist"><section class="cui-citys-hd cui-input-focus gs_search_wrap"><div class="cui-input-bd clear-input-box gs_search_box" style="width: 100%"><input id="city_keyword" type="text" class="cui-input-box" placeholder="中文/拼音/首字母"></div><button type="button" class="cui-btn-cancle search_cancel" style="display: none">取消</button></section><div id="city_tab_wrapper"></div><ul id="city_all" class="cui-city-itmes city_box"></ul><ul id="city_inland" class="cui-city-itmes city_box"><li class="city_current_nearby modb_gridlist" style="display:none"><span class="cui-city-t">周边城市</span><ul class="cui-city-n"><li class="city_local_nearby gs-citylist-item">定位中</li></ul></li><li class="city_current modb_gridlist" style="display:none"><span class="cui-city-t">当前城市</span><ul class="cui-city-n"><li class="city_local gs-citylist-item">定位中</li></ul></li></ul><ul id="city_inter" class="cui-city-itmes city_box"><li class="city_current_nearby modb_gridlist" style="display:none"><span class="cui-city-t">周边城市</span><ul class="cui-city-n"><li class="city_local_nearby gs-citylist-item">定位中</li></ul></li><li class="city_current modb_gridlist" style="display:none"><span class="cui-city-t">当前城市</span><ul class="cui-city-n"><li class="city_local gs-citylist-item">定位中</li></ul></li></ul></article><script type="text/lizard-template" id="city_item_tpl"><%items.forEach(function(item){%><li class="gs-citylist-item" data-id="<%=item.districtId%>" data-name="<%=item.cityName%>" data-attr="<%=Number(item.isdomestic)%>" data-ename="<%=item.cityEName%>"><%=item.cityName%></li><%})%><\/script><script type="text/lizard-template" id="city_list_tpl"><%if (history&&!!history.length){%><li class="modb_gridlist"><span class="cui-city-t">历史城市</span><ul class="cui-city-n"><%history.forEach(function(item){%><li class="gs-citylist-item" data-id="<%=item.districtId%>" data-name="<%=item.name%>" data-attr="<%=Number(item.isdomestic)%>" data-ename="<%=item.eName%>"><%=item.name%></li><%})%></ul></li><%}%> <%if (hots&&!!hots.length){%><li class="modb_gridlist"><span class="cui-city-t">热门城市</span><ul class="cui-city-n"><%hots.forEach(function(item){%><li class="gs-citylist-item" data-id="<%=item.districtId%>" data-name="<%=item.cityName%>" data-attr="<%=Number(item.isdomestic)%>" data-ename="<%=item.cityEName%>"><%=item.cityName%></li><%})%></ul></li><%}%> <%\'ABCDEFGHIJKLMNOPQRSTUVWXYZ\'.split(\'\').forEach(function(item){if(list[item]){%><li class="cui-arrow-close c-citylist-parent cityGroup<%=item%>"><span class="cui-city-t"><%=item%></span><ul class="cui-city-n c-citylist-child"></ul></li><%}})%><\/script><script type="text/lizard-template" id="city_all_tpl"><li><ul class="cui-city-n"><li class="gs-citylist-item" data-id="0" data-name="全部目的地" data-attr="1">全部目的地</li></ul></li><\/script>'}),define("gsCityList",["libs","cPageView","UITab","cUtility","gsCitySearchHistory","gsCommonGeolocation","gsCommonModel","gsCommon","gsCommonStore","text!templateCitylist","gsAppAgent","gsRouterRedirect"],function(t,e,i,o,s,n,a,r,c,l,d,h){return e.extend({pageid:0,hpageid:1,specialIds:{HK:38,MC:39,TP:360},request:{},selectedCity:{districtId:0,name:"全部目的地",isdomestic:1},historyStyle:{width:"100%",left:"0px",top:"48px"},defaultTab:0,cityListModel:a.GetCityList.getInstance(),curNearByCityListModel:a.GetCurNearByCityList.getInstance(),citylistStore:c.CityListStore.getInstance(),historyCityStore:c.HistoryCityStore.getInstance(),kwHistoryStore:c.KWHistoryStore.getInstance(),CRT_TAB:0,curSearchList:null,initParam:function(){},render:function(){this.$el.html(l),this.els={city_box:this.$el.find(".city_box"),
city_all:this.$el.find("#city_all"),city_inland:this.$el.find("#city_inland"),city_inter:this.$el.find("#city_inter"),city_associate:this.$el.find(".city_associate"),city_search_wrap:this.$el.find(".gs_search_wrap"),city_keyword:this.$el.find("#city_keyword"),city_tab_wrapper:this.$el.find("#city_tab_wrapper"),city_current:this.$el.find(".city_current"),city_current_nearby:this.$el.find(".city_current_nearby"),city_local:this.$el.find(".city_local"),city_local_nearby:this.$el.find(".city_local_nearby"),city_list_tpl:this.$el.find("#city_list_tpl"),city_list_item_tpl:this.$el.find("#city_item_tpl"),city_all_tpl:this.$el.find("#city_all_tpl"),searchCancel:this.$el.find(".search_cancel"),searchBox:this.$el.find(".gs_search_box")},this.allCityRender=_.template(this.els.city_all_tpl.html()),this.listRender=_.template(this.els.city_list_tpl.html()),this.listItemRender=_.template(this.els.city_list_item_tpl.html())},events:{"click .search_cancel":"searchCancelAction","click .c-citylist-parent":"expandCityItemAction","click .gs-citylist-item":"cityItemAction"},expandCityItemAction:function(t){var e=$(t.currentTarget);return t.currentTarget.dataset.rendered||(this.renderCityItem(e),this.selectedCity.districtId=this.selectedCity.districtId||0,t.currentTarget.dataset.rendered=1),e.hasClass("cui-arrow-open")?(e.removeClass("cui-arrow-open").addClass("cui-arrow-close"),e.find(".c-citylist-child").hide()):(this.$el.find(".c-citylist-parent.cui-arrow-open").removeClass("cui-arrow-open").addClass("cui-arrow-close").find(".c-citylist-child").hide(),e.removeClass("cui-arrow-close").addClass("cui-arrow-open"),e.find(".c-citylist-child").show()),!1},renderCityItem:function(t){var e=this.cityTabs.getIndex(),i=t.find("span").text(),o=this.data[e?"inter":"inland"][i],s=this.listItemRender({items:o});t.find("ul").html(s)},onCreate:function(){this.initParam(),this.render(),this.initKwHistory();var t=this.request.curCity;t&&(this.selectedCity={districtId:t.id,name:t.name},this.selectedCity.listType=this._getListType(t.id)),this._onScroll=$.proxy(this.onScroll,this),this._touchStartHandler=$.proxy(this.touchStartHandler,this),this._touchMoveHandler=$.proxy(this.touchMoveHandler,this);var e=[{id:0,name:"国内城市"},{id:1,name:"海外城市"}];if(this.cityTabs=new i({datamodel:{data:e},wrapper:this.els.city_tab_wrapper,onChange:$.proxy(this.onchange,this)}),this.cityTabs.show(),o.isInApp){var s=navigator.userAgent.match(/iP(ad|hone|od)\sos\s(\d)/i);s&&s[2]&&s[2]>=7&&this.els.city_search_wrap.addClass("pt24")}this.autoCompleteInput&&this.autoCompleteInput.reset()},onchange:function(t){this.els.city_keyword.blur(),this.historyCityStore.setAttr("tab",t.id),this.showList(t.id)},onShow:function(){var t=this,e=this.historyCityStore.get();this.CRT_TAB=e?e.tab:0,this.showLoading(),t.request.hideTitle||t.refreshHeader(),this.updatePage(function(){t.hideLoading(),"undefined"!=typeof CtripUtil&&CtripUtil.logMarketPagePerformance&&CtripUtil.logMarketPagePerformance("you",t.hpageid,{}),t.els.city_current.show(),t.els.city_current_nearby.show(),t.els.city_local.text("定位中"),t.nearbyTourAndPos(),t.els.city_tab_wrapper.show(),$(window).bind("touchstart",t._touchStartHandler),$(window).bind("touchmove",t._touchMoveHandler)},function(){t.hideLoading(),t.showWarning404(function(){t.hideWarning404()})}),"sight"==this.model&&document.cookie.indexOf("AllianceID=807802")>-1&&document.cookie.indexOf("SID=1368984")>-1&&$(".js_back").hide()},onHide:function(){$(window).unbind("touchstart",this._touchStartHandler),$(window).unbind("touchmove",this._touchMoveHandler),$(window).unbind("scroll",this._onScroll)},refreshHeader:function(){this.header.set({whiteBackground:function(){var t="";return(Lizard.isHybrid||Lizard.isInCtripApp)&&this.request&&this.request.isRestaurant&&d.compareAppVersion("7.6")<1&&(t=!0),t}(),left:[{tagname:"back",color:d.compareAppVersion("7.6")<1?"#333333":"",highlightColor:d.compareAppVersion("7.6")<1?"#333333":"",callback:function(){h.toBack()}}],center:{tagname:"title",value:["选择城市"]}}),this.header.show()},updatePage:function(t,e){var i,o=this.citylistStore.get(),s=this;o?(this.initSelectedCity(o),this.renderList(o),t&&t()):(this.request&&this.request.isRestaurant&&(this.cityListModel.param.source="foods"),this.cityListModel.excute(function(e){i=s._dataformat(e.appDistricts||[]),localStorage.removeItem("GS_H5_CITY_LIST_V0"),s.citylistStore.set(i),s.renderList(i),t&&t.call(s)},function(){s.showToast("网络不给力, 稍后再试试吧."),e&&e()}))},sortHotCity:function(t,e){return t.hFlag-e.hFlag},getCityListByFirstChar:function(t,e){return!t[e]&&(t[e]=[]),t[e]},classifyCity:function(t,e){var i=t.firstLetter.toUpperCase();this.getCityListByFirstChar(e,i).push(t),t.districtId==this.specialIds.HK&&this.getCityListByFirstChar(e,"H").unshift(t),t.districtId==this.specialIds.MC&&this.getCityListByFirstChar(e,"M").unshift(t)},initSelectedCity:function(t){var e,i,o=t.inland||{};inter=t.inter||{};for(j in o){i=o[j]||[];for(var s=0;s<i.length;s++)if(e=i[s],this.selectedCity.districtId==e.districtId)return this.selectedCity.firstLetter=e.firstLetter.toUpperCase(),void(this.selectedCity.isdomestic=1)}for(k in inter){i=inter[k]||[];for(var s=0;s<i.length;s++)if(e=i[s],this.selectedCity.districtId==e.districtId)return this.selectedCity.firstLetter=e.firstLetter.toUpperCase(),void(this.selectedCity.isdomestic=0)}},_dataformat:function(t){for(var e,i={},o=[],s={},n=[],a=0;a<t.length;a++)e=t[a],this.selectedCity.districtId==e.districtId&&(this.selectedCity.firstLetter=e.firstLetter.toUpperCase(),this.selectedCity.isdomestic=0===e.countryID||1==e.countryID),0===e.countryID?(e.isdomestic=1,e.isHot&&(o.push(e),n.push(e)),this.classifyCity(e,i),this.classifyCity(e,s)):1===e.countryID?(e.isdomestic=1,e.isHot&&o.push(e),this.classifyCity(e,i)):(e.isdomestic=0,e.isHot&&n.push(e),this.classifyCity(e,s));return{inland:i,inlandhot:o.sort(this.sortHotCity),inter:s,interhot:n.sort(this.sortHotCity)}},renderList:function(t){this.data=t;var e=this.historyCityStore.get()||{},i=e.inland||[],o=e.inter||[];if(this.els.city_current.siblings().not(this.els.city_current_nearby).remove(),!this.request.hideAllCity){var s=this.allCityRender();this.els.city_all.html(s)}if(this.request&&this.request.isRestaurant){var n=this.formatDateForRestaurant(i,o,t.inland,t.inter);i=n._inland,o=n._inter,t.inland=n.inland,t.inter=n.inter}var a=this.listRender({hots:t.inlandhot,list:t.inland,history:i,tab:1});this.els.city_inland.append(a);var r=this.listRender({hots:t.interhot,list:t.inter,history:o});this.els.city_inter.append(r),this.CRT_TAB=this.selectedCity.isdomestic?0:1,this.defaultTab&&(this.CRT_TAB=1),this.cityTabs.setIndex(this.CRT_TAB),this.showList(this.CRT_TAB),this.extendSelected(t)},formatDateForRestaurant:function(t,e,i,o){var s=[],n=[],a={},r={};return $.each(t,function(t,e){s.push(e)}),$.each(e,function(t,e){n.push(e)}),$.each(i,function(t,e){var o=[];$.each(e,function(t,e){e.cityId&&o.push(e)}),0==o.length?delete i[t]:a[t]=o}),$.each(o,function(t,e){var i=[];$.each(e,function(t,e){e.cityId&&i.push(e)}),0==i.length?delete r[t]:r[t]=i}),{_inland:s,_inter:n,inland:a,inter:r}},getCityInfoByDistrictId:function(t){if(0===(t=parseInt(t,10)))return{};var e="",i=this.citylistStore.get()||{};return $.each(i.inland,function(i,o){if($.each(o,function(i,o){if(o.districtId===t)return e=o,!1}),e)return!1}),""==e&&$.each(i.inter,function(i,o){if($.each(o,function(i,o){if(o.districtId===t)return e=o,!1}),e)return!1}),e||{}},extendSelected:function(t){this.selectedCity.districtId=this.selectedCity.districtId||0;var e=this.selectedCity.isdomestic?"#city_inland":"#city_inter";$(e).find(".cityGroup"+this.selectedCity.initial).click()},showList:function(t){switch(t){case 0:this.els.city_inter.hide(),this.els.city_inland.show();break;case 1:this.els.city_inter.show(),this.els.city_inland.hide()}},initKwHistory:function(){var t=this;this.autoCompleteInput=new s({element:this.els.city_keyword,style:this.historyStyle,size:{height:-5,top:8},historyStore:t.kwHistoryStore,listSize:20,itmeClickFun:function(e){t._scenicSpotSelect(e)},rootBox:this.$el,focusFun:function(){t._inputFocus()},inputFun:function(){t._keyInput()},clearHistoryAction:function(){t._clearKwHistory()}})},cityItemAction:function(t){var e=t.currentTarget.dataset.id,i=t.currentTarget.dataset.name,o=t.currentTarget.dataset.ename,s=t.currentTarget.dataset.attr;if(e&&i){var n={districtId:e,name:i,eName:o,isdomestic:1==s};this.addHistory(n),this.selectedCity={districtId:e,name:i,eName:o},this.backAction()}},_scenicSpotSelect:function(t){if(t.hasOwnProperty("name")&&(t.name=t.name.split(",")[0]),!t.hasOwnProperty("eName")){var e=this._getDataInSearchList(t.id);t.eName="",e&&(t.eName=e.hasOwnProperty("eName")?e.eName:"")}this.autoCompleteInput.addHistory({id:t.id,name:t.name,eName:t.eName,cityId:t.cityId,isOverseas:t.isOverseas}),this.selectedCity=t,this.selectedCity.districtId=t.id;var i=this._getListType(this.selectedCity.districtId);i||(i="true"==t.isOverseas?"inter":"inland");var o={districtId:t.id,name:t.name,eName:t.eName,isdomestic:"inland"==i};this.addHistory(o),this.searchCancelAction(),this.backAction()},_getDataInSearchList:function(t){if(this.curSearchList)for(var e in this.curSearchList){var i=this.curSearchList[e];if(i&&1*i.id==1*t)return i}return null},addHistory:function(t){var e=this,i=function(t,e,i){var o=i||4;return t=t.filter(function(t,i,o){return t.districtId!=e.districtId&&t.name!=e.name}),t.unshift(e),t.splice(o,t.length),t},o=function(t,o){var s=e.historyCityStore.get(),n=o?"inter":"inland";s[n]=i(s[n],t),s.last=t,s.crt=o,e.historyCityStore.set(s)};0!=t.districtId&&(t.isdomestic?(o(t,0),t.districtId!=this.specialIds.HK&&t.districtId!=this.specialIds.MC&&t.districtId!=this.specialIds.TP||o(t,1)):o(t,1))},backAction:function(){var t;this.selectedCity&&(t={city_id:parseInt(this.selectedCity.districtId,0),city_name:this.selectedCity.name,eName:this.selectedCity.eName}),"function"==typeof this.request.backAction&&this.request.backAction(t)},_getListType:function(t){if(0===(t=parseInt(t,10)))return"inland";var e="",i=this.citylistStore.get()||{};return $.each(i.inland,function(i,o){if($.each(o,function(i,o){if(o.districtId===t)return e="inland",!1}),e)return!1}),e||$.each(i.inter,function(i,o){if($.each(o,function(i,o){if(o.districtId===t)return e="inter",!1}),e)return!1}),e},_inputFocus:function(){this.els.searchBox.width("80%"),this.showSearchArea()},searchCancelAction:function(t){this.els.city_keyword.val(""),this._keyInput(),this.autoCompleteInput.setDataSource([]),this.autoCompleteInput.Close(),this.els.searchBox.width("100%"),this.hideSearchArea()},showSearchArea:function(){this.els.searchCancel.show(),this.els.city_inland.hide(),this.els.city_inter.hide()},hideSearchArea:function(){this.els.searchCancel.hide(),0==this.cityTabs.getIndex()&&this.els.city_inland.show(),1==this.cityTabs.getIndex()&&this.els.city_inter.show()},_keyInput:function(){var t=this,e=this.els.city_keyword.val();if(e.length>0){var i=this.els.searchBox.attr("class");$.inArray("clear_txt",i)&&this.els.searchBox.addClass("clear_txt");var o={Start:1,Count:20,OrderType:"CtripApp",OnlyGsShow:!0,Keyword:e,DistrictType:Lizard.P("fromplace")?"city":""};t.request.pageTypes&&(o.PageTypes=[t.request.pageTypes]),t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){a.getInputCityList(o,function(e){var i=t._parseLenevoData(e.Result||[]);t.curSearchList=i,t.autoCompleteInput.setDataSource(i),0===i.length&&t.els.city_associate.html('<p class="cui-city-novalue" style="">没有结果</p>')},function(){t.els.city_associate.html('<p class="cui-city-novalue" style="">没有结果</p>')})},1e3)}else t.timer&&clearTimeout(t.timer),this.els.searchBox.removeClass("clear_txt")},_clearKwHistory:function(){this.els.searchBox.width("100%"),this.hideSearchArea()},_parseLenevoData:function(t){var e=[];return $.each(t,function(t,i){var o=i.Name+(i.ParentName?", "+i.ParentName:"");e.push({id:i.Id,name:o,eName:i.EName,cityId:i.CityId,isOverseas:i.IsOverseas})}),e},nearbyTourAndPos:function(){var t=this,e=function(e){e?t.updateCurrentCity(e):t.els.city_current.hide(),e&&e.lat&&e.lng?t.updateCurrentNearbyCity(e):t.els.city_current_nearby.hide()},i=function(e,i){t.els.city_current.hide(),t.els.city_current_nearby.hide()};n.getLocationInfo({useGSCache:1,noCache:1,onCityComplete:e,onCommonError:i})},updateCurrentCity:function(t){var e=1;t&&(this.els.city_local.text(t.districtName),this.els.city_local.attr("data-id",t.districtId),this.els.city_local.attr("data-name",t.districtName),this.els.city_local.attr("data-eName",t.eName),"inter"==this._getListType(t.districtId)&&(e=0),this.els.city_local.attr("data-attr",e))},updateCurrentNearbyCity:function(t){var e,i,o,s,n=this,a="";t.lat&&t.lng&&(n.curNearByCityListModel.param.LatLng={Lat:t.lat,Lng:t.lng},n.curNearByCityListModel.excute(function(t){if(t&&t.Result&&t.Result.length>0){for(var r=0;r<t.Result.length;r++)e=t.Result[r].DistrictID,i=t.Result[r].DistrictName,o=t.Result[r].DistrictEName,s=t.Result[r].InChina?1:0,a+='<li class="city_local_nearby gs-citylist-item" data-id="'+e+'" data-name="'+i+'" data-eName="'+o+'" data-attr="'+s+'">'+i+"</li>";n.els.city_local_nearby.parent().html(a)}},function(){n.showToast("网络不给力, 稍后再试试吧.")}))},touchStartHandler:function(t){var e=t.touches[0];this.touchX=e.pageX,this.touchY=e.pageY},touchMoveHandler:function(t){var e=t.touches[0];(Math.abs(e.pageX-this.touchX)>=20||Math.abs(e.pageY-this.touchY)>=20)&&this.els.city_keyword.blur()},onScroll:function(t){this.els.city_keyword.blur(),$(window).unbind("scroll",this._onScroll)}})}),define("gsUIStar",["cCoreInherit","UIView"],function(t,e){return _.inherit(e,{propertys:function($super){$super(),this.datamodel={count:5,curNum:"",showInfo:"current",starInfo:[],editable:0,initWidth:50}},initialize:function($super,t){this.setOption(t),$super(t),this.datamodel.starInfo=this.datamodel.starInfo?this.datamodel.starInfo:new Array("谢谢您的评价");var e=this.datamodel.starInfo.length>1?this.datamodel.starInfo[this.datamodel.curNum-1]:this.datamodel.starInfo[0];this.showInfoHtml=this.datamodel.showInfo?'<div class="showInfo">'+e+"</div>":"",this.datamodel.initWidth=this.datamodel.curNum?this.datamodel.curNum/this.datamodel.count*100:0,this.template=_.template('<span class="cui-rate"><span class="cui-rate-r1"><%for(var i=0;i<count;i++){%><i data-index=<%=i%>></i><%}%></span><span class="cui-rate-r2" style="width:'+this.datamodel.initWidth+'%"><%for(var i=0;i<count;i++){%><i data-index=<%=i%>></i><%}%></span></span>'+this.showInfoHtml)(this.datamodel)},addEvent:function($super){$super();var t=this;this.on("onShow",function(){t.wrapper.find(".view").append(t.template),$(t.wrapper.selector+" i").bind("click",$.proxy(function(e){if(!t.datamodel.editable)return!1;var i=$(e.target).attr("data-index");$(t.wrapper).find(".cui-rate-r2").css("width",(parseInt(i)+1)/t.datamodel.count*100+"%");var o=t.datamodel.starInfo.length>1?i:0;t.datamodel.curNum=1*i+1,t.datamodel.showInfo&&$(".showInfo").html(t.datamodel.starInfo[o])},t))})},getCurNum:function(){return this.datamodel.curNum},setOption:function(t){for(var e in t)this[e]=t[e]}})}),define("gsImagesZoom",[],function(){function t(t,e){var i=t,s=e;return o.transform3d?"translate3d("+i+"px, "+s+"px, 0)":"translate("+i+"px, "+s+"px)"}function e(t,e){return o.touch?t.changedTouches[0][e]:t[e]}var i=window.document,o={transform3d:"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,touch:"ontouchstart"in window},s=function(){};return s.prototype={init:function(t){var e=this,o="";e.setConfig(t),e._destroy(),e.zoomClose.addEventListener("click",function(){e.hideImage()},!1),$(".event_image").off("click").on("click",function(t){t.stopPropagation(),o=$(t.currentTarget).data("originurl"),e.zoomMask.style.cssText="display:block",e.zoomImg.src=o,e.zoomImg.onload=function(){e.zoomImg.style.cssText="margin-top:-"+e.zoomImg.offsetHeight/2+"px",i.addEventListener("touchmove",e.eventStop,!1),e.imgBaseWidth=e.zoomImg.offsetWidth,e.imgBaseHeight=e.zoomImg.offsetHeight,e.addEventStart({wrapX:e.zoomMask.offsetWidth,wrapY:e.zoomMask.offsetHeight,mapX:e.zoomImg.width,mapY:e.zoomImg.height})}})},setConfig:function(t){var e=this,o=t&&t.mask?t.mask:".imgzoom_pack";e.imgList=t&&t.elem?i.querySelectorAll(t.elem+" img"):i.querySelectorAll("img"),e.zoomMask=i.querySelector(o),e.zoomImg=i.querySelector(o+" img"),e.zoomClose=i.querySelector(o+" .this_close"),e.buffMove=3,e.buffScale=2,e.finger=!1},addEventStart:function(t){var e=this,i=t||{};e.wrapX=i.wrapX||0,e.wrapY=i.wrapY||0,e.mapX=i.mapX||0,e.mapY=i.mapY||0,e.width=e.mapX-e.wrapX,e.height=e.mapY-e.wrapY,e.zoomImg.addEventListener("touchstart",function(t){e._touchstart(t)},!1),e.zoomImg.addEventListener("touchmove",function(t){e._touchmove(t)},!1),e.zoomImg.addEventListener("touchend",function(t){e._touchend(t)},!1)},_destroy:function(){this.distX=0,this.distY=0,this.newX=0,this.newY=0},_changeData:function(){this.mapX=this.zoomImg.offsetWidth,this.mapY=this.zoomImg.offsetHeight,this.width=this.mapX-this.wrapX,this.height=this.mapY-this.wrapY},_touchstart:function(t){var i=this;t.preventDefault();var o=t.targetTouches.length;i._changeData(),1==o?(i.basePageX=e(t,"pageX"),i.basePageY=e(t,"pageY"),i.finger=!1):(i.finger=!0,i.startFingerDist=i.getTouchDist(t).dist,i.startFingerX=i.getTouchDist(t).x,i.startFingerY=i.getTouchDist(t).y)},_touchmove:function(t){var e=this;t.preventDefault(),t.stopPropagation();var i=t.targetTouches.length;1!=i||e.finger||e._move(t),i>=2&&e._zoom(t)},_touchend:function(t){var e=this;e._changeData(),e.finger&&(e.distX=-e.imgNewX,e.distY=-e.imgNewY),e.distX>0?e.newX=0:e.distX<=0&&e.distX>=-e.width?(e.newX=e.distX,e.newY=e.distY):e.distX<-e.width&&(e.newX=-e.width),e.reset()},hideImage:function(){var t=this;t.zoomMask.style.cssText="display:none",t.zoomImg.src="",t.zoomImg.style.cssText="",t._destroy(),i.removeEventListener("touchmove",t.eventStop,!1)},_move:function(t){var i=this,o=e(t,"pageX"),s=e(t,"pageY");i.distX=o-i.basePageX+i.newX,i.distY=s-i.basePageY+i.newY,i.distX>0?i.moveX=Math.round(i.distX/i.buffMove):i.distX<=0&&i.distX>=-i.width?i.moveX=i.distX:i.distX<-i.width&&(i.moveX=-i.width+Math.round((i.distX+i.width)/i.buffMove)),i.movePos(),i.finger=!1},_zoom:function(t){var e=this,i=e.getTouchDist(t).dist,o=i/e.startFingerDist,s=Math.round(e.mapX*o);Math.round(e.mapY*o);e.imgNewX=Math.round(e.startFingerX*o-e.startFingerX-e.newX*o),e.imgNewY=Math.round((e.startFingerY*o-e.startFingerY)/2-e.newY*o),s>=e.imgBaseWidth?(e.zoomImg.style.width=s+"px",e.refresh(-e.imgNewX,-e.imgNewY,"0s","ease"),e.finger=!0):s<e.imgBaseWidth&&(e.zoomImg.style.width=e.imgBaseWidth+"px"),e.finger=!0},movePos:function(){var t=this;if(t.height<0)if(t.zoomImg.offsetWidth==t.imgBaseWidth)t.moveY=Math.round(t.distY/t.buffMove);else{var e=Math.round((t.zoomImg.offsetHeight-t.imgBaseHeight)/2);t.moveY=-e+Math.round((t.distY+e)/t.buffMove)}else{var i=Math.round((t.wrapY-t.imgBaseHeight)/2),o=t.zoomImg.offsetHeight-t.wrapY+Math.round(t.wrapY-t.imgBaseHeight)/2;t.distY>=-i?t.moveY=Math.round((t.distY+i)/t.buffMove)-i:t.distY<=-o?t.moveY=Math.round((t.distY+o)/t.buffMove)-o:t.moveY=t.distY}t.refresh(t.moveX,t.moveY,"0s","ease")},reset:function(){var t=this;if(t.height<0)t.newY=-Math.round(t.zoomImg.offsetHeight-t.imgBaseHeight)/2;else{var e=Math.round((t.wrapY-t.imgBaseHeight)/2),i=t.zoomImg.offsetHeight-t.wrapY+Math.round(t.wrapY-t.imgBaseHeight)/2;t.distY>=-e?t.newY=-e:t.distY<=-i?t.newY=-i:t.newY=t.distY}t.refresh(t.newX,t.newY,".2s","ease-in-out")},refresh:function(e,i,o,s){this.zoomImg.style.webkitTransitionProperty="-webkit-transform",this.zoomImg.style.webkitTransitionDuration=o,this.zoomImg.style.webkitTransitionTimingFunction=s,this.zoomImg.style.webkitTransform=t(e,i)},getTouchDist:function(t){var e=0,o=0,s=0,n=0,a=0,r=0;if(e=t.touches[0].pageX,s=t.touches[1].pageX,o=t.touches[0].pageY-i.body.scrollTop,n=t.touches[1].pageY-i.body.scrollTop,e&&s)return a=e<=s?(s-e)/2+e:(e-s)/2+s,r=o<=n?(n-o)/2+o:(o-n)/2+n,{dist:Math.round(Math.sqrt(Math.pow(e-s,2)+Math.pow(o-n,2))),x:Math.round(a),y:Math.round(r)}},eventStop:function(t){t.preventDefault(),t.stopPropagation()}},s}),define("gsShowImages",[],function(){var t=window.document,e={transform3d:"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,touch:"ontouchstart"in window};return{finger:!1,init:function(t){var e=this;e.setConfig(t),e.len=e.imgs.length,e.$wrap=$(".appue_scale"),e.$that=$(".appue_scale .this_img"),e.bodyWidth=$("body").width(),e.bodyHeight=$("body").height(),e.imagesWH=new Array(e.len),e.newX=0,e.newY=0,e.initImg(),e.addEvent(),e.setTitle(),e.setDetail()},setConfig:function(t){var e,i=this,o={imgsUrl:"",detail:"",isDetail:!1,buffMove:3,currentImg:0,isScale:!1,maxScale:2,minDist:120};for(e in t)o[e]=t[e];i.imgs=o.imgsUrl,i.detail=o.detail,i.isDetail=o.isDetail,i.current=o.currentImg,i.buffScale=o.maxScale,i.isScale=o.isScale,i.buffMove=o.buffMove,i.minDist=o.minDist},initImg:function(){for(var t=this,e="",i=0;i<t.len;i++)e=e+'<li style="width:'+t.bodyWidth+"px;height:"+t.bodyHeight+'px;"></li>';t.$that.append(e),t.$wrap.css({display:"block"}),t.appendImage(),t.moveSlide({timer:"0"})},addEvent:function(){for(var e=this,i=t.querySelectorAll(".appue_scale li"),o=0,s=i.length;o<s;o++)i[o].addEventListener("touchstart",function(t){e._touchstart(t)},!1),i[o].addEventListener("touchmove",function(t){e._touchmove(t)},!1),i[o].addEventListener("touchend",function(t){e._touchend(t)},!1)},_changeData:function(t){var e=this;e.mapX=$(t.target).width(),e.mapY=$(t.target).height(),e.width=e.mapX-e.bodyWidth,e.height=e.mapY-e.bodyHeight},setImagesInfo:function(t){var e=this,i=e.getTarget(t);e.imagesWH[e.current]||(e.imagesWH[e.current]={},e.imagesWH[e.current].w=i.width(),e.imagesWH[e.current].h=i.height())},_touchstart:function(t){var e=this;if("IMG"===t.target.nodeName){t.preventDefault(),e.setImagesInfo(t);var i=t.targetTouches.length;e._changeData(t),1==i?(e.finger=!1,e.basePageX=e.getPage(t,"pageX"),e.basePageY=e.getPage(t,"pageY")):e.isScale&&(e.finger=!0,e.startFingerDist=e.getTouchDist(t).dist,e.startFingerX=e.getTouchDist(t).x,e.startFingerY=e.getTouchDist(t).y)}},_touchmove:function(t){var e=this;if("IMG"===t.target.nodeName)if(t.preventDefault(),t.stopPropagation(),e.isScale){var i=t.targetTouches.length;1!=i||e.finger||(e.finger=!1,e._move(t)),i>=2&&(e.finger=!0,e._zoom(t))}else e.finger=!1,e._move(t)},_touchend:function(t){var e=this;"IMG"===t.target.nodeName&&(e.finger?e.resetZoom(t):e.resetMove(t))},_move:function(t){var e=this,i=e.imagesWH[e.current].w,o=(e.imagesWH[e.current].h,e.getPage(t,"pageX")),s=e.getPage(t,"pageY");t.preventDefault(),t.stopPropagation(),e.distX=o-e.basePageX+e.newX,e.distY=s-e.basePageY+e.newY;var n=e.getTarget(t).width(),a=n-i;e.distX>=0?e.moveX=Math.round(e.distX/e.buffMove):n==i?e.moveX=Math.round(e.distX/e.buffMove):e.distX<=-a?e.moveX=Math.round((e.distX+a)/e.buffMove-a):e.moveX=e.distX,e.moveY=0,e.refresh({e:t,x:e.moveX,y:e.moveY,timer:"0s",type:"ease"})},_zoom:function(t){var e=this,i="",o=e.imagesWH[e.current].w,s=e.imagesWH[e.current].h;t.preventDefault(),t.stopPropagation();var n=e.getTouchDist(t).dist,a=n/e.startFingerDist,r=Math.round(e.mapX*a),c=Math.round(e.mapY*a),l=e.getTarget(t);r<=o*e.buffScale&&(r>=o&&c<=e.bodyHeight?(e.imgNewX=Math.round(e.startFingerX*a-e.startFingerX+-e.newX*a),e.imgNewY=0,i=r):c>s?(e.imgNewX=Math.round(e.startFingerX*a-e.startFingerX+-e.newX*a),e.imgNewY=Math.round((c-e.bodyHeight)/2),i=r):r<o&&(e.imgNewX=Math.round(e.startFingerX*a-e.startFingerX+-e.newX*a),e.imgNewY=Math.round((c-e.bodyHeight)/2),i=o),l.css({width:i+"px","max-width":"none","max-height":"none"}),e.refresh({e:t,x:-e.imgNewX,y:-e.imgNewY,timer:0,type:"ease"}))},resetMove:function(t){function e(e){s.newX=e,s.refresh({e:t,x:s.newX,y:0,timer:".5s",type:"ease"})}function i(){s.reset(),s.current--,s.moveSlide({timer:".5s"}),s.resetImage({e:t,z:s.current+1}),s.setTitle()}function o(){s.reset(),s.current++,s.moveSlide({timer:".5s"}),s.resetImage({e:t,z:s.current-1}),s.setTitle()}var s=this,n=s.imagesWH[s.current].w,a=(s.imagesWH[s.current].h,s.getTarget(t).width()),r=a-n;s.distX||(s.distX=0),0==s.current?s.distX>=0?e(0):1==s.len?e(-r):s.distX<=-(s.minDist+r)?o():e(s.distX<=-r&&s.distX>-(s.minDist+r)?-r:s.distX):s.current==s.len-1?s.distX>=0?s.distX<s.minDist?e(0):i():e(s.distX<=-r?-r:s.distX):s.distX>=0?s.distX<s.minDist?e(0):i():s.distX<=-(s.minDist+r)?o():e(s.distX<=-r&&s.distX>-(s.minDist+r)?-r:s.distX),s.newY=0},resetZoom:function(t){var e=this,i=e.imagesWH[e.current].w,o=(e.imagesWH[e.current].h,e.getTarget(t).width()),s=o-i;e.distX=-e.imgNewX,e.distY=-e.imgNewY,e.distX>0?e.newX=0:e.distX+s<0?e.newX=e.bodyWidth-o:e.newX=e.distX,e.newY=0,e.refresh({e:t,x:e.newX,y:e.newY,timer:".5s",type:"ease"})},reset:function(){var t=this;t.newX=0,t.newY=0,t.distX=0,t.distY=0},refresh:function(t){var e=this;e.getTarget(t.e).css({"-webkit-transition":"-webkit-transform "+t.timer+" "+t.type,"-webkit-transform":e.getTranslate(t.x,t.y)})},appendImage:function(){var t=this,e=t.$wrap.find("li").eq(t.current),i=e.html();i||e.html('<div class="this_loading"></div>');var o=new Image;o.onload=function(){var o="";o=t.detail&&t.isDetail?'<img src="'+t.imgs[t.current]+'" /><div class="this_text">'+t.detail[t.current]+"</div>":'<img src="'+t.imgs[t.current]+'" />',i&&-1!=i.search(/img/)||e.html(o)},o.src=t.imgs[t.current]},moveSlide:function(t){var e=this;e.$that.css({"-webkit-transition":"-webkit-transform "+t.timer+" ease","-webkit-transform":e.getTranslate(-e.current*e.bodyWidth,0)})},resetImage:function(t){var e=this;e.$that.on("webkitTransitionEnd",function(t){$(".appue_scale li img").attr("style",""),e.appendImage()})},setTitle:function(){var t=this,e=parseInt(t.current,0)+1;$(".appue_scale .this_title").html(e+"/"+t.len)},setDetail:function(){var t=this;if(!t.isDetail&&t.detail&&t.detail.length){var e="";t.detail[0].from&&(e+="<address>"+t.detail[0].from+"</address>"),t.detail[0].text&&(e+='<div id="textScroll"><p>'+t.detail[0].text+"</p></div>"),t.detail[0].time&&(e+="<article>"+t.detail[0].time+"</article>"),$(".appue_scale .this_intro").html(e)}},getTouchDist:function(e){var i=0,o=0,s=0,n=0,a=0,r=0;if(i=e.touches[0].pageX,s=e.touches[1].pageX,o=e.touches[0].pageY-t.body.scrollTop,n=e.touches[1].pageY-t.body.scrollTop,i&&s)return a=i<=s?(s-i)/2+i:(i-s)/2+s,r=o<=n?(n-o)/2+o:(o-n)/2+n,{dist:Math.round(Math.sqrt(Math.pow(i-s,2)+Math.pow(o-n,2))),x:Math.round(a),y:Math.round(r)}},getTarget:function(t){return"IMG"==t.target.nodeName?$(t.target):$(t.target).find("img")},eventStop:function(t){t.preventDefault(),t.stopPropagation()},getTranslate:function(t,i){var o=t,s=i;return e.transform3d?"translate3d("+o+"px, "+s+"px, 0)":"translate("+o+"px, "+s+"px)"},getPage:function(t,i){return e.touch?t.changedTouches[0][i]:t[i]}}}),define("gsUserPhotoModel",["cModel","cCoreInherit","gsShowTime"],function(t,e,i){var o=o||{};return o.GetMyPhotoNextPage=new e.Class(t,{__propertys__:function(){this.url="/soa2/10318/json/GetUserAlbum",this.param={PageInfo:{PageSize:10,PageIndex:1},UserId:Lizard.P("userId")||"",Width:200,Height:200},this.dataformat=this.parse},initialize:function($super,t){$super(t)},parse:function(t){return _.each(t.Result,function(t,e){t.FirstUploadTime=i.getDateTime({times:t.FirstUploadTime,sign:".",type:!1}),t.LastUploadTime=i.getDateTime({times:t.LastUploadTime,sign:".",type:!1})}),t}}),o.GetPoiPhotoNextPage=new e.Class(t,{__propertys__:function(){this.url="/soa2/10318/json/GetUserPoiAlbumList",this.param={PageInfo:{PageSize:10,PageIndex:1},UserId:Lizard.P("userId")||"",DistrictId:Lizard.P("districtId"),ImageSize:["C_200_200","C_640_10000"],TakeNum:8},this.dataformat=this.parse},initialize:function($super,t){$super(t)},parse:function(t){return _.each(t.Result,function(t,e){11==t.BizType?t.BizTypeClass="icon_poi_type_attraction":12==t.BizType?t.BizTypeClass="icon_poi_type_gourmet":13==t.BizType?t.BizTypeClass="icon_poi_type_shop":18==t.BizType&&(t.BizTypeClass="icon_poi_type_entertainment"),_.each(t.ImageList,function(t,e){t.UploadTime=commonUtil.getDateTime({times:t.UploadTime,sign:"-",type:!1}),3==t.PublishStatus&&(t.PublishStatusText="审核中")})}),t}}),o.GetPoiListPhotoNextPage=new e.Class(t,{__propertys__:function(){this.url="/soa2/10318/json/GetUserPoiAlbumDetail",this.param={PageInfo:{PageSize:20,PageIndex:1},UserId:Lizard.P("userId")||"",PoiId:Lizard.P("poiId")||"0",BizId:Lizard.P("businessId"),BizType:Lizard.P("businessType"),ImageSize:["C_300_225","C_640_10000"]},this.dataformat=this.parse},initialize:function($super,t){$super(t)},parse:function(t){return _.each(t.Result.ImageList,function(t,e){t.UploadTime=commonUtil.getDateTime({times:t.UploadTime,sign:"-",type:!1}),3==t.PublishStatus&&(t.PublishStatusText="审核中")}),t}}),o.DetelMyPhotoImg=new e.Class(t,{__propertys__:function(){this.url="/soa2/10318/json/DelUserImage",this.param={ImageId:""}},initialize:function($super,t){$super(t)}}),o}),define("gsUserShowImages",["libs","cPageView","UIToast","gsUserPhotoModel","gsRouterRedirect"],function(t,e,i,o,s){var n=window.document,a={transform3d:"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,touch:"ontouchstart"in window};return{finger:!1,toasts:new i,init:function(t){var e=this;e.setConfig(t),e.len=e.imgs.length,e.$wrap=$(".appue_scale"),e.$that=$(".appue_scale .this_img"),e.$delmask=$(".js_del_mask"),e.$delbox=$(".js_del_box"),e.bodyWidth=$("body").width(),e.bodyHeight=$("body").height(),e.imagesWH=new Array(e.len),e.newX=0,e.newY=0,e.initImg(),e.addEvent(),e.imageMsgHidden(),e.setTitle(),e.setDetail(e.current),e.showDelTip(),e.cancelDel(),e.deteleImg(),e.toClose()},setConfig:function(t){var e,i=this,o={imgsUrl:"",detail:"",isDetail:!1,buffMove:3,currentImg:0,minDist:120,titles:"我的相册"};for(e in t)o[e]=t[e];i.imgs=o.imgsUrl,i.detail=o.detail,i.isDetail=o.isDetail,i.current=o.currentImg,i.buffMove=o.buffMove,i.minDist=o.minDist,i.titles=o.titles},initImg:function(){for(var t=this,e="",i=0;i<t.len;i++)e=e+'<li style="width:'+t.bodyWidth+"px;height:"+t.bodyHeight+'px;"></li>';t.$that.append(e),t.$wrap.css({display:"block"}),t.appendImage(),t.moveSlide({timer:"0"})},addEvent:function(){for(var t=this,e=n.querySelectorAll(".appue_scale li"),i=0,o=e.length;i<o;i++)e[i].addEventListener("touchstart",function(e){t._touchstart(e)},!1),e[i].addEventListener("touchmove",function(e){t._touchmove(e)},!1),e[i].addEventListener("touchend",function(e){t._touchend(e)},!1)},setImagesInfo:function(t){var e=this,i=e.getTarget(t);e.imagesWH[e.current]||(e.imagesWH[e.current]={},e.imagesWH[e.current].w=i.width(),e.imagesWH[e.current].h=i.height())},_touchstart:function(t){var e=this;t.preventDefault(),e.setImagesInfo(t),1==t.targetTouches.length&&(e.finger=!1,e.basePageX=e.getPage(t,"pageX"),e.basePageY=e.getPage(t,"pageY"))},_touchmove:function(t){var e=this;t.preventDefault(),t.stopPropagation(),e.finger=!1,e._move(t)},_touchend:function(t){var e=this;e.finger||e.resetMove(t)},_move:function(t){var e=this,i=e.imagesWH[e.current].w,o=(e.imagesWH[e.current].h,e.getPage(t,"pageX")),s=e.getPage(t,"pageY");t.preventDefault(),t.stopPropagation(),e.distX=o-e.basePageX+e.newX,e.distY=s-e.basePageY+e.newY;var n=e.getTarget(t).width(),a=n-i;e.distX>=0?e.moveX=Math.round(e.distX/e.buffMove):n==i?e.moveX=Math.round(e.distX/e.buffMove):e.distX<=-a?e.moveX=Math.round((e.distX+a)/e.buffMove-a):e.moveX=e.distX,e.moveY=0,e.refresh({e:t,x:e.moveX,y:e.moveY,timer:"0s",type:"ease"})},resetMove:function(t){function e(e){s.newX=e,s.refresh({e:t,x:s.newX,y:0,timer:".5s",type:"ease"})}function i(){s.reset(),s.current--,s.moveSlide({timer:".5s"}),s.resetImage({e:t,z:s.current+1}),s.setTitle(),s.setDetail(s.current)}function o(){s.reset(),s.current++,s.moveSlide({timer:".5s"}),s.resetImage({e:t,z:s.current-1}),s.setTitle(),s.setDetail(s.current)}var s=this,n=s.imagesWH[s.current].w,a=(s.imagesWH[s.current].h,s.getTarget(t).width()),r=a-n;s.distX||(s.distX=0),0==s.current?s.distX>0?(s.toastsfn("第一张了！",.5),e(0)):1==s.len?(s.toastsfn("最后一张了！",.5),
e(-r)):s.distX<=-(s.minDist+r)?o():e(s.distX<=-r&&s.distX>-(s.minDist+r)?-r:s.distX):s.current==s.len-1?s.distX>=0?s.distX<s.minDist?e(0):i():s.distX<-r?(s.toastsfn("最后一张了！",.5),e(-r)):e(s.distX):s.distX>=0?s.distX<s.minDist?e(0):i():s.distX<=-(s.minDist+r)?o():e(s.distX<=-r&&s.distX>-(s.minDist+r)?-r:s.distX),s.newY=0},reset:function(){var t=this;t.newX=0,t.newY=0,t.distX=0,t.distY=0},refresh:function(t){var e=this;e.getTarget(t.e).css({"-webkit-transition":"-webkit-transform "+t.timer+" "+t.type,"-webkit-transform":e.getTranslate(t.x,t.y)})},appendImage:function(){var t=this,e=t.$wrap.find("li").eq(t.current),i=e.html();i||e.html('<div class="this_loading"></div>');var o=new Image;o.onload=function(){var o="";e=t.$wrap.find("li").eq(t.current),i=e.html(),o='<img src="'+t.imgs[t.current]+'" />',i&&-1!=i.search(/img/)||e.html(o)},o.src=t.imgs[t.current]},moveSlide:function(t){var e=this;e.$that.css({"-webkit-transition":"-webkit-transform "+t.timer+" ease","-webkit-transform":e.getTranslate(-e.current*e.bodyWidth,0)})},resetImage:function(t){var e=this;e.$that.on("webkitTransitionEnd",function(t){$(".appue_scale li img").attr("style",""),e.appendImage()})},setTitle:function(){var t=this;parseInt(t.current,0);$(".appue_scale .this_title").html(t.titles)},setDetail:function(t){var e=this;if(!e.isDetail&&e.detail){var i="<article>"+e.detail[t].time+"</article><p>由 "+e.detail[t].nickName+" 上传</p>";e.detail[t].text,$(".appue_scale .this_intro").html(i)}},showDelTip:function(){var t=this;$(".js_del_left").off("click").on("click",function(e){t.$delmask.addClass("del_mask_show"),t.$delbox.addClass("del_box_up")})},hideDelTip:function(){this.$delbox.removeClass("del_box_up"),this.$delmask.removeClass("del_mask_show")},deteleImg:function(t){var e=this;$(".js_del");$(".js_del").off("click").on("click",function(t){var i=e.current;if(localStorage.setItem("isdelete","isdelete"),e.hideDelTip(),e.delCallback(e.detail[i].imgid,e.len,i),e.arrayRemove(e.imgs,e.current),e.arrayRemove(e.detail,e.current),e.len>1){--e.len,e.current>e.len-1&&(--e.current,e.appendImage(),e.$that.css({"-webkit-transition":"-webkit-transform 0ms ease","-webkit-transform":e.getTranslate(-e.len*e.bodyWidth+320,0)}),1==e.len&&(e.appendImage(),e.$that.css({"-webkit-transition":"-webkit-transform 0ms ease","-webkit-transform":e.getTranslate(0,0)})));var o={details:e.detail,imgs:e.imgs,indexs:e.current,titleName:e.titles};localStorage.setItem("localobj",JSON.stringify(o)),e.setDetail(e.current)}})},cancelDel:function(){var t=this;$(".js_cancel,.js_del_mask").off("click").on("click",function(e){t.hideDelTip()})},toClose:function(t){this.$wrap.off("click").on("click",".js_close",function(t){s.toBack()})},delCallback:function(t,e,n){var a=this,r=(new i,o.DetelMyPhotoImg.getInstance());r.setParam({ImageId:t}),r.excute(function(t){if(t.Result)if(a.toastsfn("删除照片成功！",1),e<2)s.toBack();else{var i=$(".this_img").find("li").eq(n);i.remove(),a.appendImage()}else a.toastsfn("删除照片失败！",2)},function(){})},toastsfn:function(t,e){Lizard.showToast(t),$(".cui-toast").css("z-index","999999999")},getTarget:function(t){return"IMG"==t.target.nodeName?$(t.target):$(t.target).find("img")},imageMsgHidden:function(){var t=this,e=t.$that.siblings(".js_ishide");$("body").off("click").on("click",".js_this_img",function(t){$(t.target).is("img")||(e.hasClass("js_ishide_hide")?e.removeClass("js_ishide_hide"):e.addClass("js_ishide_hide"))})},eventStop:function(t){t.preventDefault(),t.stopPropagation()},getTranslate:function(t,e){var i=t,o=e;return a.transform3d?"translate3d("+i+"px, "+o+"px, 0)":"translate("+i+"px, "+o+"px)"},getPage:function(t,e){return a.touch?t.changedTouches[0][e]:t[e]},arrayRemove:function(t,e,i){Array.prototype.remove=function(t){for(var e=0;e<this.length;e++){var i=this[e];if(isNaN(t)||(i=e),i==t){for(var o=e;o<this.length;o++)this[o]=this[o+1];this.length=this.length-1}}},t.remove(e)}}}),define("gsCommonAddSchedule",["UICalendarCommon","gsRouterRedirect","gsCommonModel","cMemberService","gsCommon"],function(t,e,i,o,s){var n=i.addSchedule.getInstance(),a=i.addPlaneHotelSchedule.getInstance(),r=i.addTravelPlan.getInstance(),c=0;return{init:function(t){var e=this;o.isLogin()?(e._showCalendar(),e._setDeploy(),e._addEvent(t),e.params=t,e._nodate()):o.memberLogin({param:"from="+window.encodeURIComponent(window.location.href)+"&backurl="+window.encodeURIComponent(window.location.href),callback:function(){o.isLogin()&&(e._showCalendar(),e._setDeploy(),e._addEvent(t),e.params=t,e._nodate())}})},formatTime:function(t,e){var i=new Date(e),o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in o)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[s]:("00"+o[s]).substr((""+o[s]).length)));return t},_setDeploy:function(){$(".js_poi_detailScroll").addClass("poi_detailScroll"),$(".js_schedule").show(),$(".js_schedule").animate({opacity:1},300,"ease-in"),setTimeout(function(){$(".js_schedule .this_wrapper").addClass("this_show")},5),c=$("body").scrollTop()},_addEvent:function(t){var i=this,o=$(".js_schedule_cancel"),s=$(".js_schedule_submit");$(".js_schedule_goto");o.off().on("click",function(){i._hideCalendar()}),s.off().on("click",function(){if(!i.calendar.selectDate)return void i._showMsg("请选择日期！");i._updateData(t)}),$(".js_schedule").undelegate().delegate(".js_schedule_goto","click",function(t){e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/journeys/travelplan/list.html?from="+window.location.href,"destination/journey/index.html#travelplan/list.html"],targetModel:4})})},_showCalendar:function(){var e=this;e.calendar=new t({datamodel:{endTime:null,displayMonthNum:13},wrapper:$(".js_schedule_calendar"),onItemClick:function(t,i,o){$(".js_calendar_item").removeClass("cui_cld_daycrt"),$(i).addClass("cui_cld_daycrt"),e.calendar.selectDate=t},onShow:function(){$(".cm-calendar-bd").css("height","307px")},onHide:function(){}}),e.calendar.show()},_hideCalendar:function(){var t=this;document.body.scrollTop=c,$(".js_poi_detailScroll").removeClass("poi_detailScroll"),$(".js_schedule .this_wrapper").removeClass("this_show"),$(".js_schedule").animate({opacity:0},300,"ease-out"),setTimeout(function(){$(".js_schedule").hide(),t.calendar.hide()},300)},_updateData:function(t){var e=this;if(n.setParam({poiId:t.poiId,itemId:t.businessId,itemName:t.bussinessName,subType:t.subType,type:9,source:t.source||2,ddate:e.formatTime("yyyy-MM-dd hh:mm:ss",e.calendar.selectDate)}),n.excute(function(i){if("Success"==i.ResponseStatus.Ack&&0==i.result){var o=e.calendar.selectDate||new o;Lizard.P("isfromplanehotel")||e._ShowTip(o.getMonth()+1+"月"+o.getDate()+"日",t.poiId),$(".menu-inApp .js_add_travel_plan_shop").addClass("added").find("a").text("已加入行程");var n="";9==t.subType?n="poi":11==t.subType?n="shopping":12==t.subType&&(n="food"),s.cTrackLog(100844,{actioncode:"0_schedule_add_sucess",actiontype:"click",value:n}),$(".menu-bottom-new .add-date .bar-icon").removeClass("icon-add-date").removeClass("icon-add-dateing").addClass("icon-add-dateing"),$(".menu-bottom-new .add-date .bar-text").text("已加入行程")}else Lizard.P("isfromplanehotel")||e._showMsg("添加行程失败！");e._hideCalendar()}),Lizard.P("isfromplanehotel")&&Lizard.P("sid")){var i={9:"SIGHT",10:"",11:"SHOP",12:"RESTAURANT"};a.setParam({ChannelCode:0,PlatfromId:1,BuType:"gs",Version:"71400",Method:"add",ShoppingId:Lizard.P("sid"),QueryDatas:[{ResourceType:"travelPlan",Resource:JSON.stringify({from:"gs",startDate:e.formatTime("yyyy-MM-dd",e.calendar.selectDate),travelPlan:{poiId:t.poiId,poiType:i[t.subType],name:t.bussinessName,businessId:t.businessId,cityId:t.cityId,cityName:t.cityName,countryName:"",openTime:"",imageUrl:"",GGCoord:{Lat:"",Lon:""},GDCoord:{Lat:"",Lon:""},BDCoord:{Lat:"",Lon:""}}})}]}),a.excute(function(t){"Success"==t.ResponseStatus.Ack?e._showMsg("添加行程成功！"):e._showMsg("添加行程失败！")})}},_showMsg:function(t){Lizard.showToast({datamodel:{content:t},needMask:!1})},_ShowTip:function(t,i){0==$(".js_add_schedule_success_toast").length&&$(".js_schedule_success").after('<div class="journey_toast js_add_schedule_success_toast" style="display:none"><div class="journey_inner"><div class="tips_text"><p>已添加到行程</p><span class="js_schedule_time"></span></div><p class="find_arrow js_go_to_schedule" id="c_ticket_add_check">去查看</p></div></div>');var o=$(".js_add_schedule_success_toast");o.show(),o.find(".js_schedule_time").html(t),o.undelegate().delegate(".js_go_to_schedule","click",function(t){(Lizard.isInCtripApp||Lizard.isHybrid)&&e.toJump({url:["ctrip://wireless/schedule?c3=100&c4="+i,"ctrip://wireless/schedule?c3=100&c4="+i],targetModel:1})}),setTimeout(function(){o.hide()},2300),s.cTrackLog(100663,{actioncode:"poi_plus_schedule_success"})},_ShowTip73:function(t){var e=this;$(".js_add_travel_plan_background").addClass("opacity-6").show(),e.forbidBodyScroll(),$(".js_add_travel_plan_suc").click(function(t){t.stopImmediatePropagation(),$(".js_add_travel_plan_background").hide(),e.allowBodyScroll(),$(".js_add_travel_plan_suc").hide(),e.gotoTravelPage(),$(".js_image_fly").show(),window.setTimeout(function(){$(".js_image_fly").hide()},2e3)}),$(".cui-white-layer-padding").undelegate().delegate(".js_add_travel_plan_suc_close","click",function(t){return $(".js_add_travel_plan_background").hide(),e.allowBodyScroll(),$(".js_add_travel_plan_suc").hide(),$(".js_image_fly").show(),window.setTimeout(function(){$(".js_image_fly").hide()},2e3),t.stopImmediatePropagation(),!1}),$(".js_add_travel_plan_suc").children().find(".cui-layer-content").find("h2").html("已添加到旅行计划"),$(".js_add_travel_plan_suc").children().find(".cui-layer-content").find("h4").html('标题为"'+e.params.bussinessName+'"去查看'),$(".js_add_travel_plan_suc").show(),s.cTrackLog(100664,{actioncode:"poi_plus_plan_success"})},gotoTravelPage:function(t){e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/journeys/travelplan/list.html?from="+window.location.href,"destination/journey/index.html#travelplan/list.html"],targetModel:4})},_nodate:function(){var t=this;$(".js_schedule").undelegate().delegate(".js_schedule_no_date","click",function(e){r.setParam({Guid:(new t.getGUID).newGUID(),PoiId:t.params.poiId,TravelPlanId:0,playDate:null}),r.excute(function(e){e&&e.ResponseStatus&&"Success"==e.ResponseStatus.Ack?t._ShowTip73("标题为"+t.params.bussinessName):Lizard.showToast("加入旅行计划失败"),t._hideCalendar()}),t._hideCalendar()})},forbidBodyScroll:function(){$(".js_add_travel_plan_background").on("touchmove",function(t){return t.stopImmediatePropagation(),t.preventDefault,!1})},allowBodyScroll:function(){$(".js_add_travel_plan_background").off("touchmove")},getGUID:function t(){this.date=new Date,"function"!=typeof this.newGUID&&(t.prototype.newGUID=function(){this.date=new Date;var t="";sexadecimalDate=this.hexadecimal(this.getGUIDDate(),16),sexadecimalTime=this.hexadecimal(this.getGUIDTime(),16);for(var e=0;e<9;e++)t+=Math.floor(16*Math.random()).toString(16);for(t+=sexadecimalDate,t+=sexadecimalTime;t.length<32;)t+=Math.floor(16*Math.random()).toString(16);return this.formatGUID(t)},t.prototype.getGUIDDate=function(){return this.date.getFullYear()+this.addZero(this.date.getMonth()+1)+this.addZero(this.date.getDay())},t.prototype.getGUIDTime=function(){return this.addZero(this.date.getHours())+this.addZero(this.date.getMinutes())+this.addZero(this.date.getSeconds())+this.addZero(parseInt(this.date.getMilliseconds()/10))},t.prototype.addZero=function(t){return"NaN"!=Number(t).toString()&&t>=0&&t<10?"0"+Math.floor(t):t.toString()},t.prototype.hexadecimal=function(t,e,i){return void 0!=i?parseInt(t.toString(),i).toString(e):parseInt(t.toString()).toString(e)},t.prototype.formatGUID=function(t){return t.slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20)})}}}),define("gsCommonAddTravelPlan",["cHybridShell","gsAppAgent","gsBusinessJob","gsRouterRedirect","cMemberService","gsCommonModel","gsCommonAddSchedule","gsCommon"],function(t,e,i,o,s,n,a,r){var c=n.addTravelPlan.getInstance(),l=n.getTravelPlanList.getInstance();return{param:{},hasTravelPlan:!1,init:function(t,e){var i=this;i.param=t||{},i.scrollDom=e,$("body").delegate(".js_add_travel_plan","click",function(t){if(a.init({subType:i.param.subType,poiId:i.param.poiId,businessId:i.param.businessId,bussinessName:i.param.bussinessName}),"true"==Lizard.P("isfromplanehotel")){var e=Lizard.P("startDate"),o=e.split("-"),s={year:o[0],month:o[1],day:o[2]},n=new Date(s.year,s.month,s.day)-a.calendar.datamodel.startTime,r=new Date(n).getMonth(),c=$(".cm-calendar-bd ul").slice(0,r),l=0;$(c).forEach(function(t){l+=$(t).height()+50}),$(".cm-calendar-bd").scrollTop(l)}}),$("body").delegate(".js_add_travel_plan_background, .js_add_travel_plan_btns","click",function(t){$(".js_add_travel_plan_btns").hide(),$(".js_add_travel_plan_suc").hide(),$(".js_add_travel_plan_background").hide(),$(".js_add_travel_plan_list").hide(),i.allowBodyScroll()}),$("body").delegate(".js_add_travel_plan_list li","click",function(t){$(".js_add_travel_plan_list li").removeClass("current"),$(this).addClass("current")}),$("body").delegate(".js_add_travel_plan_suc_close","click",function(t){return $(".js_add_travel_plan_background").hide(),i.allowBodyScroll(),$(".js_add_travel_plan_suc").hide(),t.stopImmediatePropagation(),!1}),$("body").delegate(".js_add_travel_plan_suc","click",function(t){var e=$(this).data("travelplanid");$(".js_add_travel_plan_background").hide(),i.allowBodyScroll(),$(".js_add_travel_plan_suc").hide(),i.gotoTravelPage(e),$(".js_image_fly").show(),window.setTimeout(function(){$(".js_image_fly").hide()},2e3)}),$("body").delegate(".js_add_travel_plan_cancle","click",function(t){$(".js_add_travel_plan_list").hide(),$(".js_add_travel_plan_background").hide(),i.allowBodyScroll()}),$("body").delegate(".js_add_travel_plan_submit","click",function(t){$(".js_add_travel_plan_list").hide(),$(".js_add_travel_plan_background").hide(),i.allowBodyScroll();var e=$(".js_add_travel_plan_list li.current").data("planid"),o=$(".js_add_travel_plan_list li.current").html(),s=$(".js_add_travel_plan_list li.current").data("jumptoschedule");i.addTravelPlan(e,o,s)})},clickEvent:function(){var t=this;s.isLogin()?t.getTravelPlanList():s.memberLogin({param:"from="+window.encodeURIComponent(window.location.href)+"&backurl="+window.encodeURIComponent(window.location.href),callback:function(){s.isLogin()&&t.getTravelPlanList()}})},getTravelPlanList:function(){var t=this;l.setParam({Guid:(new t.getGUID).newGUID()}),l.excute(function(e){var i='<li data-index="0" data-planid="0" class="js_new_plan">新建</li>',o="";if(e&&e.Results&&e.Results.length>0){for(var s=0;s<e.Results.length;s++)o=0==s?"current":"",i+='<li class="'+o+'" data-index="'+(s+1)+'" data-planid="'+e.Results[s].TravelPlanId+'" data-jumptoschedule="'+e.Results[s].JumpToSchedule+'">'+e.Results[s].Title.substring(0,30)+"</li>";$(".js_add_travel_plan_list ul").html(i),$(".js_add_travel_plan_background").addClass("opacity-6").show(),$(".js_add_travel_plan_list").show(),t.forbidBodyScroll()}else a.init({subType:t.param.subType,poiId:t.param.poiId,businessId:t.param.businessId,bussinessName:t.param.bussinessName});$("body").delegate(".js_add_travel_plan_list .js_new_plan","click",function(e){$(".js_add_travel_plan_list").hide(),$(".js_add_travel_plan_background").hide(),a.init({subType:t.param.subType,poiId:t.param.poiId,businessId:t.param.businessId,bussinessName:t.param.bussinessName})})})},addTravelPlan:function(t,e,i){var o=this;0==t?a.init({subType:o.param.subType,poiId:o.param.poiId,businessId:o.param.businessId,bussinessName:o.param.bussinessName}):(c.setParam({Guid:(new o.getGUID).newGUID(),PoiId:o.param.poiId,TravelPlanId:t}),c.excute(function(t){t&&t.ResponseStatus&&"Success"==t.ResponseStatus.Ack?o.showAddSucPop(t.TravelPlanId,e,i):Lizard.showToast("加入旅行计划失败")}))},showAddSucPop:function(t,e,i){var o=this;i?o._ShowTip("可在APP首页底部行程查看"):($(".js_add_travel_plan_background").addClass("opacity-6").show(),o.forbidBodyScroll(),$(".js_add_travel_plan_suc").data("travelplanid",t),$(".js_add_travel_plan_suc").children().find(".cui-layer-content").find("h2").html("已添加到旅行计划"),$(".js_add_travel_plan_suc").children().find(".cui-layer-content").find("h4").html('标题为"'+e+'"去查看'),$(".js_add_travel_plan_suc").show(),r.cTrackLog(100664,{actioncode:"poi_plus_plan_success"}))},_ShowTip:function(t){$(".js_schedule_success").children().addClass("rlink_msg"),$(".js_schedule_success .js_schedule_time").text(t),$(".js_schedule_success").children().children().find("dt").html("已添加到行程"),$(".js_schedule_goto").hide(),$(".js_schedule_success").show(),setTimeout(function(){$(".js_schedule_success").hide(),$(".js_schedule_goto").css("display","block")},2300),r.cTrackLog(100663,{actioncode:"poi_plus_schedule_success"})},isShowTipPop:function(){var t=this;try{i.doBusinessJob({businessCode:801001,data:{type:1,key:"travelFirstAccessFlag"},callback:function(e){if(e&&e.param&&e.param.code&&801001==e.param.code&&e.param.sequenceId)if(e.param&&e.param.context);else{t.param.unShowGuide||($(".js_add_travel_plan_background").addClass("opacity-6").show(),t.forbidBodyScroll(),$(".js_add_travel_plan_btns").show(),setTimeout(function(){$(".js_add_travel_plan_background").hide(),t.allowBodyScroll(),$(".js_add_travel_plan_btns").hide()},5e3));try{i.doBusinessJob({businessCode:801001,data:{type:0,key:"travelFirstAccessFlag",context:1,expiry:2e4},callback:function(t){}})}catch(t){}}}})}catch(t){}},gotoTravelPage:function(t){Lizard.isHybrid||Lizard.isInCtripApp?e.compareAppVersion("7.2")<=0?o.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/journeys/travelplan/list.html?from="+window.location.href,"destination/journey/index.html#travelplan/list.html"],targetModel:4}):1==e.compareAppVersion("7.1")?o.toJump({url:["","destination/journey/index.html#travelscheme/"+t+".html?hideBrandTip=1"],targetModel:4}):o.toJump({url:["ctrip://wireless/destination/toTravlePlanEdit?packageId="+t,"ctrip://wireless/destination/toTravlePlanEdit?packageId="+t],targetModel:1}):o.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/journeys/travelplan/list.html?from="+window.location.href,"destination/journey/index.html#travelplan/list.html"],targetModel:4})},forbidBodyScroll:function(){$(".js_add_travel_plan_background").on("touchmove",function(t){return t.stopImmediatePropagation(),t.preventDefault,!1})},allowBodyScroll:function(){$(".js_add_travel_plan_background").off("touchmove")},getGUID:function t(){this.date=new Date,"function"!=typeof this.newGUID&&(t.prototype.newGUID=function(){this.date=new Date;var t="";sexadecimalDate=this.hexadecimal(this.getGUIDDate(),16),sexadecimalTime=this.hexadecimal(this.getGUIDTime(),16);for(var e=0;e<9;e++)t+=Math.floor(16*Math.random()).toString(16);for(t+=sexadecimalDate,t+=sexadecimalTime;t.length<32;)t+=Math.floor(16*Math.random()).toString(16);return this.formatGUID(t)},t.prototype.getGUIDDate=function(){return this.date.getFullYear()+this.addZero(this.date.getMonth()+1)+this.addZero(this.date.getDay())},t.prototype.getGUIDTime=function(){return this.addZero(this.date.getHours())+this.addZero(this.date.getMinutes())+this.addZero(this.date.getSeconds())+this.addZero(parseInt(this.date.getMilliseconds()/10))},t.prototype.addZero=function(t){return"NaN"!=Number(t).toString()&&t>=0&&t<10?"0"+Math.floor(t):t.toString()},t.prototype.hexadecimal=function(t,e,i){return void 0!=i?parseInt(t.toString(),i).toString(e):parseInt(t.toString()).toString(e)},t.prototype.formatGUID=function(t){return t.slice(0,8)+"-"+t.slice(8,12)+"-"+t.slice(12,16)+"-"+t.slice(16,20)+"-"+t.slice(20)})}}}),define("gsErrorPopModel",["cModel","cCoreInherit"],function(t,e){return{SetDetail:new e.Class(t,{__propertys__:function(){this.url="/soa2/10356/json/InsertPoiErrorInfo",this.param={PoiId:0,ErrorType:0,OtherInfo:"",Email:""}},initialize:function($super,t){$super(t)},parse:function(t){return{}}})}}),define("gsErrorPop",["gsErrorPopModel","gsRouterRedirect","gsAppAgent"],function(t,e,i){var o=t.SetDetail.getInstance();return{init:function(t){var e=this;e._setDeploy(),e.opts=t,e._getType(),e._setHtml()},_setDeploy:function(){var t=this;t.poiName="",t.poiEName="",t.currentUrl=encodeURIComponent(window.location.href)},_getType:function(){var t=this;switch(t.opts.PoiType){case 1:t.poiName="景点",t.poiEName="sight";break;case 2:t.poiName="玩乐",t.poiEName="resort";break;case 3:t.poiName="商户",t.poiEName="shops";break;case 4:t.poiName="餐馆",t.poiEName="foods"}},_setHtml:function(){var t=this;if(i.isHybrid())var e="<div class='js_error_pop mod_msg_pop' style='display:none;'>    <div class='js_error_pop_show this_wrap'>        <div class='this_list'>            <div class='js_error_pop_list this_group'>                <a data-type='1' id='c_sight_status'>"+t.poiName+"已关</a>                <a data-type='4' id='c_duplicate'>"+t.poiName+"重复</a>                <a data-type='2' id='c_sight_latitude'>地图位置错误</a>                <a data-type='3' id='c_sight_info'>其它信息错误</a>            </div>            <div class='this_group'>                <a class='js_error_close' id='c_sight_cancel'>取消</a>            </div>        </div>    </div></div>";else var e="<div class='js_error_pop mod_msg_pop' style='display:none;'>    <div class='js_error_pop_show this_wrap'>        <div class='this_list'>            <div class='js_error_pop_list this_group'>                <a data-type='1' id='c_sight_status'>"+t.poiName+"已关</a>                <a data-type='2' id='c_sight_latitude'>地图位置错误</a>                <a data-type='3' id='c_sight_info'>其它信息错误</a>            </div>            <div class='this_group'>                <a class='js_error_close' id='c_sight_cancel'>取消</a>            </div>        </div>    </div></div>";$(".main-viewport").append(e),t.$pop=$(".js_error_pop"),t.$popShow=$(".js_error_pop_show"),t._addEvent()},_addEvent:function(){var t=this,o=$(".js_error_pop_list a"),s=$(".js_error_close");o.off().on("click",function(){var o=$(this).data("type");switch(t._toClose(),o){case 1:if(!i.isHybrid()||"1"!=t.opts.PoiType&&"4"!=t.opts.PoiType&&"3"!=t.opts.PoiType){var s="确认该"+t.poiName+"已经关闭了吗？";t._setCommit({msg:s,type:1})}else e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/sparkplan/recovery/"+t.poiEName+"_"+t.opts.PoiId+".html"],targetModel:2});break;case 2:if(!i.isHybrid()||"1"!=t.opts.PoiType&&"4"!=t.opts.PoiType&&"3"!=t.opts.PoiType){var s="确认该"+t.poiName+"的地图位置是错误的吗？";t._setCommit({msg:s,type:2})}else 1==i.compareAppVersion("6.16")?e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/sparkplan/location/map/"+t.poiEName+"_"+t.opts.PoiId+".html?originLat="+t.opts.Lat+"&originLng="+t.opts.Lng],targetModel:2}):e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/map/location/select.html?type="+t.poiEName+"&poiId="+t.opts.PoiId+"&originSource=0&originLat="+t.opts.Lat+"&originLng="+t.opts.Lng,"destination/map/index.html#map/location/select.html?type="+t.poiEName+"&poiId="+t.opts.PoiId+"&originSource=0&originLat="+t.opts.Lat+"&originLng="+t.opts.Lng],targetModel:4});break;case 3:!i.isHybrid()||"1"!=t.opts.PoiType&&"4"!=t.opts.PoiType&&"3"!=t.opts.PoiType?e.toJump({url:[e.getStraightLink()+"/webapp/you/shops/"+t.opts.PoiId+"-error.html?from="+t.currentUrl],targetModel:2}):e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/sparkplan/info/"+t.poiEName+"_"+t.opts.PoiId+".html"],targetModel:2});break;case 4:!i.isHybrid()||"1"!=t.opts.PoiType&&"4"!=t.opts.PoiType&&"3"!=t.opts.PoiType||e.toJump({url:[Lizard.H5BaseUrl+"/webapp/you/sparkplan/repeat/"+t.poiEName+"_"+t.opts.PoiId+".html?districtId="+t.opts.DistrictId],targetModel:2})}}),s.off().on("click",function(){t._toClose()}),t.$pop.on("click",function(){t._toClose()})},_setCommit:function(t){var e=this;setTimeout(function(){Lizard.showMessage({datamodel:{content:t.msg,btns:[{name:"取消",className:"cui-btns-cancel"},{name:"确定",className:"cui-btns-ok"}]},okAction:function(){this.hide(),e.updateData(t.type)},cancleAction:function(){this.hide()}})},400)},showLayout:function(){var t=this;t.$pop.show(),setTimeout(function(){t.$popShow.addClass("this_slideUp")},1)},_toClose:function(){var t=this;t.$popShow.removeClass("this_slideUp"),setTimeout(function(){t.$pop.hide()},300)},updateData:function(t){var e=this;o.setParam({PoiId:e.opts.PoiId,ErrorType:t}),o.excute(function(t){setTimeout(function(){Lizard.showMessage({datamodel:{content:"非常感谢你的反馈！",btns:[{name:"确定",className:"cui-btns-ok"}]},okAction:function(){this.hide()}})},300)},function(t){Lizard.showMessage({datamodel:{content:"网络不给力，请稍候再试试吧！",btns:[{name:"确定",className:"cui-btns-ok"}]},okAction:function(){this.hide()}})})}}}),define("gsBaiduGrab",[],function(){}),function(t,e,i){function o(i,o){this.wrapper="string"==typeof i?e.querySelector(i):i,this.scroller=this.wrapper.children[0],this.scrollerStyle=this.scroller.style,this.options={resizeScrollbars:!0,mouseWheelSpeed:20,snapThreshold:.334,disablePointer:!r.hasPointer,disableTouch:r.hasPointer||!r.hasTouch,disableMouse:r.hasPointer||r.hasTouch,startX:0,startY:0,scrollY:!0,directionLockThreshold:5,momentum:!0,bounce:!0,bounceTime:600,bounceEasing:"",preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,bindToWrapper:void 0===t.onmousedown,dir:"forward",thisY:"",maxY:""};for(var s in o)this.options[s]=o[s];this.translateZ=this.options.HWCompositing&&r.hasPerspective?" translateZ(0)":"",this.options.useTransition=r.hasTransition&&this.options.useTransition,this.options.useTransform=r.hasTransform&&this.options.useTransform,this.options.eventPassthrough=!0===this.options.eventPassthrough?"vertical":this.options.eventPassthrough,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollY="vertical"!=this.options.eventPassthrough&&this.options.scrollY,this.options.scrollX="horizontal"!=this.options.eventPassthrough&&this.options.scrollX,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,this.options.bounceEasing="string"==typeof this.options.bounceEasing?r.ease[this.options.bounceEasing]||r.ease.circular:this.options.bounceEasing,this.options.resizePolling=void 0===this.options.resizePolling?60:this.options.resizePolling,!0===this.options.tap&&(this.options.tap="tap"),this.options.useTransition||this.options.useTransform||/relative|absolute/i.test(this.scrollerStyle.position)||(this.scrollerStyle.position="relative"),"scale"==this.options.shrinkScrollbars&&(this.options.useTransition=!1),this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1,this.x=0,this.y=0,this.directionX=0,this.directionY=0,this._events={},this._init(),this.refresh(),this.scrollTo(this.options.startX,this.options.startY),this.enable()}function s(t,i,o){var s=e.createElement("div"),n=e.createElement("div");return!0===o&&(s.style.cssText="position:absolute;z-index:9999",n.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"),n.className="iScrollIndicator","h"==t?(!0===o&&(s.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",n.style.height="100%"),s.className="iScrollHorizontalScrollbar"):(!0===o&&(s.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",n.style.width="100%"),s.className="iScrollVerticalScrollbar"),s.style.cssText+=";overflow:hidden",i||(s.style.pointerEvents="none"),s.appendChild(n),s}function n(i,o){this.wrapper="string"==typeof o.el?e.querySelector(o.el):o.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=i,this.options={listenX:!0,listenY:!0,interactive:!1,resize:!0,defaultScrollbars:!1,shrink:!1,fade:!1,speedRatioX:0,speedRatioY:0};for(var s in o)this.options[s]=o[s];if(this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.options.interactive&&(this.options.disableTouch||(r.addEvent(this.indicator,"touchstart",this),r.addEvent(t,"touchend",this)),this.options.disablePointer||(r.addEvent(this.indicator,r.prefixPointerEvent("pointerdown"),this),r.addEvent(t,r.prefixPointerEvent("pointerup"),this)),this.options.disableMouse||(r.addEvent(this.indicator,"mousedown",this),r.addEvent(t,"mouseup",this))),this.options.fade){this.wrapperStyle[r.style.transform]=this.scroller.translateZ;var n=r.style.transitionDuration;if(!n)return;this.wrapperStyle[n]=r.isBadAndroid?"0.0001ms":"0ms";var c=this;r.isBadAndroid&&a(function(){"0.0001ms"===c.wrapperStyle[n]&&(c.wrapperStyle[n]="0s")}),this.wrapperStyle.opacity="0"}}var a=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(e){t.setTimeout(e,1e3/60)},r=function(){function o(t){return!1!==a&&(""===a?t:a+t.charAt(0).toUpperCase()+t.substr(1))}var s={},n=e.createElement("div").style,a=function(){for(var t=["t","webkitT","MozT","msT","OT"],e=0,i=t.length;e<i;e++)if(t[e]+"ransform"in n)return t[e].substr(0,t[e].length-1);return!1}();s.getTime=Date.now||function(){return(new Date).getTime()},s.extend=function(t,e){for(var i in e)t[i]=e[i]},s.addEvent=function(t,e,i,o){t.addEventListener(e,i,!!o)},s.removeEvent=function(t,e,i,o){t.removeEventListener(e,i,!!o)},s.prefixPointerEvent=function(e){return t.MSPointerEvent?"MSPointer"+e.charAt(7).toUpperCase()+e.substr(8):e},s.momentum=function(t,e,o,s,n,a){var r,c,l=t-e,d=i.abs(l)/o;return a=void 0===a?6e-4:a,r=t+d*d/(2*a)*(l<0?-1:1),c=d/a,r<s?(r=n?s-n/2.5*(d/8):s,l=i.abs(r-t),c=l/d):r>0&&(r=n?n/2.5*(d/8):0,l=i.abs(t)+r,c=l/d),{destination:i.round(r),duration:c}};var r=o("transform");return s.extend(s,{hasTransform:!1!==r,hasPerspective:o("perspective")in n,hasTouch:"ontouchstart"in t,hasPointer:!(!t.PointerEvent&&!t.MSPointerEvent),hasTransition:o("transition")in n}),s.isBadAndroid=function(){var e=t.navigator.appVersion;if(/Android/.test(e)&&!/Chrome\/\d/.test(e)){var i=e.match(/Safari\/(\d+.\d)/);return!(i&&"object"==typeof i&&i.length>=2)||parseFloat(i[1])<535.19}return!1}(),s.extend(s.style={},{transform:r,transitionTimingFunction:o("transitionTimingFunction"),transitionDuration:o("transitionDuration"),transitionDelay:o("transitionDelay"),transformOrigin:o("transformOrigin")}),s.hasClass=function(t,e){return new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},s.addClass=function(t,e){if(!s.hasClass(t,e)){var i=t.className.split(" ");i.push(e),t.className=i.join(" ")}},s.removeClass=function(t,e){if(s.hasClass(t,e)){var i=new RegExp("(^|\\s)"+e+"(\\s|$)","g");t.className=t.className.replace(i," ")}},s.offset=function(t){for(var e=-t.offsetLeft,i=-t.offsetTop;t=t.offsetParent;)e-=t.offsetLeft,i-=t.offsetTop;return{left:e,top:i}},s.preventDefaultException=function(t,e){for(var i in e)if(e[i].test(t[i]))return!0;return!1},s.extend(s.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3}),s.extend(s.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(t){return i.sqrt(1- --t*t)}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(t){return(t-=1)*t*(5*t+4)+1}},bounce:{style:"",fn:function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}},elastic:{style:"",fn:function(t){return 0===t?0:1==t?1:.4*i.pow(2,-10*t)*i.sin((t-.055)*(2*i.PI)/.22)+1}}}),s.tap=function(t,i){var o=e.createEvent("Event");o.initEvent(i,!0,!0),o.pageX=t.pageX,o.pageY=t.pageY,t.target.dispatchEvent(o)},s.click=function(i){var o,s=i.target;/(SELECT|INPUT|TEXTAREA)/i.test(s.tagName)||(o=e.createEvent(t.MouseEvent?"MouseEvents":"Event"),
o.initEvent("click",!0,!0),o.view=i.view||t,o.detail=1,o.screenX=s.screenX||0,o.screenY=s.screenY||0,o.clientX=s.clientX||0,o.clientY=s.clientY||0,o.ctrlKey=!!i.ctrlKey,o.altKey=!!i.altKey,o.shiftKey=!!i.shiftKey,o.metaKey=!!i.metaKey,o.button=0,o.relatedTarget=null,o._constructed=!0,s.dispatchEvent(o))},s}();o.prototype={version:"5.2.0",_init:function(){this._initEvents(),(this.options.scrollbars||this.options.indicators)&&this._initIndicators(),this.options.mouseWheel&&this._initWheel(),this.options.snap&&this._initSnap(),this.options.keyBindings&&this._initKeys()},destroy:function(){this._initEvents(!0),clearTimeout(this.resizeTimeout),this.resizeTimeout=null,this._execEvent("destroy")},_transitionEnd:function(t){t.target==this.scroller&&this.isInTransition&&(this._transitionTime(),this.resetPosition(this.options.bounceTime)||(this.isInTransition=!1,this._execEvent("scrollEnd")))},_start:function(t){if(1!=r.eventType[t.type]){if(0!==(t.which?t.button:t.button<2?0:4==t.button?1:2))return}if(this.enabled&&(!this.initiated||r.eventType[t.type]===this.initiated)){!this.options.preventDefault||r.isBadAndroid||r.preventDefaultException(t.target,this.options.preventDefaultException)||t.preventDefault();var e,o=t.touches?t.touches[0]:t;this.initiated=r.eventType[t.type],this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.directionLocked=0,this.startTime=r.getTime(),this.options.useTransition&&this.isInTransition?(this._transitionTime(),this.isInTransition=!1,e=this.getComputedPosition(),this._translate(i.round(e.x),i.round(e.y)),this._execEvent("scrollEnd")):!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,this._execEvent("scrollEnd")),this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=o.pageX,this.pointY=o.pageY,this._execEvent("beforeScrollStart")}},_move:function(e){if(this.enabled&&r.eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault();var o,s,n,a,c=e.touches?e.touches[0]:e,l=c.pageX-this.pointX,d=c.pageY-this.pointY,h=r.getTime();if(this.pointX=c.pageX,this.pointY=c.pageY,this.distX+=l,this.distY+=d,n=i.abs(this.distX),a=i.abs(this.distY),!(h-this.endTime>300&&n<10&&a<10)){if(this.directionLocked||this.options.freeScroll||(n>a+this.options.directionLockThreshold?this.directionLocked="h":a>=n+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"==this.directionLocked){if("vertical"==this.options.eventPassthrough)e.preventDefault();else if("horizontal"==this.options.eventPassthrough)return void(this.initiated=!1);d=0}else if("v"==this.directionLocked){if("horizontal"==this.options.eventPassthrough)e.preventDefault();else if("vertical"==this.options.eventPassthrough)return void(this.initiated=!1);l=0}if(this.y<this.maxScrollY&&this.pointY<1)return void this.scrollTo(0,this.maxScrollY,400);if(this.y>0&&this.pointY>t.innerHeight-1)return void this.scrollTo(0,0,400);l=this.hasHorizontalScroll?l:0,d=this.hasVerticalScroll?d:0,o=this.x+l,s=this.y+d,(o>0||o<this.maxScrollX)&&(o=this.options.bounce?this.x+l/3:o>0?0:this.maxScrollX),(s>0||s<this.maxScrollY)&&(s=this.options.bounce?this.y+d/3:s>0?0:this.maxScrollY),this.directionX=l>0?-1:l<0?1:0,this.directionY=d>0?-1:d<0?1:0,this.moved||this._execEvent("scrollStart"),this.moved=!0,o>this.x||s>this.y?this.dir="forward":this.dir="back",this.thisY=this.y,this.maxY=this.maxScrollY,this._translate(o,s),h-this.startTime>300&&(this.startTime=h,this.startX=this.x,this.startY=this.y)}}},_end:function(t){if(this.enabled&&r.eventType[t.type]===this.initiated){this.options.preventDefault&&!r.preventDefaultException(t.target,this.options.preventDefaultException)&&t.preventDefault();var e,o,s=(t.changedTouches&&t.changedTouches[0],r.getTime()-this.startTime),n=i.round(this.x),a=i.round(this.y),c=i.abs(n-this.startX),l=i.abs(a-this.startY),d=0,h="";if(this.isInTransition=0,this.initiated=0,this.endTime=r.getTime(),!this.resetPosition(this.options.bounceTime)){if(this.scrollTo(n,a),!this.moved)return this.options.tap&&r.tap(t,this.options.tap),this.options.click&&r.click(t),void this._execEvent("scrollCancel");if(this._events.flick&&s<200&&c<100&&l<100)return void this._execEvent("flick");if(this.options.momentum&&s<300&&(e=this.hasHorizontalScroll?r.momentum(this.x,this.startX,s,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:n,duration:0},o=this.hasVerticalScroll?r.momentum(this.y,this.startY,s,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:a,duration:0},n=e.destination,a=o.destination,d=i.max(e.duration,o.duration),this.isInTransition=1),this.options.snap){var p=this._nearestSnap(n,a);this.currentPage=p,d=this.options.snapSpeed||i.max(i.max(i.min(i.abs(n-p.x),1e3),i.min(i.abs(a-p.y),1e3)),300),n=p.x,a=p.y,this.directionX=0,this.directionY=0,h=this.options.bounceEasing}if(n!=this.x||a!=this.y)return(n>0||n<this.maxScrollX||a>0||a<this.maxScrollY)&&(h=r.ease.quadratic),void this.scrollTo(n,a,d,h);this._execEvent("scrollEnd")}}},_resize:function(){var t=this;clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){t.refresh()},this.options.resizePolling)},resetPosition:function(t){var e=this.x,i=this.y;return t=t||0,!this.hasHorizontalScroll||this.x>0?e=0:this.x<this.maxScrollX&&(e=this.maxScrollX),!this.hasVerticalScroll||this.y>0?i=0:this.y<this.maxScrollY&&(i=this.maxScrollY),(e!=this.x||i!=this.y)&&(this.scrollTo(e,i,t,this.options.bounceEasing),!0)},disable:function(){this.enabled=!1},enable:function(){this.enabled=!0},refresh:function(){this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.scrollerWidth=this.scroller.offsetWidth,this.scrollerHeight=this.scroller.offsetHeight,this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.maxScrollY=this.wrapperHeight-this.scrollerHeight,this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0,this.hasHorizontalScroll||(this.maxScrollX=0,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=0,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=r.offset(this.wrapper),this._execEvent("refresh"),this.resetPosition()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){if(this._events[t]){var i=this._events[t].indexOf(e);i>-1&&this._events[t].splice(i,1)}},_execEvent:function(t){if(this._events[t]){var e=0,i=this._events[t].length;if(i)for(;e<i;e++)this._events[t][e].apply(this,[].slice.call(arguments,1))}},scrollBy:function(t,e,i,o){t=this.x+t,e=this.y+e,i=i||0,this.scrollTo(t,e,i,o)},scrollTo:function(t,e,i,o){o=o||r.ease.circular,this.isInTransition=this.options.useTransition&&i>0;var s=this.options.useTransition&&o.style;!i||s?(s&&(this._transitionTimingFunction(o.style),this._transitionTime(i)),this._translate(t,e)):this._animate(t,e,i,o.fn)},scrollToElement:function(t,e,o,s,n){if(t=t.nodeType?t:this.scroller.querySelector(t)){var a=r.offset(t);a.left-=this.wrapperOffset.left,a.top-=this.wrapperOffset.top,!0===o&&(o=i.round(t.offsetWidth/2-this.wrapper.offsetWidth/2)),!0===s&&(s=i.round(t.offsetHeight/2-this.wrapper.offsetHeight/2)),a.left-=o||0,a.top-=s||0,a.left=a.left>0?0:a.left<this.maxScrollX?this.maxScrollX:a.left,a.top=a.top>0?0:a.top<this.maxScrollY?this.maxScrollY:a.top,e=void 0===e||null===e||"auto"===e?i.max(i.abs(this.x-a.left),i.abs(this.y-a.top)):e,this.scrollTo(a.left,a.top,e,n)}},_transitionTime:function(t){if(this.options.useTransition){t=t||0;var e=r.style.transitionDuration;if(e){if(this.scrollerStyle[e]=t+"ms",!t&&r.isBadAndroid){this.scrollerStyle[e]="0.0001ms";var i=this;a(function(){"0.0001ms"===i.scrollerStyle[e]&&(i.scrollerStyle[e]="0s")})}if(this.indicators)for(var o=this.indicators.length;o--;)this.indicators[o].transitionTime(t)}}},_transitionTimingFunction:function(t){if(this.scrollerStyle[r.style.transitionTimingFunction]=t,this.indicators)for(var e=this.indicators.length;e--;)this.indicators[e].transitionTimingFunction(t)},_translate:function(t,e){if(this.options.useTransform?this.scrollerStyle[r.style.transform]="translate("+t+"px,"+e+"px)"+this.translateZ:(t=i.round(t),e=i.round(e),this.scrollerStyle.left=t+"px",this.scrollerStyle.top=e+"px"),this.x=t,this.y=e,this.indicators)for(var o=this.indicators.length;o--;)this.indicators[o].updatePosition()},_initEvents:function(e){var i=e?r.removeEvent:r.addEvent,o=this.options.bindToWrapper?this.wrapper:t;i(t,"orientationchange",this),i(t,"resize",this),this.options.click&&i(this.wrapper,"click",this,!0),this.options.disableMouse||(i(this.wrapper,"mousedown",this),i(o,"mousemove",this),i(o,"mousecancel",this),i(o,"mouseup",this)),r.hasPointer&&!this.options.disablePointer&&(i(this.wrapper,r.prefixPointerEvent("pointerdown"),this),i(o,r.prefixPointerEvent("pointermove"),this),i(o,r.prefixPointerEvent("pointercancel"),this),i(o,r.prefixPointerEvent("pointerup"),this)),r.hasTouch&&!this.options.disableTouch&&(i(this.wrapper,"touchstart",this),i(o,"touchmove",this),i(o,"touchcancel",this),i(o,"touchend",this)),i(this.scroller,"transitionend",this),i(this.scroller,"webkitTransitionEnd",this),i(this.scroller,"oTransitionEnd",this),i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var e,i,o=t.getComputedStyle(this.scroller,null);return this.options.useTransform?(o=o[r.style.transform].split(")")[0].split(", "),e=+(o[12]||o[4]),i=+(o[13]||o[5])):(e=+o.left.replace(/[^-\d.]/g,""),i=+o.top.replace(/[^-\d.]/g,"")),{x:e,y:i}},_initIndicators:function(){function t(t){if(r.indicators)for(var e=r.indicators.length;e--;)t.call(r.indicators[e])}var e,i=this.options.interactiveScrollbars,o="string"!=typeof this.options.scrollbars,a=[],r=this;this.indicators=[],this.options.scrollbars&&(this.options.scrollY&&(e={el:s("v",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:o,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:!1},this.wrapper.appendChild(e.el),a.push(e)),this.options.scrollX&&(e={el:s("h",i,this.options.scrollbars),interactive:i,defaultScrollbars:!0,customStyle:o,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:!1},this.wrapper.appendChild(e.el),a.push(e))),this.options.indicators&&(a=a.concat(this.options.indicators));for(var c=a.length;c--;)this.indicators.push(new n(this,a[c]));this.options.fadeScrollbars&&(this.on("scrollEnd",function(){t(function(){this.fade()})}),this.on("scrollCancel",function(){t(function(){this.fade()})}),this.on("scrollStart",function(){t(function(){this.fade(1)})}),this.on("beforeScrollStart",function(){t(function(){this.fade(1,!0)})})),this.on("refresh",function(){t(function(){this.refresh()})}),this.on("destroy",function(){t(function(){this.destroy()}),delete this.indicators})},_initWheel:function(){r.addEvent(this.wrapper,"wheel",this),r.addEvent(this.wrapper,"mousewheel",this),r.addEvent(this.wrapper,"DOMMouseScroll",this),this.on("destroy",function(){clearTimeout(this.wheelTimeout),this.wheelTimeout=null,r.removeEvent(this.wrapper,"wheel",this),r.removeEvent(this.wrapper,"mousewheel",this),r.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(t){if(this.enabled){t.preventDefault();var e,o,s,n,a=this;if(void 0===this.wheelTimeout&&a._execEvent("scrollStart"),clearTimeout(this.wheelTimeout),this.wheelTimeout=setTimeout(function(){a.options.snap||a._execEvent("scrollEnd"),a.wheelTimeout=void 0},400),"deltaX"in t)1===t.deltaMode?(e=-t.deltaX*this.options.mouseWheelSpeed,o=-t.deltaY*this.options.mouseWheelSpeed):(e=-t.deltaX,o=-t.deltaY);else if("wheelDeltaX"in t)e=t.wheelDeltaX/120*this.options.mouseWheelSpeed,o=t.wheelDeltaY/120*this.options.mouseWheelSpeed;else if("wheelDelta"in t)e=o=t.wheelDelta/120*this.options.mouseWheelSpeed;else{if(!("detail"in t))return;e=o=-t.detail/3*this.options.mouseWheelSpeed}if(e*=this.options.invertWheelDirection,o*=this.options.invertWheelDirection,this.hasVerticalScroll||(e=o,o=0),this.options.snap)return s=this.currentPage.pageX,n=this.currentPage.pageY,e>0?s--:e<0&&s++,o>0?n--:o<0&&n++,void this.goToPage(s,n);s=this.x+i.round(this.hasHorizontalScroll?e:0),n=this.y+i.round(this.hasVerticalScroll?o:0),this.directionX=e>0?-1:e<0?1:0,this.directionY=o>0?-1:o<0?1:0,s>0?s=0:s<this.maxScrollX&&(s=this.maxScrollX),n>0?n=0:n<this.maxScrollY&&(n=this.maxScrollY),this.scrollTo(s,n,0)}},_initSnap:function(){this.currentPage={},"string"==typeof this.options.snap&&(this.options.snap=this.scroller.querySelectorAll(this.options.snap)),this.on("refresh",function(){var t,e,o,s,n,a,r=0,c=0,l=0,d=this.options.snapStepX||this.wrapperWidth,h=this.options.snapStepY||this.wrapperHeight;if(this.pages=[],this.wrapperWidth&&this.wrapperHeight&&this.scrollerWidth&&this.scrollerHeight){if(!0===this.options.snap)for(o=i.round(d/2),s=i.round(h/2);l>-this.scrollerWidth;){for(this.pages[r]=[],t=0,n=0;n>-this.scrollerHeight;)this.pages[r][t]={x:i.max(l,this.maxScrollX),y:i.max(n,this.maxScrollY),width:d,height:h,cx:l-o,cy:n-s},n-=h,t++;l-=d,r++}else for(a=this.options.snap,t=a.length,e=-1;r<t;r++)(0===r||a[r].offsetLeft<=a[r-1].offsetLeft)&&(c=0,e++),this.pages[c]||(this.pages[c]=[]),l=i.max(-a[r].offsetLeft,this.maxScrollX),n=i.max(-a[r].offsetTop,this.maxScrollY),o=l-i.round(a[r].offsetWidth/2),s=n-i.round(a[r].offsetHeight/2),this.pages[c][e]={x:l,y:n,width:a[r].offsetWidth,height:a[r].offsetHeight,cx:o,cy:s},l>this.maxScrollX&&c++;this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0),this.options.snapThreshold%1==0?(this.snapThresholdX=this.options.snapThreshold,this.snapThresholdY=this.options.snapThreshold):(this.snapThresholdX=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold),this.snapThresholdY=i.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold))}}),this.on("flick",function(){var t=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.x-this.startX),1e3),i.min(i.abs(this.y-this.startY),1e3)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,t)})},_nearestSnap:function(t,e){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var o=0,s=this.pages.length,n=0;if(i.abs(t-this.absStartX)<this.snapThresholdX&&i.abs(e-this.absStartY)<this.snapThresholdY)return this.currentPage;for(t>0?t=0:t<this.maxScrollX&&(t=this.maxScrollX),e>0?e=0:e<this.maxScrollY&&(e=this.maxScrollY);o<s;o++)if(t>=this.pages[o][0].cx){t=this.pages[o][0].x;break}for(s=this.pages[o].length;n<s;n++)if(e>=this.pages[0][n].cy){e=this.pages[0][n].y;break}return o==this.currentPage.pageX&&(o+=this.directionX,o<0?o=0:o>=this.pages.length&&(o=this.pages.length-1),t=this.pages[o][0].x),n==this.currentPage.pageY&&(n+=this.directionY,n<0?n=0:n>=this.pages[0].length&&(n=this.pages[0].length-1),e=this.pages[0][n].y),{x:t,y:e,pageX:o,pageY:n}},goToPage:function(t,e,o,s){s=s||this.options.bounceEasing,t>=this.pages.length?t=this.pages.length-1:t<0&&(t=0),e>=this.pages[t].length?e=this.pages[t].length-1:e<0&&(e=0);var n=this.pages[t][e].x,a=this.pages[t][e].y;o=void 0===o?this.options.snapSpeed||i.max(i.max(i.min(i.abs(n-this.x),1e3),i.min(i.abs(a-this.y),1e3)),300):o,this.currentPage={x:n,y:a,pageX:t,pageY:e},this.scrollTo(n,a,o,s)},next:function(t,e){var i=this.currentPage.pageX,o=this.currentPage.pageY;i++,i>=this.pages.length&&this.hasVerticalScroll&&(i=0,o++),this.goToPage(i,o,t,e)},prev:function(t,e){var i=this.currentPage.pageX,o=this.currentPage.pageY;i--,i<0&&this.hasVerticalScroll&&(i=0,o--),this.goToPage(i,o,t,e)},_initKeys:function(e){var i,o={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};if("object"==typeof this.options.keyBindings)for(i in this.options.keyBindings)"string"==typeof this.options.keyBindings[i]&&(this.options.keyBindings[i]=this.options.keyBindings[i].toUpperCase().charCodeAt(0));else this.options.keyBindings={};for(i in o)this.options.keyBindings[i]=this.options.keyBindings[i]||o[i];r.addEvent(t,"keydown",this),this.on("destroy",function(){r.removeEvent(t,"keydown",this)})},_key:function(t){if(this.enabled){var e,o=this.options.snap,s=o?this.currentPage.pageX:this.x,n=o?this.currentPage.pageY:this.y,a=r.getTime(),c=this.keyTime||0;switch(this.options.useTransition&&this.isInTransition&&(e=this.getComputedPosition(),this._translate(i.round(e.x),i.round(e.y)),this.isInTransition=!1),this.keyAcceleration=a-c<200?i.min(this.keyAcceleration+.25,50):0,t.keyCode){case this.options.keyBindings.pageUp:this.hasHorizontalScroll&&!this.hasVerticalScroll?s+=o?1:this.wrapperWidth:n+=o?1:this.wrapperHeight;break;case this.options.keyBindings.pageDown:this.hasHorizontalScroll&&!this.hasVerticalScroll?s-=o?1:this.wrapperWidth:n-=o?1:this.wrapperHeight;break;case this.options.keyBindings.end:s=o?this.pages.length-1:this.maxScrollX,n=o?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:s=0,n=0;break;case this.options.keyBindings.left:s+=o?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:n+=o?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:s-=o?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:n-=o?1:5+this.keyAcceleration>>0;break;default:return}if(o)return void this.goToPage(s,n);s>0?(s=0,this.keyAcceleration=0):s<this.maxScrollX&&(s=this.maxScrollX,this.keyAcceleration=0),n>0?(n=0,this.keyAcceleration=0):n<this.maxScrollY&&(n=this.maxScrollY,this.keyAcceleration=0),this.scrollTo(s,n,0),this.keyTime=a}},_animate:function(t,e,i,o){function s(){var p,u,m,g=r.getTime();if(g>=h)return n.isAnimating=!1,n._translate(t,e),void(n.resetPosition(n.options.bounceTime)||n._execEvent("scrollEnd"));g=(g-d)/i,m=o(g),p=(t-c)*m+c,u=(e-l)*m+l,n._translate(p,u),n.isAnimating&&a(s)}var n=this,c=this.x,l=this.y,d=r.getTime(),h=d+i;this.isAnimating=!0,s()},handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(t);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(t);break;case"keydown":this._key(t);break;case"click":this.enabled&&!t._constructed&&(t.preventDefault(),t.stopPropagation())}}},n.prototype={handleEvent:function(t){switch(t.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(t);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(t);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(t)}},destroy:function(){this.options.fadeScrollbars&&(clearTimeout(this.fadeTimeout),this.fadeTimeout=null),this.options.interactive&&(r.removeEvent(this.indicator,"touchstart",this),r.removeEvent(this.indicator,r.prefixPointerEvent("pointerdown"),this),r.removeEvent(this.indicator,"mousedown",this),r.removeEvent(t,"touchmove",this),r.removeEvent(t,r.prefixPointerEvent("pointermove"),this),r.removeEvent(t,"mousemove",this),r.removeEvent(t,"touchend",this),r.removeEvent(t,r.prefixPointerEvent("pointerup"),this),r.removeEvent(t,"mouseup",this)),this.options.defaultScrollbars&&this.wrapper.parentNode.removeChild(this.wrapper)},_start:function(e){var i=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=i.pageX,this.lastPointY=i.pageY,this.startTime=r.getTime(),this.options.disableTouch||r.addEvent(t,"touchmove",this),this.options.disablePointer||r.addEvent(t,r.prefixPointerEvent("pointermove"),this),this.options.disableMouse||r.addEvent(t,"mousemove",this),this.scroller._execEvent("beforeScrollStart")},_move:function(t){var e,i,o,s,n=t.touches?t.touches[0]:t;r.getTime();this.moved||this.scroller._execEvent("scrollStart"),this.moved=!0,e=n.pageX-this.lastPointX,this.lastPointX=n.pageX,i=n.pageY-this.lastPointY,this.lastPointY=n.pageY,o=this.x+e,s=this.y+i,this._pos(o,s),t.preventDefault(),t.stopPropagation()},_end:function(e){if(this.initiated){if(this.initiated=!1,e.preventDefault(),e.stopPropagation(),r.removeEvent(t,"touchmove",this),r.removeEvent(t,r.prefixPointerEvent("pointermove"),this),r.removeEvent(t,"mousemove",this),this.scroller.options.snap){var o=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),s=this.options.snapSpeed||i.max(i.max(i.min(i.abs(this.scroller.x-o.x),1e3),i.min(i.abs(this.scroller.y-o.y),1e3)),300);this.scroller.x==o.x&&this.scroller.y==o.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=o,this.scroller.scrollTo(o.x,o.y,s,this.scroller.options.bounceEasing))}this.moved&&this.scroller._execEvent("scrollEnd")}},transitionTime:function(t){t=t||0;var e=r.style.transitionDuration;if(e&&(this.indicatorStyle[e]=t+"ms",!t&&r.isBadAndroid)){this.indicatorStyle[e]="0.0001ms";var i=this;a(function(){"0.0001ms"===i.indicatorStyle[e]&&(i.indicatorStyle[e]="0s")})}},transitionTimingFunction:function(t){this.indicatorStyle[r.style.transitionTimingFunction]=t},refresh:function(){this.transitionTime(),this.options.listenX&&!this.options.listenY?this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none":this.options.listenY&&!this.options.listenX?this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none":this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none",this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll?(r.addClass(this.wrapper,"iScrollBothScrollbars"),r.removeClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="8px":this.wrapper.style.bottom="8px")):(r.removeClass(this.wrapper,"iScrollBothScrollbars"),r.addClass(this.wrapper,"iScrollLoneScrollbar"),this.options.defaultScrollbars&&this.options.customStyle&&(this.options.listenX?this.wrapper.style.right="2px":this.wrapper.style.bottom="2px"));this.wrapper.offsetHeight;this.options.listenX&&(this.wrapperWidth=this.wrapper.clientWidth,this.options.resize?(this.indicatorWidth=i.max(i.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px"):this.indicatorWidth=this.indicator.clientWidth,this.maxPosX=this.wrapperWidth-this.indicatorWidth,"clip"==this.options.shrink?(this.minBoundaryX=8-this.indicatorWidth,this.maxBoundaryX=this.wrapperWidth-8):(this.minBoundaryX=0,this.maxBoundaryX=this.maxPosX),this.sizeRatioX=this.options.speedRatioX||this.scroller.maxScrollX&&this.maxPosX/this.scroller.maxScrollX),this.options.listenY&&(this.wrapperHeight=this.wrapper.clientHeight,this.options.resize?(this.indicatorHeight=i.max(i.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px"):this.indicatorHeight=this.indicator.clientHeight,this.maxPosY=this.wrapperHeight-this.indicatorHeight,"clip"==this.options.shrink?(this.minBoundaryY=8-this.indicatorHeight,this.maxBoundaryY=this.wrapperHeight-8):(this.minBoundaryY=0,this.maxBoundaryY=this.maxPosY),this.maxPosY=this.wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.options.speedRatioY||this.scroller.maxScrollY&&this.maxPosY/this.scroller.maxScrollY),this.updatePosition()},updatePosition:function(){var t=this.options.listenX&&i.round(this.sizeRatioX*this.scroller.x)||0,e=this.options.listenY&&i.round(this.sizeRatioY*this.scroller.y)||0;this.options.ignoreBoundaries||(t<this.minBoundaryX?("scale"==this.options.shrink&&(this.width=i.max(this.indicatorWidth+t,8),this.indicatorStyle.width=this.width+"px"),t=this.minBoundaryX):t>this.maxBoundaryX?"scale"==this.options.shrink?(this.width=i.max(this.indicatorWidth-(t-this.maxPosX),8),this.indicatorStyle.width=this.width+"px",t=this.maxPosX+this.indicatorWidth-this.width):t=this.maxBoundaryX:"scale"==this.options.shrink&&this.width!=this.indicatorWidth&&(this.width=this.indicatorWidth,this.indicatorStyle.width=this.width+"px"),e<this.minBoundaryY?("scale"==this.options.shrink&&(this.height=i.max(this.indicatorHeight+3*e,8),this.indicatorStyle.height=this.height+"px"),e=this.minBoundaryY):e>this.maxBoundaryY?"scale"==this.options.shrink?(this.height=i.max(this.indicatorHeight-3*(e-this.maxPosY),8),this.indicatorStyle.height=this.height+"px",e=this.maxPosY+this.indicatorHeight-this.height):e=this.maxBoundaryY:"scale"==this.options.shrink&&this.height!=this.indicatorHeight&&(this.height=this.indicatorHeight,this.indicatorStyle.height=this.height+"px")),this.x=t,this.y=e,this.scroller.options.useTransform?this.indicatorStyle[r.style.transform]="translate("+t+"px,"+e+"px)"+this.scroller.translateZ:(this.indicatorStyle.left=t+"px",this.indicatorStyle.top=e+"px")},_pos:function(t,e){t<0?t=0:t>this.maxPosX&&(t=this.maxPosX),e<0?e=0:e>this.maxPosY&&(e=this.maxPosY),t=this.options.listenX?i.round(t/this.sizeRatioX):this.scroller.x,e=this.options.listenY?i.round(e/this.sizeRatioY):this.scroller.y,this.scroller.scrollTo(t,e)},fade:function(t,e){if(!e||this.visible){clearTimeout(this.fadeTimeout),this.fadeTimeout=null;var i=t?250:500,o=t?0:300;t=t?"1":"0",this.wrapperStyle[r.style.transitionDuration]=i+"ms",this.fadeTimeout=setTimeout(function(t){this.wrapperStyle.opacity=t,this.visible=+t}.bind(this,t),o)}}},o.utils=r,"undefined"!=typeof module&&module.exports?module.exports=o:"function"==typeof define&&define.amd?define("gsIscroll",[],function(){return o}):t.IScroll=o}(window,document,Math),define("gsCommonMap",["cMap","cGeoService"],function(t,e){var i=function(e){var i=this,o=e.callback||"";i.isChina=e.isChina,i.mapType=e.isChina?"BMap":"AMap",t.loadMapScript(i.mapType,function(){o()})};return i.prototype={init:function(e){this.markerClicked=e.markerClicked||"",this.infoClicked=e.infoClicked||"",this.showMarker=e.showMarker||0,this.showInfo=e.showInfo||0,this.mapInitFun=e.mapInitFun||"",this.mapMoveFun=e.mapMoveFun||"",this.markerIcon=e.markerIcon||"https://pic.c-ctrip.com/h5/hotel/hotel-map-locate.png",this.currentIcon=e.currentIcon||"",this.infoWindowClass=e.infoWindowClass,this.markerSize=e.markerSize||{w:22,h:31},this.markerOffset=e.markerOffset||{w:0,h:0},this.infoOffset=e.infoOffset||{x:-22,y:this.showMarker?-67:-52};var i=this,o=e.lat||e.options[0]&&e.options[0].lat||31.2316409,s=e.lng||e.options[0]&&e.options[0].lng||121.4572466;options={id:e.id||"js_map",lat:o||"0",lng:s||"0",zoom:e.zoom||15,isBMap:!!e.isBMap},i.gsMap=t.createMap(options,i.mapType),e.options&&e.options.length>0&&i.createMarkers(e.options,!0),"function"==typeof i.mapInitFun&&i.mapInitFun(i.gsMap),"function"==typeof i.mapMoveFun&&t.addEventListener(i.gsMap,"moveend",function(t){i.mapMoveFun(i.gsMap)})},createMarkers:function(e,i){if(e&&0!=e.length){var o=this,s=[];if(o.showMarker){for(var n=0;n<e.length;n++)s.push({lat:e[n].lat,lng:e[n].lng,isBMap:!!e[n].isBMap,icon:{url:e[n].icon?e[n].icon.icon||o.markerIcon:o.markerIcon,size:e.markerSize||o.markerSize},offset:o.markerOffset});o.markersArr=t.createMarkers(s),t.showOverLays(o.markersArr)}for(var a=[],r=0;r<e.length;r++)e[r].text&&a.push({lat:e[r].lat,lng:e[r].lng,content:'<div class="'+o.infoWindowClass+" info_"+r+'">'+e[r].text+"</div>",isBMap:!!e[r].isBMap,index:r,offset:e[r].infoOffset||o.infoOffset,callBack:function(t){"function"==typeof o.infoClicked&&o.infoClicked(t.index)}});if(a.length>0&&(o.overylaysArr=t.createCustomOverlays(a),o.showInfo&&t.showOverLays(o.overylaysArr)),"function"==typeof o.markerClicked&&o.markersArr)for(var r=0;r<o.markersArr.length;r++)(e[r].icon&&1!=parseInt(e[r].icon.type,0)||!e[r].icon)&&t.addEventListener(o.markersArr[r],"click",function(t){return function(){o.markerClicked(t)}}(r))}},showOverylaysArr:function(e){var i=this.overylaysArr[e];i.isVisible()?t.hideOverlays([i]):(t.hideOverlays(this.overylaysArr),t.showOverLays([i]))},mapUpdateMark:function(t){var e=this;e.mapClear(),e.createMarkers(t)},getDistance:function(){var e=this,i="",o=t.getBounds().SW,s=t.getBounds().NE,n=t.createPoints([o,s]);return i=t.getDistance&&t.getDistance(n[0],n[1],e.gsMap),centerPoint=t.getCenter(),centerPoint.isBMap&&(centerPoint=t.bMapToAMap(centerPoint)),{Distance:i,Lng:t.getCenter().lng,Lat:t.getCenter().lat}},mapClear:function(){var e=this;t.hideOverlays(e.markersArr),t.hideOverlays(e.overylaysArr),$(".BMap_Marker").remove()},mapGetCurrentPosition:function(i){var o=i.onComplete||function(){},s=i.onError||function(){},n={onComplete:function(e){var i=t.createPoints([{lat:e.lat,lng:e.lng,isBMap:e.isBMap}]);t.setCenter(i[0]),o()},onError:s,onPosError:s};e.GeoLocation.Subscribe("GSMapGetCurrentLocation",n,"",!0,3e3,!0)},setCenterPoint:function(){var e=this;t.showOverLays(t.createMarkers([{lat:t.getCenter().lat,lng:t.getCenter().lng,isBMap:t.getCenter().isBMap,icon:{url:e.markerIcon,contentSize:{w:30,h:30},size:{w:22,h:31},anchor:{w:11,h:15}}}]))},setZoom:function(t){this.gsMap.setZoom(t)},fitBounds:function(e){var i=t.createPoints(e);t.fitBounds(i)},setCenter:function(e){var i=t.createPoints(e);t.setCenter(i[0])},getCenter:function(){return t.getCenter()}},i}),define("gsGoToHome",["cPageView","gsAppAgent","gsCommonStore","gsRouterRedirect","gsBusinessJob"],function(t,e,i,o,s){return{goToHomeClickStore:i.ifToGsHomeClick.getInstance(),goToHomeStore:i.ifToGsHome.getInstance(),goToHome:function(){var t=this;e.isGsHybrid()||Lizard.P("hideBrandTip")||(Lizard.isHybrid||Lizard.isInCtripApp?t.getUserHis(function(e){if(e&&e.param&&e.param.context){var i=(new Date).getTime(),o=e.param.context;"object"!=typeof o&&(o=JSON.parse(o)),i-o.ifToGsHome<=2592e5&&$(".js-bottom-goto-mdd").css({display:"none"}),i-o.ifToGsHomeClick<=432e6&&$(".js-bottom-goto-mdd").css({display:"none"}),i-o.ifToGsHome>2592e5&&i-o.ifToGsHomeClick>432e6&&($(".js-bottom-goto-mdd").css({display:"box",display:"-webkit-box",display:"-webkit-flex",display:"flex"}),setTimeout(function(){$(".js-bottom-goto-mdd").css({display:"none"}),t.setUserHis("ifToGsHome",{ifToGsHome:(new Date).getTime(),ifToGsHomeClick:0})},5e3))}else $(".js-bottom-goto-mdd").css({display:"box",display:"-webkit-box",display:"-webkit-flex",display:"flex"}),setTimeout(function(){$(".js-bottom-goto-mdd").css({display:"none"}),t.setUserHis("ifToGsHome",{ifToGsHome:(new Date).getTime(),ifToGsHomeClick:0})},5e3)},"ifToGsHome"):(t.goToHomeStore.get()||t.goToHomeClickStore.get()?$(".js-bottom-goto-mdd").css({display:"none"}):$(".js-bottom-goto-mdd").css({display:"box",display:"-webkit-box",display:"-webkit-flex",display:"flex"}),setTimeout(function(){$(".js-bottom-goto-mdd").css({display:"none"}),t.goToHomeClickStore.get()||t.goToHomeStore.get()||t.goToHomeStore.set(1)},5e3))),$(".js_toGsHome").click(function(){o.toJump({url:["/webapp/you/","/destination/toHome"],targetModel:1})}),$(".js_close_toHome_box").click(function(){$(".js-bottom-goto-mdd").hide(),Lizard.isHybrid||Lizard.isInCtripApp?t.setUserHis("ifToGsHome",{ifToGsHome:0,ifToGsHomeClick:(new Date).getTime()}):t.goToHomeClickStore.set(1)})},getUserHis:function(t,e){(Lizard.isHybrid||Lizard.isInCtripApp)&&s.doBusinessJob({businessCode:801001,data:{type:1,key:e},callback:function(e){t&&t(e)}})},setUserHis:function(t,e){if(Lizard.isHybrid||Lizard.isInCtripApp){var i=-1;s.doBusinessJob({businessCode:801001,data:{type:1,key:t},callback:function(o){
if(0!=i)if(o.param&&o.param.context){var s=o.param.context;"object"!=typeof s&&(s=JSON.parse(s)),0!=s.ifToGsHome&&(!0,s.ifToGsHome=(new Date).getTime()),0!=s.ifToGsHomeClick&&(!0,s.ifToGsHomeClick=(new Date).getTime()),0==s.ifToGsHome&&0==s.ifToGsHomeClick&&(!0,s.ifToGsHome=(new Date).getTime()),i=0,CtripBusiness.app_do_business_job(6,801001,{type:0,key:t,context:s,expiry:518400},"noCallBack")}else i=0,CtripBusiness.app_do_business_job(6,801001,{type:0,key:t,context:e,expiry:518400},"noCallBack")}}),i=1}}}}),define("gsHistory",["cHybridShell","gsAppAgent","gsRouterRedirect"],function(t,e,i){return{showHistory:function(t){t=t||{};var i=this;if(e.isHybrid()&&e.compareAppVersion("6.18")<1&&1===e.compareAppVersion("7.4")&&!($(".history_footprint")&&$(".history_footprint").length>0)){var o="https://pages.c-ctrip.com/you/opt/icon-footprint-b.png";e.compareAppVersion("6.20")<=0?o="https://pages.c-ctrip.com/you/opt/icon-footprint-c.png":e.compareAppVersion("6.18")<0&&(o="https://pages.c-ctrip.com/you/opt/icon-footprint-a.png"),e.compareAppVersion("7.0")<=0?(o="https://pages.c-ctrip.com/you/opt/icon-footprint-d.png",$("body").append('<div id="c_history" class="history_footprint" style="position: fixed;right: 8px;bottom: '+(t.bottom||10)+"px;z-index: "+(t.zindex||6)+";width: 60px;height: 60px;background: url("+o+') no-repeat;background-size: contain;cursor: pointer;""></div>')):$("body").append('<div id="c_history" class="history_footprint" style="position: fixed;right: 8px;bottom: '+(t.bottom||10)+"px;z-index: "+(t.zindex||6)+";width: 50px;height: 50px;background: url("+o+') no-repeat;background-size: contain;cursor: pointer;""></div>'),$("body").delegate(".history_footprint","click",function(t){i.showHistoryMenu(),t.stopPropagation()})}},showHistoryMenu:function(){i.ForwardPage({urls:[Lizard.H5BaseUrl,"ctrip://wireless/destination/showFootPrint"],targetModel:1})},saveHistory:function(t){var i,o;void 0!==t.type&&0==t.type?(i=t.type,o={jumpSchema:t.jumpSchema||"",displayContent:t.displayContent||"",type:0,districtId:t.districtId||0}):void 0!==t.type&&0!=t.type&&(i=t.type,o={jumpSchema:t.jumpSchema||"",displayContent:t.displayContent||"",subTitle:t.subTitle||"",type:i,mapSchema:t.mapSchema||"",districtId:t.districtId||0}),e.isHybrid()&&e.compareAppVersion("6.18")<1&&CtripBusiness.app_do_business_job(6,80012,o,"noCallBack")}}}),define("gsImgUpLoader",[],function(){var t=function(t,e){this.counter=0,this.target="object"==typeof t?t:$(t),this.options={form:$("form")[0],url:"",data:{},type:0,onAbort:null,onError:null,onLoadStart:null,onProgress:null,onLoad:null,onLoadEnd:null,isSecure:!1};for(var i in e)this.options[i]=e[i];window.URL=window.URL||window.webkitURL};return t.prototype={tempFiles:[],upload:function(t,e,i){var o=this.target.get(0).files;o.length>t?e&&e():(this._getFiles(o,i),this._sendFiles())},uploadBase64:function(t,e,i,o){t.length>e?i&&i():this._fileUploadBase64(t)},_getFiles:function(t,e){if(this.tempFiles=[],t)for(var i=/.jpeg|.png|.gif|.jpg/,o=0;o<t.length;o++){var s=t[o];if(s.size>=5242880||s.type&&!s.type.match(i))e&&e();else{var n=window.URL.createObjectURL(s);window.URL.revokeObjectURL(this.src),s.src=n,this.tempFiles.push(s)}}else alert("没选择文件...");return this.tempFiles},_sendFiles:function(){for(var t=0;t<this.tempFiles.length;t++)this._fileUpload(this.tempFiles[t])},_fileUploadBase64:function(t){var e=this,i=new XMLHttpRequest;i.onreadystatechange=function(){1===i.readyState?e.options.onLoadStart&&e.options.onLoadStart.call(e):4===i.readyState&&(clearTimeout(e.timeOut),e.options.onLoad&&e.options.onLoad(null,i.responseText,t[e.counter]),e.counter++,e.counter>=t.length?(e.options.onLoadEnd&&e.options.onLoadEnd(t.length),e.counter=0):e.counter<t.length&&e._fileUploadBase64(t))},this._checkTimeout(i),i.open("POST",e.options.url,!0),i.setRequestHeader("Content-Type","application/json");var o="";return o=e.options.isSecure?JSON.stringify({Param:{PhotoData:t[e.counter],Thumbnail:t[e.counter],UploadTime:new Date,PhotoSize:t[e.counter].size,PublishStatus:6}}):JSON.stringify({Head:e.options.data,Picdata:t[e.counter],TypeID:1,AppID:1,BSync:!1}),i.send(o),e},_checkTimeout:function(t){var e=this;this.timeOut=setTimeout(function(){t&&t.abort(),e.options.onTimeout&&(e.options.onTimeout(e),e._clear())},6e5)},_fileUpload:function(t){var e=this,i=new FileReader,o=new XMLHttpRequest;return o.onreadystatechange=function(){1===o.readyState?e.options.onLoadStart&&e.options.onLoadStart.call(e):4===o.readyState&&(e.counter>=e.tempFiles.length&&(e.options.onLoadEnd&&e.options.onLoadEnd(e.tempFiles.length),e.counter=0),clearTimeout(e.timeOut))},this._checkTimeout(o),o.open("POST",e.options.url,!0),o.setRequestHeader("Content-Type","application/json"),i.readAsDataURL(t),i.onload=function(i){var s=i.target,n=s.result.replace(/^(data:){1}\w+\/{1}\w+(;base64,){1}/,"");n=n.replace("data:base64,","");var a="";a=e.options.isSecure?JSON.stringify({Param:{PhotoData:n,Thumbnail:n,UploadTime:new Date,PhotoSize:t.size,PublishStatus:6}}):JSON.stringify({Head:e.options.data,Picdata:n,TypeID:1,AppID:1,BSync:!1}),o.send(a)},o.timeout=6e5,o.ontimeout=function(t){e.options.onTimeout&&(e.options.onTimeout(e),e._clear())},o.onabort=function(){},o.onerror=function(){},o.onloadstart=function(){},o.onprogress=function(){},o.onload=function(i){var o=i.currentTarget.response;e.options.onLoad&&e.options.onLoad(t,o)},o.onloadend=function(){++e.counter===e.tempFiles.length&&(e.options.onLoadEnd&&e.options.onLoadEnd(e.tempFiles.length),e.counter=0)},e},_clear:function(){this.counter=0}},t}),define("gsRootView",["cPageList","gsAppAgent"],function(t,e){var i=t.extend({isHybrid:function(){return e.isHybrid()}(),isGsHybrid:function(){return e.isGsHybrid()}(),isWeixin:function(){return e.isWeixinBrowser()}(),_getAidAndSid:function(t){void 0===window.__union&&(window.__union=[]),window.__union.push({callback:function(){var e,i=window.localStorage.getItem("UNION");i&&(e=JSON.parse(i).data||{}),t(e)}})},setHeader:function(t){var i=this;t&&t.back?(t.back=$.extend(!0,{},{color:i.isHybrid&&e.compareAppVersion("7.6")<1?"#333333":"",highlightColor:i.isHybrid&&e.compareAppVersion("7.6")<1?"#333333":""},t.back),t.left=[],t.left.push(t.back),delete t.back):t&&t.left&&i.isHybrid&&e.compareAppVersion("7.6")<1&&t.left.map(function(t){return t.color="#333333",t.highlightColor="#333333",t}),t&&t.moreMenus&&t.moreMenus.length>0&&t.right.push({tagname:"more",color:"#333333",highlightColor:"#333333"}),this.header.set($.extend(!0,{},{whiteBackground:!!(i.isHybrid&&e.compareAppVersion("7.6")<1)},t))},onShow:function(){if(-1==location.href.indexOf("gsAwaken=hide")&&!Lizard.isHybrid&&!Lizard.isInCtripApp){var t=$("body").data("pagetag"),i=["travels_detail","asks_detail","ttd_sight_detail","destination_home"],o={travels_detail:"游记",asks_detail:"问答",ttd_sight_detail:"景点",destination_home:"精彩"};t=function(){return[].slice.call($("[data-view-name]")).map(function(t,e){if(t=$(t),"none"!=t.css("display"))return t.attr("data-view-name")}).pop()},$("body").find(".awakening_bar").remove();var s=[{allianceID:803806,sID:1364205},{allianceID:30159,sID:749360},{allianceID:803806,sID:1364205},{allianceID:885562,sID:1455534},{allianceID:879313,sID:1448756},{allianceID:879313,sID:1453259},{allianceID:4897,sID:353693},{allianceID:838439,sID:1403648},{allianceID:878796,sID:1449897},{allianceID:925027,sID:1498399},{allianceID:925029,sID:1498401},{allianceID:281157,sID:1517226},{allianceID:973954,sID:1564766},{allianceID:973954,sID:1564767},{allianceID:1038475,sID:1677392}];this._getAidAndSid(function(n){n=n||{};if(!function(){var t=n.AllianceID,e=n.SID,i=navigator.userAgent.toLowerCase().search(/Baiduspider/gi)>=0;return t&&e&&s.map(function(o,s){o.allianceID==t&&o.sID==e&&(i=!0)}),i}()&&!e.isQuickApp()&&-1!=i.indexOf(t())){var a='<div class="awakening_bar">  <div class="awakening_infor">       <i id="c_closealert" class="common-iconfont close_btn awakening_close">&#xe633;</i>       <i class="icon"></i>       <span class="clue">打开APP查看更多'+o[t()]+'</span>   </div>   <a id="c_openapp" class="awakening_btn" href="#">去看看</a></div>',r="<style>.awakening_bar{z-index:9999;width:100%;height:50px;line-height:50px;background:#E8F2F9;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row}.awakening_bar .awakening_infor{-webkit-box-flex:1;box-flex:1;-webkit-flex:1;flex:1;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row}.awakening_bar .awakening_infor .close_btn{color:#999;font-size:10px;margin:0 10px}.awakening_bar .awakening_infor .icon{width:38px;height:38px;background-image:url(https://pages.c-ctrip.com/you/asks/ic_logo.png);background-size:38px auto;margin:6px 8px 0 0}.awakening_bar .awakening_infor .clue{max-width:210px;margin:6px 0;font-family:PingFangSC-Medium;font-size:16px;color:#242D32;line-height:19px;display:box;display:-webkit-flex;display:flex;box-orient:vertical;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-orient:vertical;display:-webkit-box;-webkit-line-clamp:2;overflow:hidden;word-break:break-all;word-break:break-word}.awakening_bar .awakening_btn{width:66px;height:30px;line-height:30px;font-family:PingFangSC-Medium;font-size:14px;color:#FFF;text-align:center;background:#2094F5;box-shadow:0 2px 8px 0 rgba(32,148,245,.2);border-radius:50px;margin:10px 10px 0 0}</style>"+a;$("#main").prepend(r),$(".awakening_btn").on("click",function(){Lizard._gs_awkeup_()}),$(".awakening_close").on("click",function(){$("body").find(".awakening_bar").remove()})}})}}});return i.prototype._gs_super=function(){var t,e=arguments.callee.caller,i=null,o=this.__proto__;t:for(;null==i&&null!=o;){for(var s=Object.getOwnPropertyNames(o),n=0;n<s.length;n++)if(o[s[n]]===e){i=o,t=s[n];break t}o=o.constructor.__super__}if(o.constructor.__super__[t])return o.constructor.__super__[t].apply(this,arguments)},i}),define("gsTimeEditor",["UISelect"],function(t){$.fn.tiemSpanEditor=function(t,e){o(this,t,e)};var e=!1,o=function(t,o,n){var r=[],c=[{id:1,name:"00"},{id:2,name:"30"}],l=["周一","周二","周三","周四","周五","周六","周日"],d=["09","00","21","00"],h="",p=['<style type = "text/css">.pick_time{position:absolute;bottom:0;background-color:#fff;width:100%;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;box-orient:vertical;-webkit-flex-direction:column;flex-direction:column}.pick_time .config_area{-webkit-box-flex:1;box-flex:1;-webkit-flex:1;flex:1}.pick_time .confirmation{line-height:49px;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row}.pick_time .confirmation>div{-webkit-box-flex:1;box-flex:1;-webkit-flex:1;flex:1;text-align:center;font-size:17px;border-width:0;border-top:1px solid #c8c8c8;-webkit-border-image:url("https://pages.c-ctrip.com/you/common/icon_border_half_lightgray.png") 2 stretch;border-image:url("https://pages.c-ctrip.com/you/common/icon_border_half_lightgray.png") 2 stretch}.pick_time .confirmation>div.active{color:#fff;background-color:#0196ff}.pick_time .title{font-size:19px;color:#222;line-height:27px;padding:20px 16px}.pick_time .week_days{margin-top:-4px;margin-bottom:-4px;padding-left:12px;padding-right:12px;font-size:0}.pick_time .week_days .day_item{display:inline-block;padding:4px;width:25%;line-height:36px;text-align:center;font-size:14px;color:#222;-webkit-box-sizing:border-box;box-sizing:border-box}.pick_time .week_days .day_item>span{display:block;position:relative;border-radius:2px}.pick_time .week_days .day_item>span:after{position:absolute;left:0;top:0;z-index:0;width:200%;height:200%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(0.5,0.5);transform:scale(0.5,0.5);pointer-events:none;content:""}.pick_time .week_days .day_item>span:after{border:1px solid #e0e0e0;border-radius:4px}.pick_time .week_days .day_item.active{position:relative;color:#0099f7}.pick_time .week_days .day_item.active:before{content:"";position:absolute;top:4px;left:4px;display:block;width:14px;height:14px;background-image:url("https://pages.c-ctrip.com/you/add_merchant/icon_merchant_7-7.png");background-size:20px auto;background-repeat:no-repeat;background-position-y:-66px}.pick_time .week_days .day_item.active>span:before{position:absolute;top:0;left:0}.pick_time .week_days .day_item.active>span:after{border-color:#0099f7}.pick_time .time_gap_wrap{position:relative}.pick_time .time_gap_wrap:after{content:"";display:block;position:absolute;top:56px;height:68px;width:200%;border-top:1px solid #a3a8ab;border-bottom:1px solid #a3a8ab;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(0.5,0.5);transform:scale(0.5,0.5)}.pick_time .time_gap{padding-left:45px;padding-right:45px;padding-bottom:28px;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-sizing:border-box;box-sizing:border-box}.pick_time .time_gap:before,.pick_time .time_gap:after{content:" ";display:table}.pick_time .time_gap:after{clear:both}.pick_time .time_gap>div{float:left;-webkit-box-flex:1;box-flex:1;-webkit-flex:1;flex:1;text-align:center}.pick_time .time_gap .splitter{font-size:25px;-webkit-align-self:center;align-self:center}.pick_time .time_gap .from_to{-webkit-box-flex:2;box-flex:2;-webkit-flex:2;flex:2;align-self:center}.pick_time .time_gap .from_to:after{content:"";display:block;width:15px;margin:0 auto;border-bottom:1px solid #222}.pick_time .time_gap .cui-roller{width:100%;overflow:hidden;position:relative}.pick_time .time_gap .cui-roller .ul-list{height:100%;text-align:center;z-index:2}.pick_time .time_gap .cui-roller .ul-list li{height:28px;line-height:28px;font-size:20px;color:#666}.pick_time .time_gap .cui-roller .ul-list li.current{height:35px;line-height:35px;font-size:25px;color:#222}.pick_time .time_gap .cui-roller .cui-lines{display:none}</style>','<div class="pick_time">','<div class="config_area">','<div class="title">选择营业时间</div>','<div class="week_days"></div>','<div class="title">选择营业时间</div>','<div class="time_gap_wrap">','<div class="time_gap">','<div class="time_element js_start_hour"></div>','<div class="splitter">:</div>','<div class="time_element js_start_minute"></div>','<div class="from_to"></div>','<div class="time_element js_close_hour"></div>','<div class="splitter">:</div>','<div class="time_element js_close_minute"></div>',"</div>","</div>","<div>",'<div class="confirmation">','<div class="option js_cancel">取消</div>','<div class="option js_confirm active">确定</div>',"</div>","</div>"].join("\n");if(e)$(t).show();else{for($(t).show().html(p),i=1;i<25;i++){var u={id:i,name:i<10?"0"+i:i.toString()};r.push(u)}l.forEach(function(t){$(".week_days").append('<div class="day_item active"><span>'+t+"</span></div>")}),$(".day_item").click(function(t){$(t.currentTarget).toggleClass("active")}),s(r,c,d),$(".js_cancel").click(function(){$(t).hide()}),$(".js_confirm").click(function(){$(this).addClass("active").siblings().removeClass("active"),h=a(),""==h?$(t).hide():(h=h+d[0]+":"+d[1]+"-"+d[2]+":"+d[3],o.push(h),$(t).hide(),n&&n(o))}),e=!0}},s=function(e,i,o){this.startHourSet||(this.startHourSet=new t({datamodel:{data:e,id:9},displayNum:5,changed:function(t){o[0]=t.name},wrapper:this.$(".js_start_hour")})),this.startMinuteSet||(this.startMinuteSet=new t({datamodel:{data:i},displayNum:5,changed:function(t){o[1]=t.name},wrapper:this.$(".js_start_minute")})),this.closeHourSet||(this.closeHourSet=new t({datamodel:{data:e,id:21},displayNum:5,changed:function(t){o[2]=t.name},wrapper:this.$(".js_close_hour")})),this.closeMinuteSet||(this.closeMinuteSet=new t({datamodel:{data:i},displayNum:5,changed:function(t){o[3]=t.name},wrapper:this.$(".js_close_minute")})),this.startHourSet.show(),this.startMinuteSet.show(),this.closeHourSet.show(),this.closeMinuteSet.show()},n=function(t,e,o){var s,n=0;for(o[0]=[],o[1]=[],i=0;i<t.length;i++)t[i]==s||t[i+1]==t[i]+1?(o[n].push(t[i]),t[i+1]!==t[i]+1&&(n=1)):e.push(t[i]),s=t[i]+1},a=function(){var t=[],e=[],i=[],o=[],s=[],a=[],r="",c="";return $(".day_item").each(function(i){$(this).hasClass("active")&&(t.push({key:i,value:$(this)}),e.push(i))}),n(e,o,i),i.concat([]).forEach(function(e,n){var a=!1;e.length<3?(o=o.concat(e),i.splice(n,1),o.sort()):(e.forEach(function(e,i){s=t.filter(function(t){return t.key==e}),a||(r=r+s[0].value.text()+"至",a=!0)}),r=r+s[0].value.text()+" ")}),o.forEach(function(e,i){a=t.filter(function(t){return t.key==e}),0!==i?c=c+"、"+a[0].value.text():c+=a[0].value.text()}),c=""!==c?c+" "+r:r};timeSet=function(t){return t}}),define("gsRealName",["gsAppAgent","gsRouterRedirect","gsBusinessJob"],function(t,e,i){return{checkRealName:function(o){t.isHybrid()?i.doBusinessJob({port:1,businessCode:"checkRealName",data:{},callback:function(t){0==t.param.statusCode?o.successCallback():o.failCallback()}}):CRealName.realNameBiz.hasRealName(function(t){0==t.returncode&&t.isRealName?o.successCallback():o.flag&&failCallback?o.failCallback():e.toJump({url:[CRealName.domainUtil.getRealNameUrl()+"?from="+o.from+"&backurl="+o.from],targetModel:2})})},goToRealNamePage:function(i){t.isHybrid()||e.toJump({url:[CRealName.domainUtil.getRealNameUrl()+"?from="+i.from+"&backurl="+i.from],targetModel:2})}}}),define("gsExtendImgUploader",["gsImgUpLoader","UIScroll","gsAppAgent","cGuiderService"],function(t,e,i,o){var s=function(t){this.options={},this.options.currentPage=t.currentPage||"",this.options.title=t.title||"",this.options.content=t.content||"",this.options.apiUrl=t.apiUrl||Lizard.restfullApiHttps+"11270/LPPhotoUpload",this.options.isSecure=t.isSecure||!1,this.options.imgMaxNum=t.imgMaxNum||5,this.init.apply(this)};s.prototype={init:function(){this.initResource(),this.addCssStyle(),this.addTmp(),this.bindEvent(),this.initEasyUpload()},initResource:function(){this.$tmp=$(this.htmlStr),this.$css=$(this.cssStr),this.$upload_photo=this.options.currentPage.$(".upload_photo"),this.$appue_max_photo=this.options.currentPage.$(".appue_max_photo")},bindEvent:function(){var t=this.options.currentPage,e=this;t.$(".js_img_upload").off("change").on("change",function(){e.imgUpLoad()}),t.$(".js_upload").off("click").on("click",function(){e.onImgUpLoadBase64()}),$("body").undelegate().delegate(".max_photo","click",function(t){var i=$(t.currentTarget),o=null;o=i.find("img").clone(),o.data("index",e.$upload_photo.find("li").index(i)),e.showWebMaxPhoto(o)}),t.$(".max_photo_close").off("click").on("click",function(){e.$appue_max_photo.hide(),(Lizard.isHybrid||Lizard.isInCtripApp)&&CtripBar.app_set_navbar_hidden(!1)}),t.$(".max_photo_delete").off("click").on("click",function(){var t=e.$appue_max_photo.find("img").data("index");e.$upload_photo.find("li").eq(t).remove(),e.updateImgUploadState(),e.$appue_max_photo.hide(),0==e.getImgSize()&&(e.$upload_photo.find(".text").show(),e.$upload_photo.find("ul").hide()),(Lizard.isHybrid||Lizard.isInCtripApp)&&CtripBar.app_set_navbar_hidden(!1)})},addCssStyle:function(){this.$upload_photo.before(this.$css)},addTmp:function(){this.$upload_photo.html(this.$tmp),i.isAndroid()&&this.$upload_photo.find(".camera").addClass("js_upload"),this.options.title.length>0&&this.$upload_photo.find(".extend_image_upload_title").show().html(this.options.title),this.options.content.length>0&&this.$upload_photo.find(".extend_image_upload_content").show().html(this.options.content),this.$max_photo=$(this.htmlMaxPhoto),this.options.currentPage.$el.append(this.$max_photo),this.initResource()},initScroll:function(){this.scroll=null,this.scroll=new e({scrollType:"x",scrollbars:!1,wrapper:this.options.currentPage.$(".hot-scenic"),scroller:this.options.currentPage.$(".hot-scenic ul")})},showWebMaxPhoto:function(t){var e=this;e.$appue_max_photo.find("li").html(t),e.$appue_max_photo.show(),(Lizard.isHybrid||Lizard.isInCtripApp)&&CtripBar.app_set_navbar_hidden(!0)},updateScrollWidth:function(){var t=parseInt(this.options.currentPage.$(".hot-scenic ul li img").eq(0).width())+10,e=this.options.currentPage.$(".hot-scenic ul li").length;this.options.currentPage.$(".hot-scenic ul").width(t*e)},getImgSize:function(){return parseInt(this.$upload_photo.find("ul li").length||0)},initEasyUpload:function(){var e=this;"undefined"==typeof FileReader?(Lizard.showToast("抱歉，当前设备不支持图片上传"),this.options.currentPage.$upload_photo.hide()):(e.easyUpload=null,e.easyUpload=new t(".js_img_upload",{form:e.$upload_photo.find("#uploadForm"),url:this.options.apiUrl,isSecure:this.options.isSecure,data:function(){return{syscode:"09",lang:"01",cver:"1.0"}}(),type:1,onAbort:function(){Lizard.hideLoading()},onError:function(){Lizard.hideLoading()},onTimeout:function(t){Lizard.showToast("请求失败，请重试"),Lizard.hideLoading()},onLoadStart:function(){Lizard.showLoading()},onProgress:function(){},onLoad:function(t,i,o){var s=$.parseJSON(i);if("Success"==s.ResponseStatus.Ack){var n=document.createElement("li"),a=document.createElement("img");n.className="max_photo",null!==t&&null!==t.src?(a.src=t.src,a.setAttribute("data-id",s.result),n.appendChild(a),n.setAttribute("data-id",s.result),e.$upload_photo.find("ul").append(n)):null!==o&&(a.src="data:image/png;base64,"+o,a.setAttribute("data-id",s.result),n.appendChild(a),n.setAttribute("data-id",s.result),e.$upload_photo.find("ul").append(n))}else Lizard.showToast("请求失败，请重试")},onLoadEnd:function(){e.updateScrollWidth(),e.initScroll(),e.getImgSize()>0?(e.$upload_photo.find(".text").hide(),e.$upload_photo.find("ul").show()):(e.$upload_photo.find(".text").show(),e.$upload_photo.find("ul").hide()),Lizard.hideLoading(),e.updateImgUploadState()}}))},updateImgUploadState:function(){var t=this;t.getImgSize()>=t.options.imgMaxNum?t.$upload_photo.find(".camera_wrap ").hide():t.$upload_photo.find(".camera_wrap ").show(),t.getImageId()},getImageId:function(){var t=[];return this.$upload_photo.find("li").each(function(){t.push($(this).data("id"))}),t},imgUpLoad:function(t){var e=this,i=this.options.imgMaxNum,o=this.getImgSize(),s=i-o;e.easyUpload.upload(s,function(){Lizard.showToast("你最多可以传"+i+"张图片",2e3)},function(){Lizard.showToast("当前上传图片格式不正确",2e3)})},onImgUpLoadBase64:function(){var t=this,e=function(e){var i=e.photoList;if(i.length)return t.easyUpload.uploadBase64(i),!0};o.choose_photo({maxFileSize:parseInt(1024*t.options.imgMaxNum),maxPhotoCount:t.options.imgMaxNum,callback:e})}};var n=function(){return/isiphonex/.test(navigator.userAgent.toLowerCase())?"extend_img_app_x":""}();return s.prototype.htmlStr=['<form class="upload_form" id="uploadForm" enctype="multipart/form-data" method="post">','<div class="comment_container">','<div class="upload_photos">','<div class="camera_wrap ">','<div class="camera">','<input class="js_img_upload photo_tips nofastclick" accept="image/*" type="file" style="opacity:0" multiple="multiple" />',"</div>","</div>",'<div class="hot-scenic">','<ul style="display:;width:1200px;"></ul>',"</div>","</div>","</div>","</form>",'<div class="text" style="display:;">','<h3 class="extend_image_upload_title" style="display: none;"></h3>','<p  class="extend_image_upload_content" style="display: none;"></p>',"</div>"].join("\n"),s.prototype.htmlMaxPhoto=['<section class="appue_max_photo '+n+'" style="display:none ;"> ','<div class="max_photo_close this_return"></div> ','<div class="max_photo_delete dump"></div> ','<ul class="max_photo_img this_img"><li></li></ul> ',"</section> "].join("\n"),s.prototype.cssStr='<style>.upload_photo{background:#fff;padding:16px 0;position:relative;margin-left:15px;border-width:0;border-bottom:1px solid #c8c8c8;-webkit-border-image:url("https://pages.c-ctrip.com/you/common/icon_border_half_lightgray.png") 2 stretch;border-image:url("https://pages.c-ctrip.com/you/common/icon_border_half_lightgray.png") 2 stretch}.upload_photo .upload_photos{display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row}.upload_photo .camera{position:relative;width:70px;height:70px;margin-right:8px;background:url("https://pages.c-ctrip.com/you/add_merchant/camera.png") no-repeat;background-size:70px 70px}.upload_photo .hot-scenic{-webkit-box-flex:1;box-flex:1;-webkit-flex:1;flex:1;overflow:hidden;position:relative;width:100%;height:70px;background:#fff}.upload_photo .hot-scenic:before,.upload_photo .hot-scenic:after{content:" ";display:table}.upload_photo .hot-scenic:after{clear:both}.upload_photo .hot-scenic ul{position:absolute;left:0;top:0;height:auto;display:box;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;box-orient:horizontal;-webkit-flex-direction:row;flex-direction:row}.upload_photo .hot-scenic ul li{width:70px;height:auto;display:block;margin-left:10px}.upload_photo .hot-scenic ul li:first-child{margin-left:0}.upload_photo .hot-scenic ul li img{width:70px;height:70px;background:#e9e9e9 url("https://pages.c-ctrip.com/you/component-local/default130.png") no-repeat 50% 50%;background-size:48px 48px}.upload_photo .hot-scenic ul li span{color:#999;font-size:12px}.upload_photo .text{display:inline-block;position:absolute;top:32px;left:86px}.upload_photo .text h3{font-size:15px;line-height:21px;color:#666}.upload_photo .text p{color:#b5b7b8;font-size:12px}.upload_photo .photo_tips{width:70px;height:70px}.upload_photo ul:before,.upload_photo ul:after{content:" ";display:table}.upload_photo ul:after{clear:both}.upload_photo ul li{float:left;display:block;margin-left:8px}.upload_photo ul li.upload_photo{border-bottom-width:0;padding:0}.upload_photo ul img{width:50px;height:50px}.appue_max_photo{position:fixed;left:0;top:0;z-index:999999999;width:100%;height:100%;background:#000}.appue_max_photo .this_return{width:44px;height:44px;position:absolute;left:0;top:0;z-index:3}.appue_max_photo .this_return:before,.appue_max_photo .this_return:after{display:block;content:"";width:12px;height:2px;background:#fff;position:absolute;left:15px}.appue_max_photo .this_return:before{top:18px;-webkit-transform:rotate(-45deg)}.appue_max_photo .this_return:after{top:26px;-webkit-transform:rotate(45deg)}.appue_max_photo .dump{position:absolute;height:44px;width:44px;right:0;z-index:3}.appue_max_photo .dump:before{content:"";display:block;background:url("https://pages.c-ctrip.com/you/component-local/detel.png") no-repeat;background-size:30px 30px;width:30px;height:30px;position:absolute;margin-top:-15px;margin-left:-15px;top:50%;left:50%}.appue_max_photo .this_img{position:absolute;left:0;top:0;right:0;height:100%;font-size:0;padding:0;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center}.appue_max_photo .this_img li{display:block;text-align:center;position:relative}.appue_max_photo .this_img li:before{display:inline-block;content:"";width:0;height:100%;vertical-align:middle}.appue_max_photo .this_img li img{max-width:100%;max-height:100%;vertical-align:middle}.appue_max_photo.extend_img_app_x .this_return {top: 44px;}.appue_max_photo.extend_img_app_x .dump {top: 44px;}</style>',s}),define("gsVideo",["gsAppAgent","gsRouterRedirect"],function(t,e){var i,o='<div class="vr_player"><video preload="none" class="vr"></video><div class="modal"></div><div style="display:none" class="loading"><div class="icon icon_loading"></div></div><div class="controller play"></div><div class="ctrl_bar"><div class="btn_action play"></div><div style="display:none" class="btn_action stop"></div><div class="progress"><div class="total"></div><div class="watched" style="width:0;"></div><div class="drag_ball" style="left:0;"></div></div><div class="time"><span class="current_time">00:00</span>/<span class="total_time">00:00</span></div><div class="full_screen full"></div><div style="display:none" class="full_screen regular"></div></div></div>';$.fn.videoinit=function(e){var n=this,a=function(){t.isHybrid()?$(n).html(o):t.isApple()?$(n).html('<div class="vr_player"><video preload="none" controls  webkit-playsinline="webkit-playsinline" class="vr"></video></div>'):$(n).html(o),c(),l(),i=e,$(n).find("video").attr("src",e.url),$(n).find("video").attr("poster",e.poster),e.preload&&$(n).find("video").attr("preload","auto"),e.autoplay&&s($(n).find("video"))};e.skin||(e.skin="default"),0!=$("link[data-name='media']").length?a():h(Lizard.webresourceBaseUrl+"build/media/"+e.skin+".css",a)};var s=function(e){if(t.isHybrid())return void window.CtripUtil.app_open_url("ctrip://wireless/destination/toNormalVideo?url="+encodeURIComponent(e.attr("src")),1);0!=$("video[data-state='play']").length&&($("video[data-state='play']")[0].pause(),$("video[data-state='play']").parents(".vr_player").find(".controller.play").show(),$("video[data-state='play']").parents(".vr_player").find(".btn_action.stop").hide(),$("video[data-state='play']").parents(".vr_player").find(".btn_action.play").show(),$("video[data-state='play']").parents(".vr_player").find(".ctrl_bar").removeClass("active"),$("video[data-state='play']").data("state","pause")),e.parents(".vr_player").find(".controller.play").hide(),e.parents(".vr_player").find(".btn_action.play").hide(),e.parents(".vr_player").find(".btn_action.stop").show(),e.parents(".vr_player").find(".loading").show(),e.parents(".vr_player").find(".ctrl_bar").addClass("active"),e.data("state","play"),e[0].play()},n=function(t){t.parents(".vr_player").find(".controller.play").show(),t.parents(".vr_player").find(".btn_action.stop").hide(),t.parents(".vr_player").find(".btn_action.play").show(),t.parents(".vr_player").hasClass("fullscreen_mode")||t.parents(".vr_player").find(".ctrl_bar").removeClass("active"),t.data("state","pause"),t[0].pause()},a=function(t){t.parents(".vr_player").find(".full_screen").hide(),t.parents(".vr_player").find(".full_screen.regular").show(),t.parents(".vr_player").addClass("fullscreen_mode"),t[0].requestFullscreen?t[0].requestFullscreen():t[0].webkitRequestFullscreen?t[0].webkitRequestFullScreen():t[0].webkitEnterFullscreen&&t[0].webkitEnterFullscreen()},r=function(t){t.parents(".vr_player").find(".full_screen.regular").hide(),t.parents(".vr_player").find(".full_screen.full").show(),t.parents(".vr_player").removeClass("fullscreen_mode"),document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitExitFullScreen&&document.webkitExitFullScreen(),"pause"!=t.data("state")&&"end"!=t.data("state")||t.find(".ctrl_bar").removeClass("active")},c=function(){!t.isHybrid()&&t.isApple()||($("video").bind("ended",function(){$(this).data("state","end"),$(this).parents(".vr_player").find(".controller.play").show(),$(this).parents(".vr_player").find(".btn_action.stop").hide(),$(this).parents(".vr_player").find(".btn_action.play").show(),$(this).parents(".vr_player").hasClass("fullscreen_mode")||$(this).parents(".vr_player").find(".ctrl_bar").removeClass("active")}),$("video").bind("canplay",function(){$(this).parents(".vr_player").find(".loading").hide()}),$("video").bind("canplaythrough",function(){$(this).parents(".vr_player").find(".loading").hide()}),$("video").bind("play",function(){$(this).parents(".vr_player").find(".loading").hide()}),$("video").bind("playing",function(){$(this).parents(".vr_player").find(".loading").hide()}),$("video").bind("pause",function(){$(this).parents(".vr_player").find(".controller.play").show(),$(this).parents(".vr_player").find(".btn_action.stop").hide(),$(this).parents(".vr_player").find(".btn_action.play").show(),$(this).parents(".vr_player").hasClass("fullscreen_mode")||$(this).parents(".vr_player").find(".ctrl_bar").removeClass("active"),$(this).data("state","pause")}),$("video").bind("waiting",function(){$(this).parents(".vr_player").find(".loading").show()}),
$("video").bind("durationchange",function(){$(this).parents(".vr_player").find(".total_time").text(d(this.duration))}),$("video").bind("timeupdate",function(){$(this).parents(".vr_player").find(".current_time").text(d(this.currentTime));var t=this.currentTime/this.duration*100+"%";$(this).parents(".vr_player").find(".watched").css("width",t),$(this).parents(".vr_player").find(".drag_ball").css("left",t)}),document.addEventListener("fullscreenchange",function(t){250==$(t.target).offset().height&&($(t.target).parents(".vr_player").find(".full_screen.regular").hide(),$(t.target).parents(".vr_player").find(".full_screen.full").show(),$(t.target).parents(".vr_player").removeClass("fullscreen_mode"),"pause"!=$(t.target).data("state")&&"end"!=$(t.target).data("state")||$(t.target).parents(".vr_player").find(".ctrl_bar").removeClass("active"))}),document.addEventListener("webkitfullscreenchange",function(t){250==$(t.target).offset().height&&($(t.target).parents(".vr_player").find(".full_screen.regular").hide(),$(t.target).parents(".vr_player").find(".full_screen.full").show(),$(t.target).parents(".vr_player").removeClass("fullscreen_mode"),"pause"!=$(t.target).data("state")&&"end"!=$(t.target).data("state")||$(t.target).parents(".vr_player").find(".ctrl_bar").removeClass("active"))})),$("video").bind("abort",function(){$(this).attr("src",i.reserveUrl)})},l=function(){!t.isHybrid()&&t.isApple()||($(".vr_player .btn_action.play").off().on("click",function(){var t=$(this).parents(".vr_player").find("video");s(t)}),$(".vr_player .btn_action.stop").off().on("click",function(){var t=$(this).parents(".vr_player").find("video");n(t)}),$(".vr_player .full_screen.full").off().on("click",function(){var t=$(this).parents(".vr_player").find("video");a(t)}),$(".vr_player .full_screen.regular").off().on("click",function(){var t=$(this).parents(".vr_player").find("video");r(t)}),$(".vr_player .controller.play").off().on("click",function(){var t=$(this).parents(".vr_player").find("video");s(t)}))},d=function(t){var e=parseInt(t)||0,i=0;return e>60&&(i=parseInt(e/60),e=parseInt(e%60)),e.toString().length<2&&(e="0"+e),i.toString().length<2&&(i="0"+i),i+":"+e},h=function(t,e){function i(t,e){var o=!1;if(/webkit/i.test(navigator.userAgent))t.sheet&&(o=!0);else if(t.sheet)try{t.sheet.cssRules&&(o=!0)}catch(t){1e3===t.code&&(o=!0)}o?setTimeout(function(){e()},1):setTimeout(function(){i(t,e)},10)}var o=document.createElement("link");o.rel="stylesheet",o.href=t,o.dataset.name="media",document.head.appendChild(o),o.attachEvent?o.attachEvent("onload",function(){e()}):setTimeout(function(){i(o,e)},0),o.onLoad=function(){e()}}});