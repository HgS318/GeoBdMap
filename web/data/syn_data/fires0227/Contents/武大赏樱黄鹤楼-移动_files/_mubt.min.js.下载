/**
 * Copyright(C) 2008 - 2019, Ctrip.com All rights reserved. 
 * Date: 2019/02/27
 */
!function(){"use strict";var t=window;if(!t.JSON||!t.JSON.parse||!t.JSON.stringify||"undefined"==typeof localStorage||t.$_bf&&!0===t.$_bf.loaded)return;var d="charCodeAt";function e(t,e){var r,n,i,a,o,s,c,u;for(r=3&t.length,n=t.length-r,i=e||31,o=3432918353,s=461845907,u=0;u<n;)c=255&t[d](u)|(255&t[d](++u))<<8|(255&t[d](++u))<<16|(255&t[d](++u))<<24,++u,i=27492+(65535&(a=5*(65535&(i=(i^=c=(65535&(c=(c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(c=0,r){case 3:c^=(255&t[d](u+2))<<16;case 2:c^=(255&t[d](u+1))<<8;case 1:i^=c=(65535&(c=(c=(65535&(c^=255&t[d](u)))*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}function c(t,e){var r=65535&t,n=65535&e;return(((t>>16&65535)*n+r*(e>>16&65535)&65535)<<16>>>0)+r*n}function s(t){var e,r,n=t.length,i=n%4,a=n-i,o=1540483477;e=0^n;for(var s=0;s<a;)r=t[d](s++),r|=t[d](s++)<<8,r|=t[d](s++)<<16,r=c(r=((r=c(r|=t[d](s++)<<24,o))^r>>>24)>>>0,o),e=((e=c(e,o))^r)>>>0;switch(i){case 3:e=(e^t[d](s+2)<<16)>>>0;case 2:e=(e^t[d](s+1)<<8)>>>0;case 1:e=c(e^=t[d](s),o)}return e=((e=c(e=(e^e>>>13)>>>0,o))^e>>>15)>>>0}var h=window,v=h.document,f=h.navigator,n=f.userAgent,u=v.location,l="performance",r=-1!=n.indexOf("CtripWireless");function p(t){return v.getElementById(t)}function g(t){var e=p(t);return e&&e.value||""}function m(){return f.language||f.userLanguage||f.browserLanguage||""}function i(){return(new Date).getTimezoneOffset()}function a(){var t=h.screen||{},e="";return t&&(e+=t.width+"x"+t.height+"|"+t.colorDepth,t.deviceYDPI&&(e+="|DPI"+t.deviceXDPI+"x"+t.deviceYDPI)),{w:t.width||0,h:t.height||0,c:t.colorDepth,fp:e}}function o(){var t=v.createElement("canvas");if(void 0===t.getContext)return"";t.width=600,t.height=30,t.style.border="1px solid #3a3a3a";var e=t.getContext("2d"),r=e.createLinearGradient(0,0,200,0);return r.addColorStop(0,"rgb(200,0,0)"),r.addColorStop(.5,"rgb(0,200,0)"),r.addColorStop(1,"rgb(200,0,0)"),e.fillStyle=r,e.fillRect(0,0,200,30),e.fillStyle="#360",e.font="13px _sans",e.textBaseLine="top",e.fillText("English中文Հայերենا繁體輸入لعربيةҚазақша`~1!2@3#4$5%6^7&8*9(0)-_=+[{]}|;:',<.>/?",5,18),e.beginPath(),e.strokeStyle="blue",e.lineWidth=5,e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowColor="rgb(85,85,85)",e.shadowBlur=3,e.arc(500,15,10,0,2*Math.PI,!0),e.stroke(),e.closePath(),t.toDataURL()+function(){var t=v.createElement("canvas");{if(void 0===t.getContext)return"";var e=null,r=["webgl","experimental-webgl","moz-webgl","webkit-3d"];try{for(var n=0;n<r.length&&null===e&&!(e=t.getContext(r[n],{width:600,height:300}));n++);return e.getParameter(e.RENDERER)+","+e.getParameter(e.VERSION)}catch(t){}}return""}()}var _="4.0.1",y=+new Date,b=function(){},S=Object.prototype.toString,k=Object.prototype.hasOwnProperty;function T(t){return!isNaN(parseFloat(t))}function I(t){return"string"==typeof t}function E(t){return"[object Function]"==S.call(t)}function w(t){return"[object Array]"==S.call(t)}function C(t){return"[object Object]"==S.call(t)}function N(t){var e=parseFloat(t);return isNaN(e)?0:e}function O(t){if(Object.keys)return Object.keys(t);var e=[];for(var r in t)t.hasOwnProperty(r)&&e.push(r);return e}function A(){return(new Date).getTime()}function P(t){var e=typeof t;return t&&(I(e)||"number"==e||"boolean"==e)}function R(t){return encodeURIComponent(t||"")}function x(t){return decodeURIComponent(t||"")}function D(){var t,e,r,n=arguments[0]||{},i=1,a=arguments.length;for(a===i&&(n=this,--i);i<a;i++)if(null!=(r=arguments[i]))for(e in r)if(k.call(r,e)){if(n===(t=r[e]))continue;void 0!==t&&(n[e]=t)}return n}var L=/d{1,4}|m{1,2}|yy(?:yy)?/g;function U(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}var j=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,B=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"];function M(t){if("string"!=typeof t)return"";for(var e=j.exec(t),r={},n=14;n--;)e[n]&&(r[B[n]]=e[n]);return r}function F(t){var e,r={},n=t.split("&");if(n&&n.length)for(var i=0,a=n.length;i<a;i++)1<(e=n[i].split("=")).length&&(r[e[0]]=e[1]);return r}function H(t){try{return JSON.parse(t)}catch(t){}}var Y=[];function J(t){Y[t]=!0}function z(t,e,r){var n=new RegExp("(^| )"+t+"=([^;]*)(;|$)"),i=v.cookie.match(n);return i&&1<i.length?r?x(i[2]):i[2]:e||""}var X=function(){if(h.Storage&&h.localStorage){try{localStorage.setItem("__store__test","1"),localStorage.getItem("__store__test"),localStorage.removeItem("__store__test")}catch(t){return J(19),!1}return!0}return J(18),!1}();function V(t){return X&&localStorage.getItem(t)||""}function q(t,e){return!!X&&(localStorage.setItem(t,e),!0)}var G,W,K,Q,Z,tt="https:"!=u.protocol&&"http:"!=u.protocol,et=u.hostname,rt=""!=V("isPreProduction"),nt={fp:(K=[],K.push(e((G=[],W=a(),h.maxConnectionsPerServer&&G.push("maxcon"+(window.maxConnectionsPerServer||"0")),f.hardwareConcurrency&&G.push("hdcon"+f.hardwareConcurrency),G.push("zone"+i()),G.push(W.fp),G.join(""))).toString(36)),K.push(e(function(){var t=[];if(f.mimeTypes){for(var e=f.mimeTypes,r=e.length||0,n="",i=0;i<r;i++){var a=e[i];n+=a.type+a.suffixes+a.description}t.push(n)}if(f.plugins){for(var o=f.plugins,s="pls",c=0;c<o.length;c++){var u=o[c];if(s+=u.filename||u.name||c,30<c)break}t.push(s)}return t.push(f.userAgent),t.push(m()),t.push(f.doNotTrack||"0"),t.push(f.platform||"None"),t.join("")}()).toString(36)),K.push(e(o()).toString(36)),K.join("-")),domain:function(){var t,e,r="_bfp=cookie",n=u.hostname.split(".");for(t=n.length-1;0<=t;t--)if(e="."+n.slice(t).join("."),v.cookie=r+";domain="+e+";",-1<v.cookie.indexOf(r))return v.cookie=r.split("=")[0]+"=;domain="+e+";expires=Thu, 01 Jan 1970 00:00:01 GMT;",e}(),env:r||tt?"hybrid":"h5",protocol:tt?"https:":"",surl:rt||/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i.test(et)||"127.0.0.1"==et?"//s.uat.qa.nt.ctripcorp.com/bf.gif":"//s.c-ctrip.com/bf.gif",delay:0,debug:!1,rms:!0,markting:!0,promiseCatch:!1,isfile:tt,tcp:0,readyWait:61,appid:"",clientid:""};try{var it=(Q="",Z=new RegExp("[?&]"+"_cwxobj"+"=([^&]+)"),h.location.search.replace(Z,function(t,e){return Q=e,t}),decodeURIComponent(Q));it&&(it=JSON.parse(it),q("CTRIP_UBT_INFO",JSON.stringify({appid:it.appid,cid:it.cid})))}catch(t){}try{var at=V("CTRIP_UBT_INFO");at&&(at=JSON.parse(at)||{},nt.appid=at.appid||"",nt.clientid=at.cid||"")}catch(t){}for(var ot=16384,st=3,ct=130,ut=1023,dt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",ft=[],lt=0;lt<64;lt++)ft[dt.charCodeAt(lt)]=lt;function pt(t){if(!t)return"";for(var e=[],r=0,n=(t=unescape(encodeURIComponent(t))).length;r<n;r++)e[r]=t.charCodeAt(r);return function(s){var c=[],u=[],d=-1,f=0,l=0,r=0,n=0,e=[];_(19);for(var p=0;p<s.length&&l<s.length;p+=ot)0<p&&(u=u.slice(ot)),t();return-1!=d&&m(),2==n?(i(r<<4&63),65==dt.length&&(i(64),i(64))):4==n&&(i(r<<2&63),65==dt.length&&i(64)),e.join("");function t(){for(var t=g(p+2*ot,s.length),e=g(t,s.length-st+1);l<t;l++){var r=0,n=0;if(l<e){var i=h();if(f<=l)for(var a=c[i]-1;r!=ct&&0<=a&&l-ot<=a;){var o=v(a);st<=o&&r<o&&(n=l-a-(r=o)),a=u[a-p]}u[l-p]=c[i]-1,c[i]=l+1}if(st<=r){for(f=l+r,-1!=d&&(m(),d=-1),_(r-st);127<n;)_(255&(127&n|128)),n>>=7;_(n)}else f<=l&&-1==d&&(d=l)}}function g(t,e){return Math.min(t,e)}function h(){for(var t=0,e=l;e<l+st;e++)t*=16777619,t^=s[e];return t&ut}function v(t){var e,r,n=g(t+ct,l);for(e=t,r=l;e<n&&r<s.length&&s[e]==s[r];e++,r++);return e-t}function m(){for(var t=d;t<l;t+=127){var e=g(127,l-t);_(255&-e);for(var r=t;r<l&&r<t+e;r++)_(s[r])}}function _(t){var e=r<<6-n;i(63&(e|=(r=255&t)>>(n+=2))),6<=n&&i(63&(e=r>>(n-=6)))}function i(t){e.push(dt.charAt(t))}}(e)}function gt(t,e){var r=new Image;r.width=r.height=1,r.onload=r.onerror=function(){r.onload=r.onerror=null,e(1)},r.onerror=function(){r.onload=r.onerror=null,e(0,{status:4,message:"UNKNOWN"})},r.src="https:"+nt.surl+"?"+t+"&_mt="+A().toString(36)+(1*(""+Math.random()).slice(-8)).toString(32)+("miniprogram"==h.__wxjs_environment?"&ure=wx_mini_webview":void 0!==h.my&&-1<n.indexOf("AlipayClient")?"&ure=my_mini_webview":"")}function ht(t){var e=E(t.f)?t.f:b;nt.debug;try{(nt.tcp||r)&&"undefined"!=typeof CtripBusiness&&E(CtripBusiness.app_track_UBT_JS_log)?function(t,e){t.c[9]=n;var r={c:t.c,dataType:t.t,priority:t.p||6};switch(t.t){case"uinfo":case"error":case"ub":case"ps":case"t":case"pr_t":case"useraction":case"matrix":r.d=t.d;break;default:return}r.d?(CtripBusiness.app_track_UBT_JS_log("ubt_js_sdk",r),e(1)):e(0,{status:1,message:"Invalid data"})}(t,e):function(t,e){var r,n,i;switch(t.t){case"t":i=t.d,n={c:t.c,d:{t:[7,i.key,i.val,i.duid,i.clientid,i.env]}},r="ac=g&d="+R(JSON.stringify(n))+"&v="+_;break;case"pr_t":i=t.d,n={c:t.c,d:{pr_t:[7,i.key,i.val,i.duid,i.clientid,i.env]}},r="ac=g&d="+R(JSON.stringify(n))+"&v="+_;break;case"uinfo":case"error":case"ub":case"ps":(n={c:t.c,d:{}}).d[t.t]=t.d,r="ac=g&d="+R(JSON.stringify(n))+"&v="+_;break;case"useraction":case"matrix":n=[[2,t.t],t.c,t.d],r="ac=a&d="+pt(JSON.stringify(n))+"&c=1&v="+_;break;case"restiming":n=[[1,"ctrip"],{pid:t.c[0],vid:t.c[1],sid:t.c[2],pvid:t.c[3],ver:_,ifr:0},[[["ubt",t.t,1],t.d]]],r="a=z&d="+pt(JSON.stringify(n))}r?gt(r+"&t="+A(),e):e(4,{status:5,message:t.t+" not support!"})}(t,e)}catch(t){e(0,{status:6,message:t&&t.message||""}),J(5)}}function vt(){this.k=[],this.v={}}vt.prototype.get=function(t){return this.v.hasOwnProperty(":"+t)?this.v[":"+t]:""},vt.prototype.set=function(t,e){this.k.push(t),this.v[":"+t]=e},vt.prototype.map=function(t){for(var e=0,r=this.k.length;e<r;e++){var n=this.k[e],i=this.get(n);i&&t(i,n)}};var mt=new vt,_t="CTRIP_UBT_M";function yt(){this.ppi=0,this.ppv=0,this.isnewvid=0,this.isnewsid=0,this.init()}var bt=yt.prototype;bt.init=function(){var t=H(V(_t))||{},e=function(t){var e={ts:0};if(t){var r=t.split(".");r&&6<r.length&&(e.pid=r[8]||0,e.vid=r[1]+"."+r[2],e.sid=N(r[6]),e.pvid=N(r[7]),e.ts=N(r[5]),e.create=N(r[4]))}return e}(z("_bfa","",!0));!function(t){if("string"!=typeof t)return;var e=u.hostname,r=e.substring(0,e.indexOf(t));if(r)for(var n=r.split("."),i=n.length-1;0<i;i--)t="."+n[i]+t,v.cookie="_bfa=;domain="+t+";path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;"}(nt.domain);var r,n,i,a=e.vid||t.vid,o=e.ts||t.ts||t.sid_ts;this.create=a&&o?(3e5<(r=Math.max(e.sid||0,t.sid||0))&&(r=0),3e5<(n=Math.max(e.pvid||0,t.pvid||0))&&(n=0),!r||18e5<+new Date-o?(r+=1,this.isnewsid=0):(this.ppi=t.pid||e.pid||0,this.ppv=n),this.vid=a,this.sid=r,this.pvid=n+1,e.create||t.create):(this.vid=y+"."+(i=h.screen,s([f.appName||"",f.appVersion||"",f.platform||"",f.userAgent,i.width+"x"+i.height,i.colorDepth,v.cookie||""].join("")).toString(36)),this.sid=1,this.pvid=1,this.isnewvid=1,this.isnewsid=1,y),this.update(this.ppi)},bt.update=function(t){var e=A(),r="1."+this.vid+".1."+this.create+"."+e+"."+this.sid+"."+this.pvid+"."+t,n={pid:t,vid:this.vid,sid:this.sid,sid_ts:e,pvid:this.pvid,ts:e,create:this.create};!function(t,e,r,n,i){i=i||"/";var a=";domain="+n,o="";0<r&&(o=";expires="+new Date(A()+r).toUTCString()),v.cookie=t+"="+R(e)+a+";path="+i+o}("_bfa",r,63072e6,nt.domain),q(_t,JSON.stringify(n))};var St,kt,Tt,It=/\$\{(\w+)\}/g,Et="",wt={useraction:[],matrix:[]};try{kt=v.location,Tt=a(),mt.set("url",kt.href),mt.set("refer",function(){var t="";try{t=v.referrer}catch(t){}if(!t&&h.opener)try{t=h.opener.location.href}catch(t){}return t}()),mt.set("screen:width",Tt.w),mt.set("screen:height",Tt.h),St="RID-"+s(u.pathname+u.search),mt.set("rid",z(St)),function(){var t=z("Session");if(t){var e=F(t);mt.set("search:engine",e.SmartLinkCode),mt.set("search:keyword",e.SmartLinkQuary)}}()}catch(t){J(3)}function Ct(t,e){Ct.count++,this._store_=[],this._fn_=[],this.pid=-4,this.done=!1,this.meta=new yt,this.h=s(this.meta.vid)%100,this.id=this.meta.pvid,this.orderid="",this.url="",this.refer="",mt.set("user:login",0),this.init(t,e)}Ct.count=0;var Nt=Ct.prototype;Nt.init=function(t,e){if("object"==typeof t)for(var r in t)if(t.hasOwnProperty(r)){var n=t[r],i=typeof n;"string"!=i&&"number"!=i||this.set(r,n)}E(e)&&this._fn_.push(e),this.checkSend()},Nt.set=function(t,e){switch(t){case"page_id":this.setPid(e);break;case"orderid":this.orderid=e;break;case"duid":mt.set("user:duid",e),mt.set("user:login",1);break;case"loginName":mt.set("user:id",e),mt.set("user:login",1);break;case"url":case"refer":this[t]=(""+e).substring(0,500);break;default:P(e)?mt.set(t,I(e)?e.substring(0,50):e):J(10)}return 1},Nt.setPid=function(t){this.pid=N(t)},Nt.getCommon=function(){var t=this.meta,e=nt.appid||mt.get("appid");return[this.pid,t.vid,t.sid,t.pvid,mt.get("tid"),mt.get("abtest"),mt.get("mid"),_,nt.fp,"",e,"","",mt.get("user:id"),nt.env]},Nt.getMeta=function(){var t=this.meta;return{pid:this.pid,vid:t.vid,sid:t.sid,pvid:t.pvid,abtest:mt.get("abtest"),pv:this.done,uid:mt.get("user:duid")}},Nt.getUinfo=function(){var t=this.meta,e="";try{e+="cl="+document.cookie.length,e+=",ckl="+(document.cookie.match(/[^=]+=[^;]*;?/g)||[]).length,e+=",lk="+localStorage.length,e+=",log="+function(){for(var t=[],e=0,r=Y.length;e<r;e++)Y[e]&&(t[Math.floor(e/6)]^=1<<e%6);for(e=0;e<t.length;e++)t[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(t[e]||0);return t.join("")+"~"}()}catch(t){J(9)}var r=new Array(36);return r[0]=14,r[1]=t.ppi,r[2]=t.ppv,r[3]=this.url,r[4]=mt.get("screen:width"),r[5]=mt.get("screen:height"),r[6]=e,r[7]=m(),r[8]=mt.get("search:engine"),r[9]=mt.get("search:keyword"),r[10]=this.refer,r[11]=mt.get("abtest"),r[12]=t.isnewvid,r[13]=mt.get("user:login"),r[14]=mt.get("user:id"),r[15]=mt.get("user:grade"),r[16]=mt.get("user:corp_id"),r[17]=mt.get("product:startcity"),r[18]=mt.get("alliance:id"),r[19]=mt.get("alliance:sid"),r[20]=mt.get("alliance:ouid"),r[21]=this.orderid,r[22]=mt.get("user:duid"),r[23]=mt.get("zdata"),r[24]=mt.get("callid"),r[25]=mt.get("bid"),r[26]=mt.get("clientid"),r[27]=mt.get("sourceid"),r[28]=mt.get("appinfo"),r[29]=nt.env,r[30]=h.devicePixelRatio?1*h.devicePixelRatio:1,r[31]=t.isnewsid,r[32]=mt.get("other"),r[33]=mt.get("product:id"),r[34]=mt.get("traffic:source"),r[35]=mt.get("rid"),r[36]=mt.get("buData"),r},Nt.sampled=function(t,e){return e||(e=t,t=0),this.h>=t&&this.h<e},Nt.ready=function(t){E(t)&&(this.done?t(1,this):this._fn_.push(t))},Nt.co=function(){this.refer||(1<Ct.count&&""!=Et?(this.refer=Et,J(7)):this.refer=mt.get("refer")),this.url?J(6):this.url=mt.get("url");try{this.orderid?J(11):this.orderid=(a="",(o=H(V("PAYMENT2_ORDER_DETAIL")))&&o.value&&(a=o.value.oid,J(13)),a||(a=g("bf_ubt_orderid"),J(12)),a),mt.get("user:login")?J(8):function(){var t="",e=z("login_uid"),r=z("DUID"),n=z("CtripUserInfo");if(n&&(n=F(n),r=r||n.U,t=n.VipGrade),!r&&!e&&(n=H(V("USER")))&&n.value){var i=n.value;e=i.LoginName||i.UserName,t=i.VipGrade,r=i.UserID}e&&mt.set("user:id",e),r&&mt.set("user:duid",r),mt.set("user:grade",t),mt.set("user:corp_id",z("corpid")),(e||r)&&mt.set("user:login",1)}(),mt.set("abtest",function(){for(var t=p("ab_testing_tracker"),e=[],r="";t;)r+=t.value,e.push(t),t.removeAttribute("id"),t.removeAttribute("name"),t=p("ab_testing_tracker"),r&&";"!=r[r.length-1]&&(r+=";");for(var n=0;n<e.length;n++)e[n].setAttribute("id","ab_testing_tracker");var i=u.hash;return i&&-1!==i.indexOf("abtest=")&&(r+=x(i.replace(/.*(abtest=)/i,"").replace(/#.*/i,""))),280<r.length?(J(14),r.substring(0,280)):r}()),function(){var t=g("bf_ubt_product");t&&mt.set("product:id",t.substring(0,30));var e=z("StartCity_Pkg");if(e){var r=F(e);mt.set("product:startcity",r.PkgStartCity)}}(),i=z("Union"),(n=i?F(i):H(i=V("UNION"))||{})&&(mt.set("alliance:id",n.AllianceID||n.ALLIANCEID||""),mt.set("alliance:sid",n.SID||""),mt.set("alliance:ouid",n.OUID||"")),r="","object"==typeof Lizard&&Lizard.selfCollection&&(r=Lizard.selfCollection||Lizard.version||""),mt.set("other",JSON.stringify({lizard:r,rg:z("_RSG",""),lang:v.documentElement.getAttribute("lang")||""})),t="",(e=H(V("CINFO")))&&e.version&&(t=JSON.stringify({version:e.internalVersion||"",ver:e.version,net:e.networkStatus||"None",platform:e.platform||""})),mt.set("clientid",nt.clientid||V("GUID")),mt.set("sourceid",V("SOURCEID")),mt.set("appinfo",t)}catch(t){J(4)}var t,e,r,n,i,a,o},Nt.checkSend=function(){if(!(this.done||this.pid<-1)){this.done=!0,nt.readyWait=0,this.co();var s=this;ht({t:"uinfo",c:this.getCommon(),d:this.getUinfo(),p:10,f:function(t){if(s.meta.update(s.pid),1==t){for(var e=s._store_,r=0,n=e.length;r<n;r++){var i=e[r];i.c||(i.c=s.getCommon()),"useraction"==i.t||"matrix"==i.t?s._q(i.t,i):("t"==i.t&&(i.d=s._tl(i.d)),ht(i))}setInterval(function(){s._qsend("useraction",!0),s._qsend("matrix",!0)},2e3);for(var a=0,o=s._fn_.length;a<o;a++)s._fn_[a](1,s);Et=s.url}}})}},Nt._q=function(t,e){wt[t]&&wt[t].push(e),this._qsend(t)},Nt._qsend=function(t,e){var r=wt[t],n=r.length;if(e&&0<n||4<n){for(var i,a=[],o=[],s=0;s<n;s++)i=r[s],a.push(i.d),i.f&&o.push(i.f);ht({t:i.t,c:i.c,p:6,d:a,f:function(t){for(var e=0;e<o.length;e++)o[e](t)}}),wt[t].splice(0,n)}},Nt._tl=function(t){var r={duid:mt.get("user:duid"),page_id:this.pid,is_login:mt.get("user:login")};return t.duid=r.duid,t.clientid=mt.get("clientid"),t.env=nt.env,t.val=t.val.replace(It,function(t,e){return e in r?r[e]:t}),t},Nt.send=function(t,e,r,n){E(r)||(r=b);var i={t:t,d:e,p:6,f:r};if("error"==i.t||this.done){if(i.c=this.getCommon(),"error"==i.t&&n&&(i.c[0]=n),"useraction"==i.t||"matrix"==i.t){if("matrix"==i.t&&I(i.d.name)&&-1!=i.d.name.indexOf("JS.Lizard"))return this._q(i.t,i);i.d=[e]}"t"!=i.t&&"pr_t"!=i.t||(i.d=this._tl(i.d)),ht(i)}else this._store_.push(i)};var Ot=new Ct;function At(t,e){Ot.done?Ot=new Ct(t,e):Ot.init(t,e)}function Pt(e){e=e||{};var r=!1,t=v.createElement("script");t.type="text/javascript",t.async=!0,t.setAttribute("crossorigin","anonymous"),t.onload=t.onreadystatechange=function(t){r||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(this.onload=this.onreadystatechange=null,r=!0,e.onload&&e.onload(t))},t.src=e.url+(e.mask?"?="+function(t){t=t||"yyyymmdd";var e=new Date,r=e.getFullYear(),n=e.getMonth(),i=e.getDate(),a={d:i,dd:U(i,2),m:n+1,mm:U(n+1),yy:e.getYear(),yyyy:r};return t.replace(L,function(t){return a[t]||t})}(e.mask):"");var n=v.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)}function Rt(t){Pt({mask:"yyyymmdd",url:"https://webresource.c-ctrip.com/ResUnionOnline/R7/common/h5Redirect.js",onload:t})}var xt=1;function Dt(t){return t&&(I(t)||T(t))}function Lt(t,e){return I(t)&&t.substring(0,e)||""}var Ut={},jt={_config:function(t,e,r){if(C(t)){for(var n=O(t),i=0;i<n.length;i++){var a=n[i];nt[a]=t[a]}r=e}else nt[t]=e;nt.debug&&(nt.surl="//s.uat.qa.nt.ctripcorp.com/bf.gif"),r&&r()},_set:function(t,e,r){var n="Value Error";P(e)&&(n=Ot.set(t,e)),r&&r(n)},_getFullPV:function(t){var e=Ot.getMeta(),r=e.vid+"."+e.sid+"."+e.pvid;return t&&t(r)||r},_getStatus:function(t){var e=Ot.getMeta();return t&&t(e)||e},_getFP:function(t,e){return t&&t(e?"":nt.fp)},_getPageid:function(r){Ot.done?r(!1,Ot.pid):Ot.ready(function(t,e){r(!1,e.pid)})},_unload:function(t){if(("undefined"!=typeof $&&$.bindFastClick||"object"==typeof Lizard)&&1==xt)xt=0;else{if("object"==typeof CtripBusiness&&E(CtripBusiness.app_send_ubt_log)){var e=Ot.getMeta();CtripBusiness.app_send_ubt_log({page:e.pid,vid:e.vid,sid:e.sid,pvid:e.pvid,ts:+new Date})}Ot.done||Ot.init(t),At()}},_asynRefresh:function(t,e){if(t&&t.buData){for(var r=O(t.buData),n=r.length,i=n<3,a=0;a<n;a++){var o=t.buData[r[a]];("string"!=typeof o||30<o.length)&&(i=!1)}i&&mt.set("buData",t.buData)}At(t,e)},_tracklog:function(t,e,r){Dt(t)&&P(e)?Ot.send("t",{key:t,val:e,v:6},r):r&&r(0)},_privateTrace:function(t,e,r){Dt(t)&&P(e)?Ot.send("pr_t",{key:t,val:e,v:7},r):r&&r(0)},_trackError:function(t,e){if("object"!=typeof t)return e(0);for(var r=["version","message","line","file","category","framework","time","repeat","islogin","name","column"],n=[7,"",0,"","","",A()-y,1,mt.get("user:login"),"",0],i=1,a=r.length;i<a;i++){var o=r[i];if(t[o]){var s=t[o]+"";switch(o){case"message":case"file":s=Lt(s,500);break;case"category":case"framework":case"name":s=Lt(s,100);break;default:s=N(s)}n[i]=s}}t.stack?w(t.stack)?n.push(t.stack.join("").slice(-1600)):n.push(String(t.stack).slice(-1600)):n.push(""),Ot.send("error",n,e,t.page_id)},_trackUserBlock:function(t,e){if("object"!=typeof t)return e(0,"erro");var r=[];r[0]=6,r[1]=mt.get("user:login"),r[2]=Lt(t.message,300),r[3]=Lt(t.value,300),r[4]=Lt(t.type,50),r[5]=Lt(t.dom,100),r[6]=Lt(t.form,100),r[7]=N(t.count),Ot.send("ub",r,e)},_trackMetric:function(t,e){if(!t||"object"!=typeof t)return"Error Param";e=e||Ot;var r=D({name:"",tag:{},value:0,ts:A(),callback:b,timeout:!1,sample:100},t),n=function(t){if(!t)return 1;var e=O(t),r=e.length;if(8<r)return 8;for(var n=0;n<r;n++){var i=t[e[n]];switch(typeof i){case"string":t[e[n]]=Lt(i,300);break;case"number":case"boolean":break;default:return 110}}return 1}(r.tag);if(!Dt(r.name)||1!=n||!function(t){if(T(t))return!0;if(C(t)){var e=O(t),r=e.length;if(30<r)return!1;for(var n=0;n<r;n++)if(!Dt(e[n])||!T(t[e[n]]))return!1;return!0}return!1}(r.value))return r.callback(n);e.send("matrix",{name:r.name,tags:r.tag,value:r.value,ts:r.ts},r.callback),r.timeout&&setTimeout(function(){r.callback(n)},r.timeout||50)},_trackMatrix:function(t,e,r,n,i){this._trackMetric({name:t,tag:e,value:r,ts:n,callback:i})},_time:function(t,e){Ut[t+""]={value:A(),opt:e||{},pv:Ot}},_timeEnd:function(t,e){var r=Ut[t+""];if(r&&r.value){var n=A()-r.value,i=D(r.opt,e||{});if(i.name)return i.value=n,this._trackMetric(i,r.pv),delete Ut[t],n}},_require:function(t,e){"markting"==t&&Rt(e)}},Bt=[],Mt=!1;function Ft(t){for(var e=0;e<Bt.length;e++)Bt[e](t)}!function t(){var e,r=(e=g("page_id"))&&e.replace(/^\s+|\s+$/,"");"wait"==r?J(1):r&&"0"!=r?(Mt=!0,Ft(r)):"complete"==v.readyState&&(Mt=!0,Ft(0)),!Mt&&0<--nt.readyWait&&setTimeout(t,500)}();var Ht,Yt=!1,Jt=!1;function zt(t,e){var r=0;if("DIV"==e&&(t.attributes["page-url"]||t.getAttribute("page-url")))return"";if(t.parentNode)for(var n=t.parentNode.firstChild;n&&n!=t;)1==n.nodeType&&n.tagName==t.tagName&&r++,n=n.nextSibling;return 0<r?"["+ ++r+"]":""}function Xt(t){if(t&&t.target){var e=t.target,r=v.documentElement,n=v.body;if(e&&1==e.nodeType&&e.nodeName&&e.getBoundingClientRect){var i,a,o=e.nodeName.toUpperCase(),s=e.getBoundingClientRect(),c="",u=Math.max(r.scrollLeft,n.scrollLeft),d=Math.max(r.scrollTop,n.scrollTop),f=Ht.pageX||t.pageX||0,l=Ht.pageY||t.pageY||0,p=parseInt((r.clientWidth||n.clientWidth)/2,10);if(a="SELECT"==o&&l-s.top-d<0?(c+="[@x='"+parseInt(f+s.left+u-p,10)+"'][@y='"+parseInt(l+s.top,10)+"']",i=f,l-d):(c+="[@x='"+(f-p)+"'][@y='"+l+"']",i=parseInt(f-s.left-u,10)||0,parseInt(l-s.top-d,10)||0),0<=i&&0<=a&&i<=screen.width+u){c+="[@rx='"+i+"']",c+="[@ry='"+a+"']";var g=function(t){for(var e,r=[],n=0;t&&9!=t.nodeType;){if(1==t.nodeType){var i=(t.nodeName||"").toUpperCase(),a=t.id||"",o=i+zt(t,i);a&&-1==a.indexOf("client_id_viewport")&&(o+="[@id='"+a+"']"),(e=t.getAttribute("data-ubt-key"))&&(o+="[@cid='"+e+"']"),r[n++]=o}t=t.parentNode}return 2<r.length?r.reverse().join("/"):""}(e);g&&Ot.send("useraction",{action:"click",xpath:g+c,ts:+new Date})}}}}function Vt(){return f.connection&&f.connection.type||"unknown"}var qt=/^(file|chrome|asset)|\.(baidu|ctrip|google|bdimg|xiecheng|amap|tieyou|c-ctrip|ctripcorp|hhtravel)\./;var Gt,$t,Wt,Kt,Qt,Zt,te=[{bu:"HTL",rg:/^(P_HOTEL|U_HOTEL|P_SEARCH|S_HOTEL|F_HOTEL|BNB|SALE_HOTEL|P_INN_).*/i},{bu:"FLT",rg:/^(FLIGHT|FLTMX|FLT_|AllAir|MATRIX_FLITHT|matrix-FlightList).*/i},{bu:"TRN",rg:/^(TRAIN|TRAININFO|DISTRIBUTE|BOOKINFO).*/i},{bu:"BUS",rg:/^(BUS_|SHIP_|AIRPORTS_|SHIPLINE|YUECHE|TOUR_BUS).*/i},{bu:"TOUR",rg:/^(P_DIYSHX|DIY_HOTEL|P_TAOCAN|P_DIYSHX|TOUR|VACATION|AROUND|U_ACTIVITY_DAYTOUR|DIYFHX|DIYFHXSDP|VTM|TOURVTM|TUAN_|YouXue_|DIY_CITY|DIY_XRS|I_DIYTOUR|F_DIYSHX|DIYSHX_).*/i},{bu:"TTD",rg:/^(P_TICKET|U_TICKET|TTD_|P_ACTIVITY).*/i},{bu:"FNC",rg:/^(F_LIPIN|F_FX).*/i},{bu:"TLS",rg:/^(P_SHOPPING).*/i},{bu:"LT",rg:/^(S_HHTravel).*/i},{bu:"MKT",rg:/^(UNION|SiteType|SiteID|BidAdCount|DyAdIndex|AdData|DyAd).*/i},{bu:"CAR",rg:/^(CAR_|ISD_|P_CAR_ISD).*/i},{bu:"CRU",rg:/^(CRUISE_|S_CRUISE_).*/i},{bu:"BMAP",rg:/^(BMap).*/i},{bu:"AMAP",rg:/^(_AMap).*/i},{bu:"GS",rg:/^(GS_|POINT_TO_POINT_PARAM|DESTINATIONCITYSTORE|DESTINATIONLISTSTORE).*/i},{bu:"INSURANCE_INSURE",rg:/^(INSURANCE_INSURE).*/i},{bu:"SE",rg:/^(THEMETRAVEL_SEACH_LIST).*/i},{bu:"IGT",rg:/^(P_CAR_IGT|B_CARCH|P_CARCH).*/i}];function ee(t){if(!t)return 0;var e,r,n=0;for(e=0,r=(t+="").length;e<r;e++)n+=t.charCodeAt(e)<=65535?2:4;return n}function re(){for(var t,e=[],r=/^([a-z]+\d*|webresource\.english)\.((c-)?c?trip.com)/i,n=h[l].getEntriesByType("resource"),i=n.length,a=0;a<i;a++){var o=n[a],s=M(o.name);if("string"==typeof s.host&&r.test(s.host)&&!(0==(t=o).connectStart||t.connectEnd-t.connectStart<6||t.responseEnd-t.responseStart<6||t.domainLookupStart==t.domainLookupEnd&&t.domainLookupEnd==t.fetchStart&&t.fetchStart==t.connectStart&&t.fetchStart==t.connectEnd)){for(var c=["entryType","initiatorType","startTime","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","transferSize","encodedBodySize","decodedBodySize"],u={name:o.name,nextHopProtocol:""},d=0,f=c.length;d<f;d++)u[c[d]]=o[c[d]]||0;if(e.push(u),2<e.length)break}}return e}function ne(){for(var t,e=arguments,r=0,n=0,i=e.length;r<i;r++){var a=e[r];w(a)?(t=a[0],jt[t]&&jt[t].apply(jt,Array.prototype.slice.call(a,1))):n++}return n}if(w(h.__bfi))for(var ie=0,ae=h.__bfi.length;ie<ae;ie++)ne(h.__bfi[ie]);else h.__bfi=[];h.__bfi.push=ne,h.$_bf=D(h.$_bf||{},{version:_,loaded:!0,_getFullPV:jt._getFullPV,_getStatus:jt._getStatus,tracklog:jt._tracklog,trackError:jt._trackError,asynRefresh:At}),function(e){if(!h[l]||!h[l].timing)return;var r=0;(function t(){h[l].timing.loadEventEnd?e.send("ps",function(){for(var t=["navigationStart","redirectStart","unloadEventStart","unloadEventEnd","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],e=h[l].timing,r=[6],n=0;n<t.length;n++)r.push(e[t[n]]);return r.push(h[l].navigation.type||0),r.push(h[l].navigation.redirectCount||0),r}()):++r<300&&setTimeout(t,1e3)})()}(Ot),$t=(Gt="ontouchstart"in h)?"touchstart":"mousedown",Wt=Gt?"touchmove":"mousemove",Kt=Gt?"touchend":"mouseup",v.addEventListener($t,function(t){Ht=t.touches&&t.touches[0]||t,Yt=!(Jt=!1)},!0),v.addEventListener(Wt,function(t){if(Yt){var e,r,n=t.touches&&t.touches[0]||t;e=Math.abs(n.pageX-Ht.pageX),r=Math.abs(n.pageY-Ht.pageY),Jt=!(e<6||r<6)}},!0),v.addEventListener(Kt,function(t){if(!Jt&&Yt)try{Xt(t)}catch(t){J(15)}Yt=!1,Ht=null},!0),function(){if(null===h.onerror){var a={};window.onerror=function(){try{var t=arguments,e=[];if(t[4]){var r=t[4];"string"==typeof r?e=r.split("\n"):"object"==typeof r&&r.stack&&(e=r.stack.split("\n"))}var n={message:""+t[0],file:""+t[1],category:"inner-error",framework:"normal",time:A()-y,line:t[2],column:t[3],stack:e,repeat:1},i="err_"+s(n.message+n.file+n.line);a[i]||(a[i]=!0,jt._trackError(n))}catch(t){J(16)}}}}(),Ot.sampled(5)&&function(t){var e=function(){for(var t=[],e=Vt(),r=v.scripts,n=r.length,i=0;i<n;i++){var a=r[i];a.src&&(qt.test(a.src)||t.push({name:"ubt.hijack",tag:{type:"script",url:a.src,net:e},value:1,ts:A()}))}return t}();if(h.top!==h&&0<h.length&&h.top.location.href){var r=h.top.location.href||"";qt.test(r)||e.push({name:"ubt.hijack",tag:{type:"iframe",url:r,net:Vt()},value:1,ts:A()})}e.length&&t.send("matrix",e)}(Ot),Ot.sampled(93,100)&&Ot.id%10==1&&function(){var t="",e="_CACHE",r={other:0},n=0,i={},a=0,o=h.localStorage;for(var s in o){var c=o[s];if(o.hasOwnProperty(s)&&"function"!=typeof c&&"object"!=typeof c){var u=!1,d=ee(c)+ee(s);102400<d&&(i[s]=d,a++);for(var f=0,l=te.length;f<l;f++){var p=te[f];if(p.rg.test(s)){n+=d,/.*(_cache)$/i.test(s)?r[p.bu+e]?r[p.bu+e]+=d:r[p.bu+e]=d:r[p.bu]?r[p.bu]+=d:r[p.bu]=d,u=!0;break}}u||(n+=d,r.other+=d)}}if(n){for(var g in t="all="+n,r)t+="&"+g+"="+r[g];jt._tracklog("ubt_m_localstorage",t)}0<a&&jt._tracklog("101941",JSON.stringify(i))}(),r||!Ot.sampled(10)&&-480==i()||(Qt=Ot,h[l]&&h[l].getEntriesByType&&(h.addEventListener("load",function(){0<re().length&&Qt.send("restiming",re())}),J(17))),"http:"!=u.protocol&&"https:"!=u.protocol||setTimeout(function(){nt.rms&&Pt({mask:"yyyymmdd",url:"https://webresource.c-ctrip.com/resaresonline/risk/ubtrms/latest/default/mrms.js"});var t=g("bf_ubt_markting_off");nt.markting=(!t||"false"==t)&&nt.markting,nt.markting&&Rt()},30),nt.promiseCatch&&function(){if("function"==typeof h.Promise){var e=h.Promise;-1<e.toString().indexOf("[native code]")&&e.resolve.toString().indexOf("[native code]")&&(h.Promise=function t(n){return this instanceof t?new e("function"!=typeof n?n:function(){try{return n.apply(this,arguments)}catch(t){throw t instanceof Error||(t=new Error(t+"")),r={message:(e=t).message||"",file:"",category:e.name||"promise-catch",framework:"ubt-promise-catch",time:0,line:0,column:0,stack:e.stack||"",repeat:1},jt._trackError(r),t}var e,r}):e(n)},J(20))}}(),Zt=function(t){J(2),Ot.setPid(t),Ot.checkSend()},1==Mt?Zt(g("page_id")):Bt.push(Zt)}();
