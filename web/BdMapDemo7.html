<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body, html {width: 100%;height: 100%;margin:0;font-family:"微软雅黑";}
        #allmap{width:100%;height:100%;}
        p{margin-left:5px; font-size:14px;}
    </style>
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=n3xc9ALenVeuL9apmqs4ZjrluhhsX4mr"></script>
    <link rel="stylesheet" href="http://api.map.baidu.com/library/SearchInfoWindow/1.5/src/SearchInfoWindow_min.css" />
    <title>添加复杂内容的信息窗口</title>
</head>
<body>
<div id="allmap"></div>
<p>点击标注点，可查看由文本，图片构成的复杂型信息窗口</p>
</body>
</html>
<script type="text/javascript">
    function getQueryString(name) {
        var result = location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
        if (result == null || result.length < 1) {
            return "";
        }
        return result[1];
    }

    var data = {
        "1": {
            "name": "富民路1",

            "line": "[ [121.456151, 31.227961], [121.456596, 31.227347], [121.457009, 31.226579], [121.457396, 31.22573], [121.457786, 31.225042]]",
            // "line2":"[ [121.457387, 31.225745], [121.457791, 31.225039], [121.458271, 31.224228], [121.458613, 31.223645], [121.458837, 31.223139], [121.458887, 31.222788]]",
            "text": "富民路(Fumin Lu)　在上海市市区中部，跨静安、徐汇两区。北起延安中路，南至东湖路。长625米，宽15.0～17.0米，车行道宽9.0～9.3米。民国2年(1913年)筑，以法国海军中将名命名古拔路(Rue Amiral Courbet)。民国32年以云南富民改今名。沿路为住宅。",

            // "text2":"富民路北起延安中路，南至长乐路，一条短小精悍的路。从常德路一路往南走，经过宽阔的延安中路便来到了并不宽的富民路。开始的一段路还没有那么的窄，到了巨鹿路与富民路的路口，你会发现路明显就变窄了，只有两车宽。路上小店也明显的多了起来，由巨鹿路、富民路和长乐路组成的黄金工字区里可是小店扎堆的地方，很多小店都各具特色。 道旁梧桐掩映得幽暗，仿佛有着诱人秘密等你去探寻。越走越深、越走越静，路旁沉淀时间的建筑，散发出岁月的味道。",
            "image": "data/syn_data/建筑道路数据/富民路/1.jpg",
            // "image2":"data/syn_data/建筑道路数据/富民路/2.jpg",
            "spaType": 3
        },
        "2": {
            "name": "富民路2",

            // "line1":"[ [121.456151, 31.227961], [121.456596, 31.227347], [121.457009, 31.226579], [121.457396, 31.22573], [121.457786, 31.225042]]",
            "line": "[ [121.457387, 31.225745], [121.457791, 31.225039], [121.458271, 31.224228], [121.458613, 31.223645], [121.458837, 31.223139], [121.458887, 31.222788]]",
            // "text1":"富民路(Fumin Lu)　在上海市市区中部，跨静安、徐汇两区。北起延安中路，南至东湖路。长625米，宽15.0～17.0米，车行道宽9.0～9.3米。民国2年(1913年)筑，以法国海军中将名命名古拔路(Rue Amiral Courbet)。民国32年以云南富民改今名。沿路为住宅。",
            "text": "富民路北起延安中路，南至长乐路，一条短小精悍的路。从常德路一路往南走，经过宽阔的延安中路便来到了并不宽的富民路。开始的一段路还没有那么的窄，到了巨鹿路与富民路的路口，你会发现路明显就变窄了，只有两车宽。路上小店也明显的多了起来，由巨鹿路、富民路和长乐路组成的黄金工字区里可是小店扎堆的地方，很多小店都各具特色。 道旁梧桐掩映得幽暗，仿佛有着诱人秘密等你去探寻。越走越深、越走越静，路旁沉淀时间的建筑，散发出岁月的味道。",

            // "image1":"data/syn_data/建筑道路数据/富民路/1.jpg",
            "image": "data/syn_data/建筑道路数据/富民路/2.jpg",
            "spaType": 3
        },
        "3": {
            "name": "富民路",

            // "line1":"[ [121.456151, 31.227961], [121.456596, 31.227347], [121.457009, 31.226579], [121.457396, 31.22573], [121.457786, 31.225042]]",
            "line": "[ [121.456151, 31.227961], [121.456596, 31.227347], [121.457009, 31.226579], [121.457396, 31.22573], [121.457786, 31.225042],[121.457387, 31.225745], [121.457791, 31.225039], [121.458271, 31.224228], [121.458613, 31.223645], [121.458837, 31.223139], [121.458887, 31.222788]]",
            // "text1":"富民路(Fumin Lu)　在上海市市区中部，跨静安、徐汇两区。北起延安中路，南至东湖路。长625米，宽15.0～17.0米，车行道宽9.0～9.3米。民国2年(1913年)筑，以法国海军中将名命名古拔路(Rue Amiral Courbet)。民国32年以云南富民改今名。沿路为住宅。",
            "text": "富民路(Fumin Lu)　在上海市市区中部，跨静安、徐汇两区。北起延安中路，南至东湖路。长625米，宽15.0～17.0米，车行道宽9.0～9.3米。民国2年(1913年)筑，以法国海军中将名命名古拔路(Rue Amiral Courbet)。民国32年以云南富民改今名。沿路为住宅。富民路北起延安中路，南至长乐路，一条短小精悍的路。从常德路一路往南走，经过宽阔的延安中路便来到了并不宽的富民路。开始的一段路还没有那么的窄，到了巨鹿路与富民路的路口，你会发现路明显就变窄了，只有两车宽。路上小店也明显的多了起来，由巨鹿路、富民路和长乐路组成的黄金工字区里可是小店扎堆的地方，很多小店都各具特色。 道旁梧桐掩映得幽暗，仿佛有着诱人秘密等你去探寻。越走越深、越走越静，路旁沉淀时间的建筑，散发出岁月的味道。",
            // "image1":"data/syn_data/建筑道路数据/富民路/1.jpg",
            "image": ["data/syn_data/建筑道路数据/富民路/1.jpg","data/syn_data/建筑道路数据/富民路/2.jpg"],
            "spaType": 3
        }
    };
    var idc = getQueryString("id");
    var Data = data[idc];
    var pointArray=Data["line"];
    var lineArr = JSON.parse(pointArray);
    var point=lineArr[0];
    // var pointArray1=point.split(",");
    var X=point[0];
    var Y=point[1];
    // var polyline=new BMap.Polyline(lineArr,{strokeColor:"red", strokeWeight:6, strokeOpacity:0.9});
    var point = new BMap.Point(X, Y);
    var text=Data.text;
    if(idc==1||idc==2) {
        if(Data.text.length>150){
            text=Data.text.substring(0,150)+'...'
        }
        var content = '<div style="width: 320px"><h4 style="margin:0 0 0 0;padding:0 0 0 0 ; color: #be2924;font-size: 18px">' +
            Data.name +
            '</h4><br style="margin:0;line-height:10px;padding:2px;">' +
            '<strong>文本</strong><p style=\'margin:0;line-height:1.5;font-size:13px;text-indent:2em\'>：' + text + '</br>' +
            '<strong>图像</strong><br/>' + '&nbsp;&nbsp;<img src=' + Data.image + ' id="imgDemo" class="img"  alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/></br>' +
            // '<img src=' +
            // Data.image+
            // ' class="img"   alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/>'+
            // '<img src=' +
            // Data.image +
            // ' class="img" alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/>'+
            // '<img src=' +
            // Data.image +
            // ' class="img" alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/></br>'+
            // '视频链接:' + '&nbsp;&nbsp;' + '<a href="#" onclick="getHref()">视频1</a>' + '&nbsp;&nbsp;' + '<a href="#" onclick="getHref1()">视频2</a>' + '&nbsp;&nbsp;' + '<a href="#">视频3</a>' +
            '</div>';
    }else{
        if(Data.text.length>150){
             text=Data.text.substring(0,150)+'...'
        }
        var content = '<div style="width: 320px"><h4 style="margin:0 0 0 0;padding:0 0 0 0 ; color: #be2924;font-size: 18px">' +
            Data.name +
            '</h4><br style="margin:0;line-height:10px;padding:2px;">' +
            '<strong>文本</strong><p style=\'margin:0;line-height:1.5;font-size:13px;text-indent:2em\'>：' +text + '</br>' +
            '<strong >图像</strong><br/>' + '&nbsp;&nbsp;<img src=' + Data.image[0] + '  id="imgDemo" class="img"  alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/>' +
                '&nbsp;&nbsp;'+
            '&nbsp;&nbsp;<img src=' +
            Data.image[1]+
            ' class="img"  id="imgDemo"  alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/></br>'+
            // '<img src=' +
            // Data.image +
            // ' class="img" alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/>'+
            // '<img src=' +
            // Data.image +
            // ' class="img" alt="" style="zoom:1;overflow:hidden;width:50px;height:50px;"/></br>'+
            // '视频链接:' + '&nbsp;&nbsp;' + '<a href="#" onclick="getHref()">视频1</a>' + '&nbsp;&nbsp;' + '<a href="#" onclick="getHref1()">视频2</a>' + '&nbsp;&nbsp;' + '<a href="#">视频3</a>' +
            '</div>';

    }
    var map = new BMap.Map("allmap");
    var marker = new BMap.Marker(point);
    map.enableScrollWheelZoom(true);
    var infoWindow;
    infoWindow = new BMap.InfoWindow(content);
    marker.spaType = 1;
    marker.name = Data.name;
    map.centerAndZoom(point, 15);
    map.addOverlay(marker);
    marker.addEventListener("click", function(){
        this.openInfoWindow(infoWindow);
        document.getElementById('imgDemo').onload = function (){
            infoWindow.redraw();   //防止在网速较慢，图片未加载时，生成的信息框高度比图片的总高度小，导致图片部分被隐藏
        }
    });
</script>
